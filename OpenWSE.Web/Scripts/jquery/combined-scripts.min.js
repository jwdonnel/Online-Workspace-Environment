// jQuery History
(function ($, e, b) { var c = "hashchange", h = document, f, g = $.event.special, i = h.documentMode, d = "on" + c in e && (i === b || i > 7); function a(j) { j = j || location.href; return "#" + j.replace(/^[^#]*#?(.*)$/, "$1") } $.fn[c] = function (j) { return j ? this.bind(c, j) : this.trigger(c) }; $.fn[c].delay = 50; g[c] = $.extend(g[c], { setup: function () { if (d) { return false } $(f.start) }, teardown: function () { if (d) { return false } $(f.stop) } }); f = (function () { var j = {}, p, m = a(), k = function (q) { return q }, l = k, o = k; j.start = function () { p || n() }; j.stop = function () { p && clearTimeout(p); p = b }; function n() { var r = a(), q = o(m); if (r !== m) { l(m = r, q); $(e).trigger(c) } else { if (q !== m) { location.href = location.href.replace(/#.*/, "") + q } } p = setTimeout(n, $.fn[c].delay) } !d && (function () { var q, r; j.start = function () { if (!q) { r = $.fn[c].src; r = r && r + a(); q = $('<iframe tabindex="-1" title="empty"/>').hide().one("load", function () { r || l(a()); n() }).attr("src", r || "javascript:0").insertAfter("body")[0].contentWindow; h.onpropertychange = function () { try { if (event.propertyName === "title") { q.document.title = h.title } } catch (s) { } } } }; j.stop = k; o = function () { return a(q.location.href) }; l = function (v, s) { var u = q.document, t = $.fn[c].domain; if (v !== s) { u.title = h.title; u.open(); t && u.write('<script>document.domain="' + t + '"<\/script>'); u.close(); q.location.hash = v } } })(); return j })() })(jQuery, this);

// Clock
function showCurrentTime() { $("#top-bar-datetime").show(); var x = new Date(); var t = x.getHours(); var n = x.getMinutes(); var r = t >= 12 ? " pm" : " am"; if (n < 10) { n = "0" + n } if (t > 12) { t = t - 12 } if (t == 0 && r == " am") { t = 12 } $("#DateDisplay").html(x.toLocaleDateString()); $("#localtime").html(t + ":" + n + r); showCurrentTime_interval = window.setInterval(function () { var d = new Date(); var t = d.getHours(); var n = d.getMinutes(); var r = t >= 12 ? " pm" : " am"; if (n < 10) { n = "0" + n } if (t > 12) { t = t - 12 } if (t == 0 && r == " am") { t = 12 } $("#DateDisplay").html(d.toLocaleDateString()); $("#localtime").html(t + ":" + n + r); }, 10e3) } var showCurrentTime_interval;
function hideCurrentTime() { $("#top-bar-datetime").hide(); clearInterval(showCurrentTime_interval); $("#DateDisplay").html(""); $("#localtime").html(""); }

// Get Parameter Name (QueryString)
function getParameterByName(e) { e = e.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]"); var t = "[\\?&]" + e + "=([^&#]*)"; var n = new RegExp(t); var r = n.exec(window.location.search); if (r == null) return ""; else return decodeURIComponent(r[1].replace(/\+/g, " ")) }

// Check if on Mobile Device
function isMobileDevice() { var _userAgent = navigator.userAgent; if (_userAgent.match(/iPhone/i) || _userAgent.match(/iPad/i) || _userAgent.match(/iPod/i) || _userAgent.match(/webOS/i) || _userAgent.match(/ppc/i) || _userAgent.match(/Windows CE/i) || _userAgent.match(/Blackberry/i) || _userAgent.match(/Opera Mini/i) || _userAgent.match(/Mobile/i) || _userAgent.match(/Palm/i) || _userAgent.match(/Portable/i) || _userAgent.match(/Opera Mobi/i) || _userAgent.match(/Android/i) || _userAgent.match(/Windows Phone/i)) { return true; } if (getParameterByName("mobileMode") === "true") { return true; } return false; }

// jQuery Tooltip
$(function () { function e(e) { var t = "Selected " + $.trim(e.data("tooltip-title") || e.text()); $("<div>").appendTo(document.body).text(t).addClass("notification ui-state-default ui-corner-bottom").position({ my: "center top", at: "center top", of: window }).show({ effect: "blind" }).delay(1e3).hide({ effect: "blind", duration: "slow" }, function () { $(this).remove() }) } $("button").each(function () { var t = $(this).button({ icons: { primary: $(this).data("icon") }, text: !!$(this).attr("title") }); t.click(function () { e(t) }) }); $(".set").buttonset({ items: "button" }); $(document).tooltip({ position: { my: "center top", at: "center bottom+5" }, show: { duration: "fast" }, hide: { effect: "hide" } }) });

// Loading Message Popup (All Pages)
var loadingPopup = function () {
    function Message(message, container) {
        RemoveMessage();
        BindF5KeyPress();

        if (!container) {
            container = "body";
        }

        if (message.indexOf("...") != -1) {
            message = message.replace("...", "");
        }
        message = message + "...";

        var x = "<div class='update-element' data-container='" + container + "'><div class='update-element-overlay'>";
        x += "<div class='update-element-modal'><div class='update-message'>" + message + "</div><div class='update-progress'></div></div></div></div>";
        $(container).append(x);

        var $modalWindow = $(".update-element[data-container='" + container + "']").find(".update-element-modal");

        if (container === "body") {
            if ($("#top_bar").length > 0 && $("#top_bar").css("display") != "none") {
                $modalWindow.css("top", $("#top_bar").outerHeight() + 10);
            }
            else if ($(".iframe-top-bar").length > 0 && $(".iframe-top-bar").css("display") != "none") {
                $modalWindow.css("top", $(".iframe-top-bar").outerHeight() + 10);
            }

            if ($modalWindow.css("right") === "auto" || $modalWindow.css("right") === "") {
                if ($("#sidebar_container").length > 0) {
                    if ($("#site_mainbody").attr("data-layoutoption") === "Boxed") {
                        var leftPosContainer = $(".fixed-container-holder").offset().left;
                        $modalWindow.css("left", $("#sidebar_container").outerWidth() + leftPosContainer + 10);
                    }
                    else {
                        $modalWindow.css("left", $("#sidebar_container").outerWidth() + 10);
                    }
                }
                else if ($("#site_mainbody").attr("data-layoutoption") === "Boxed") {
                    var leftPosContainer = $(".fixed-container-holder").offset().left;
                    $modalWindow.css("left", leftPosContainer + 10);
                }
            }
            else {
                if ($("#site_mainbody").attr("data-layoutoption") === "Boxed") {
                    var rightPos = $(window).outerWidth() - ($(".fixed-container-holder").offset().left + $(".fixed-container-holder").outerWidth());
                    $modalWindow.css("right", rightPos + 20);
                }
            }
        }
        else {
            $modalWindow.css("top", "20px");
            if ($modalWindow.css("right") === "auto" || $modalWindow.css("right") === "") {
                $modalWindow.css("left", "20px");
            }
            else {
                $modalWindow.css("right", "20px");
            }

            $modalWindow.css("position", "absolute");
            $(".update-element[data-container='" + container + "']").find(".update-element-overlay").css("position", "absolute");
        }

        $(".update-element[data-container='" + container + "']").show();
    }
    function RemoveMessage(container) {
        if (!container) {
            container = "body";
        }

        $(".update-element[data-container='" + container + "']").remove();
        UnbindF5KeyPress();
    }

    /* Disable/Enable F5 Key Event */
    function BindF5KeyPress() {
        $(document).on("keydown", loadingPopup.disableF5);
    }
    function UnbindF5KeyPress() {
        $(document).off("keydown", loadingPopup.disableF5);
    }
    function disableF5(e) {
        if ((e.which || e.keyCode) == 116) {
            e.preventDefault();
        }
    }

    return {
        Message: Message,
        RemoveMessage: RemoveMessage,
        BindF5KeyPress: BindF5KeyPress,
        UnbindF5KeyPress: UnbindF5KeyPress,
        disableF5: disableF5
    }
}();
