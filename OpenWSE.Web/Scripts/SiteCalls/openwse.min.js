// -----------------------------------------------------------------------------------
//
//	openWSE v6.4
//	by John Donnelly
//	Last Modification: 2/18/2018
//
//	Licensed under the Creative Commons Attribution 2.5 License - http://creativecommons.org/licenses/by/2.5/
//  	- Free for use in both personal and commercial projects
//		- Attribution requires leaving author name, author link, and the license info intact.
//
// -----------------------------------------------------------------------------------
var openWSE_Config = { siteName: "", demoMode: !1, siteTheme: "Standard", animationSpeed: 200, hoverPreviewWorkspace: !1, taskBarShowAll: !0, ShowWorkspaceNumApp: !0, winMinWidth: 800, minPasswordLength: 6, workspaceMode: "", overlayPanelId: "pnl_OverlaysAll", reportAlert: !0, reportOnError: !1, siteRootFolder: "", displayLoadingOnRedirect: !0, saveCookiesAsSessions: !1, defaultBackgroundColor: "#FFFFFF", defaultBackgroundPosition: "right center", defaultBackgroundSize: "auto", defaultBackgroundRepeat: "repeat", appSnapHelper: !1, appStyle: "Style_1", showToolTips: !0, siteTipsOnPageLoad: !1, ShowLoginModalOnDemoMode: !1, multipleBackgrounds: !1, backgroundTimerLoop: 30, appendTimestampOnScripts: !0, timestampQuery: "vertimestamp=", useSlimScrollPlugin: !0, groupLoginName: "", showScrollToTop: !0, allowNavMenuCollapseToggle: !1, allowNavMenuCollapseToggleOnlyOne: !0, canvasWorkspaceAppPreviews: !1, hideSearchBarInTopBar: !1 }, cookieFunctions = { set: function (e, t, a, o) { if (openWSE_Config.saveCookiesAsSessions) loadingPopup.Message("Saving. Please Wait..."), openWSE.AjaxCall("WebServices/SaveControls.asmx/SetCookie", '{ "name": "' + e + '","value": "' + t + '" }', { promise: function () { loadingPopup.RemoveMessage(), o && "function" == typeof o && o(t) } }); else { if (a) { var n = new Date; n.setTime(n.getTime() + 24 * a * 60 * 60 * 1e3); var i = "; expires=" + n.toGMTString() } else i = ""; document.cookie = e + "=" + t + i + "; path=/", o && "function" == typeof o && o(t) } }, get: function (e, t) { var a = null; if (openWSE_Config.saveCookiesAsSessions) loadingPopup.Message("Loading. Please Wait..."), openWSE.AjaxCall("WebServices/SaveControls.asmx/GetCookie", '{ "name": "' + e + '" }', { promise: function (e) { loadingPopup.RemoveMessage(), e && (a = e.d), t && "function" == typeof t && t(a) } }); else { for (var o = e + "=", n = document.cookie.split(";"), i = 0; i < n.length; i++) { for (var r = n[i]; " " == r.charAt(0);)r = r.substring(1, r.length); if (0 == r.indexOf(o)) { a = r.substring(o.length, r.length); break } } t && "function" == typeof t && t(a) } }, del: function (e) { openWSE_Config.saveCookiesAsSessions ? (loadingPopup.Message("Deleting. Please Wait..."), openWSE.AjaxCall("WebServices/SaveControls.asmx/DelCookie", '{ "name": "' + e + '" }', null, null, null, function () { loadingPopup.RemoveMessage() })) : cookieFunctions.set(e, "", -1) } }, openWSE = function () { var hf_r = "", handler = "", updateAppId = "", aboutHolder = "", autoupdaterunning = 0, innerScrollPos = 0, runningNoti = !1, runningMoreNoti = !1, innerModalContent = new Array, totalHelpPages = 0, canSortMyAppOverlay = !1, canSaveSortedMyAppOverlay = !1, saveHandler = "WebServices/SaveControls.asmx", loadingMessage = "<div class='loading-background-holder' data-usespinner='true'><div></div></div>", appMainClicked = 0, needpostback = 0, previewAppID = "", previewHover = !1, appsToLoad = new Array, maxBtn_InProgress = !1, minBtn_InProgress = !1, exitBtn_InProgress = !1, _topAboutPos = 0, _leftAboutPos = 0, canSaveSort = !1, uednTimeout, pageLoadingTimeout, topBarHt = 34, bottomBarHt = 28, currWinMode = "", pagedIconClicked = !1, outsideAppModal = "-outside-modal-window", resizingAppInProgress = !1, allOverlaysDisabled = !1, isMobileMode = !1, showAppPreviewInWorkspaceSelector = !0; function init() { saveHandler = openWSE.siteRoot() + "WebServices/SaveControls.asmx", cookieFunctions.get("siteTipsOnPageLoad", function (e) { if ("" != e && null != e && null != e && openWSE_Config.demoMode && (openWSE_Config.siteTipsOnPageLoad = ConvertBitToBoolean(e)), LoadViewPort(), GetCurrentPage(), LoadSidebarShowHideCookie(), SidebarNavToggleInit(), SiteTipsOnPageLoad(), $(document).tooltip({ disabled: !openWSE_Config.showToolTips }), openWSE_Config.ShowLoginModalOnDemoMode && LoadLoginModal(), $("#top-logo-holder img").width() > 100 && $("#top-logo-holder span").hide(), $(".iframe-top-bar .iframe-title-logo img").width() > 100 && $(".iframe-top-bar .iframe-title-logo span.title-text").hide(), getCurrentScrollTopForMainContainer(), RadioButtonStyle(), InitializeSlimScroll(), openWSE_Config.showScrollToTop && $("#main_container").length > 0) { var t = !0; -1 !== window.location.href.toLowerCase().indexOf("filemanager") && -1 !== window.location.href.toLowerCase().indexOf("edit=") && (t = !1), t && (($(".container-main-bg-simple").length > 0 || $(".app-remote-container").length > 0) && $("#main_container").css("padding-bottom", "65px"), $("#main_container").scroll(function () { if ($(this).scrollTop() > 0) { 0 === $("#main_container").find(".go-to-top").length && $("#main_container").append('<a class="go-to-top" title="Back to top" onclick="openWSE.AnimateToTop();return false;"></a>'); var e = 0; $("#footer_container").length > 0 && $("#footer_container").is(":visible") && (e = $("#footer_container").outerHeight()), $("#main_container").find(".go-to-top").css("bottom", e + 10 + "px") } else $("#main_container").find(".go-to-top").remove() })) } if (SetPageTdSettingsTitle(), SetupAccordions(), $("#sidebar_accordian").length > 0 && "true" === $("#sidebar_accordian").attr("data-icononly") && $("#sidebar_accordian").find(".app-icon-links").each(function () { var e = $.trim($(this).find(".app-icon-font").attr("data-pagetitle")); e && $(this).attr("title", e) }), $("#pnl_icons").length > 0) { var a = $("#pnl_icons").find(".app-icon.Icon_Only"); $("#pnl_icons").find(".app-icon.Icon_And_Color_Only").length > 0 && (a = $("#pnl_icons").find(".app-icon.Icon_And_Color_Only")), a.length > 0 && a.each(function () { var e = $.trim($(this).find(".app-icon-font").html()); e && $(this).attr("title", e) }) } openWSE_Config.canvasWorkspaceAppPreviews && isCanvasSupported() && CheckIfOnWorkspace() && openWSE.GetScriptFunction(openWSE.siteRoot() + "Scripts/jquery/html2canvas.js", null) }), openWSE.UpdateLogoSizeOnLoad($("#lnk_BackToWorkspace")) } function InitializeSlimScroll() { resizingAppInProgress || cookieFunctions.get("left-panel-scrolltop", function (e) { if (e = e ? parseInt(e) : 0, openWSE_Config.useSlimScrollPlugin ? ($("#sidebar_container").slimScroll({ color: "#AAA", width: "", height: $("#main_container").outerHeight() + $("#footer_container").outerHeight() }), setTimeout(function () { $("#sidebar_container").slimScroll({ scrollTo: e + "px" }) }, 1)) : setTimeout(function () { $("#sidebar_container").scrollTop(e) }, 1), $("#sidebar_container").length > 0) { var t = 0; $("#main_container").length > 0 && (t = $("#main_container").position().left), $("#sidebar_container, .slimScrollDiv").css("width", t + "px") } }) } function SetLeftSidebarScrollTop(e) { var t = $("#sidebar_container").scrollTop(); e && (t += e), cookieFunctions.set("left-panel-scrolltop", t, "30") } function UpdateAppSelector() { $(".clear-applist").remove(), $(".app-icon.Icon_Only").length > 0 ? ($("#updatePnl_AppList").append("<div class='clear-applist'></div>"), $(".app-category-div").length > 0 && $(".app-icon.Icon_Only").each(function () { $(this).parent().hasClass("app-category-div") && $(this).parent().addClass("inline-block") })) : $(".app-icon.Icon_And_Text_Only").length > 0 ? ($("#updatePnl_AppList").append("<div class='clear-applist'></div>"), $(".app-category-div").length > 0 && $(".app-icon.Icon_And_Text_Only").each(function () { $(this).parent().hasClass("app-category-div") && $(this).parent().addClass("inline-block") })) : $(".app-icon.Icon_And_Color_Only").length > 0 ? ($("#updatePnl_AppList").append("<div class='clear-applist'></div>"), $(".app-category-div").length > 0 && $(".app-icon.Icon_And_Color_Only").each(function () { $(this).parent().hasClass("app-category-div") && $(this).parent().addClass("inline-block") })) : $(".app-icon.Icon_Plus_Color_And_Text").length > 0 && ($("#updatePnl_AppList").append("<div class='clear-applist'></div>"), $(".app-category-div").length > 0 && $(".app-icon.Icon_Plus_Color_And_Text").each(function () { $(this).parent().hasClass("app-category-div") && $(this).parent().addClass("inline-block") })) } function SetPageTdSettingsTitle() { var e = $("#MainContent_pageTdSettingsTitle"); 0 === e.length && (e = $("#pageTdSettingsTitle")), e.length > 0 && openWSE.ConvertBitToBoolean(e.attr("data-customimage")) && e.parent().find(".title-line").length > 0 && e.parent().find(".title-line").attr("data-customimage", "true") } function SetDuplicateAppIcons() { var e = $("#updatePnl_AppList"); e.length > 0 && e.find(".app-icon").each(function () { var t = $(this).attr("data-appid"); if (e.find(".app-icon[data-appid='" + t + "']").length > 1) for (var a = 1; a < e.find(".app-icon[data-appid='" + t + "']").length; a++)e.find(".app-icon[data-appid='" + t + "']").eq(a).addClass("app-icon-duplicate") }) } function LoadLoginModal() { if ($("#pnl_Login_NonAuth").length > 0) { "<div class='Modal-overlay'>", "<div class='Modal-element-align'>", "<div class='Modal-element-modal'>", "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>", "<a href='#' onclick=\"openWSE.CloseLoginModalWindow();return false;\" class='ModalExitButton'></a>", "</div><span class='Modal-title'></span></div></div>", "<div class='ModalScrollContent'><div class='ModalPadContent'></div></div>", "</div></div></div></div>", $("body").find("form[id='ct101']").append("<div id='LoginModalPopup-element' class='Modal-element' style='display: none;'><div class='Modal-overlay'><div class='Modal-element-align'><div class='Modal-element-modal'><div class='ModalHeader'><div><div class='app-head-button-holder-admin'><a href='#' onclick=\"openWSE.CloseLoginModalWindow();return false;\" class='ModalExitButton'></a></div><span class='Modal-title'></span></div></div><div class='ModalScrollContent'><div class='ModalPadContent'></div></div></div></div></div></div>"), $("#pnl_Login_NonAuth").hide(), $("#LoginModalPopup-element").find(".ModalPadContent").append($("#login-modal-div")), LoadModalWindow(!0, "LoginModalPopup-element", $.trim($("#span_signinText").html())), $("#LoginModalPopup-element").find(".Modal-overlay").on("click", function (e) { "Modal-overlay" == e.target.className && openWSE.CloseLoginModalWindow() }), openWSE.SetLeftSidebarScrollTop(), $(window).resize() } } function CloseLoginModalWindow() { LoadModalWindow(!1, "LoginModalPopup-element", ""), $("#pnl_Login_NonAuth").length > 0 && $("#pnl_Login_NonAuth").find(".b").append($("#login-modal-div")), $("#LoginModalPopup-element").remove(), $("#pnl_Login_NonAuth").show() } function OnError(e, t) { openWSE.AjaxCall("WebServices/AppLog_Errors.asmx/AddError", '{ "message": "' + escape(e) + '","url": "' + escape(t) + '" }') } function SetContainerTopPos(e) { topBarHt = 0, bottomBarHt = $("#footer_container").outerHeight(), "none" !== $("#top_bar").css("display") && $("#top_bar").length > 0 ? topBarHt = $("#top_bar").outerHeight() : $("#top_bar_toolview_holder").length > 0 && (topBarHt = $("#top_bar_toolview_holder").outerHeight()), "none" == $("#footer_container").css("display") && (bottomBarHt = 0), $(".fixed-container-holder, .fixed-container-holder-background, .fixed-container-border-left, .fixed-container-border-right").css("top", topBarHt), $("#main_container, .administrator-workspace-note").css("bottom", bottomBarHt), e && ($("#iframe-content-src").length > 0 && ($("#iframe-content-src").css("height", $(window).height() - $(".remove-on-iframe-close").outerHeight()), $("#iframe-content-src").css("width", $(window).width())), openWSE.CheckIfCanAddMore()) } var tipIndex = 0, tipArray = new Array, activeElementBeforeRequest, activeElementTextBeforeRequest; function SiteTipsOnPageLoad() { openWSE_Config.siteTipsOnPageLoad && openWSE.AjaxCall("SiteTips.xml", null, { type: "GET", dataType: "xml", cache: !1 }, null, null, function (e) { if (0 == tipArray.length && $(e.responseText).find("Hint").each(function () { var e = $.trim($(this).html()); "" != e && tipArray.push(e) }), tipArray.length > 0) { tipIndex = Math.round(Math.random() * (tipArray.length - 1)); var t = "<div id='SiteTip-element-modal'>", a = "<input class='input-buttons nextprev-button' type='button' value='Next Tip' onclick=\"openWSE.NextSiteTip();\" />", o = "<input class='input-buttons nextprev-button' type='button' value='Previous Tip' onclick=\"openWSE.PreviousSiteTip();\" />"; 1 == tipArray.length && (a = "", o = ""); var n = "<div class='dont-show-again'><input id='dont-show-again-cb' type='checkbox' checked='checked' /><label for='dont-show-again-cb'>Show Tips on Page Load</label></div>"; "" !== openWSE_Config.groupLoginName && (n = ""), "" == openWSE_Config.siteTheme && (openWSE_Config.siteTheme = "Standard"), t += "<div class='tip-content-padding'>" + ("<img alt='confirm' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Icons/sitetip.png' />") + "<span class='tip-title'>Did you know?</span><div class='clear'></div><div class='message-text'>" + tipArray[tipIndex] + "</div>", t += "<div class='button-holder'>" + n + "<div class='clear-space'></div><div class='clear-space'></div>" + o + a + "<input class='input-buttons confirm-close-button' type='button' value='Close' onclick=\"openWSE.CloseSiteTip();\" /><div class='clear'></div></div></div>", t += "</div>", $("body").append(t), $("#SiteTip-element-modal").fadeIn(2 * openWSE_Config.animationSpeed), "true" === getParameterByName("mobileMode") && $(document.body).on("click", "#main_container", function () { $("#SiteTip-element-modal").length > 0 && openWSE.CloseSiteTip() }) } }) } function NextSiteTip() { ++tipIndex >= tipArray.length && (tipIndex = 0), $("#SiteTip-element-modal").find(".message-text").html(tipArray[tipIndex]) } function PreviousSiteTip() { --tipIndex < 0 && (tipIndex = tipArray.length - 1), $("#SiteTip-element-modal").find(".message-text").html(tipArray[tipIndex]) } function CloseSiteTip() { $("#dont-show-again-cb").prop("checked") || (openWSE_Config.demoMode ? cookieFunctions.set("siteTipsOnPageLoad", "false", "30") : openWSE.AjaxCall("WebServices/AcctSettings.asmx/TurnOffSiteTipsOnPageLoad")), tipIndex = 0, tipArray = new Array, $("#SiteTip-element-modal").remove() } function PagedWorkspace(e) { if (LoadCurrentWorkspace("1"), "" != e && 0 != $(".app-icon[data-appid='" + e + "']").length) { pagedIconClicked = !0; var t = $($(".app-icon[data-appid='" + e + "']")[0]); $(".app-main-holder[data-appid='" + e + "']").addClass("auto-full-page"), $(".app-main-holder[data-appid='" + e + "']").find(".app-head, .app-head-button-holder").hide(), t.trigger("click"); var a = "<div class='top-bar-menu-button'><ul><li class='a about-app-menu-toggle' title='About app' onclick=\"openWSE.AboutApp_PagedVersion('" + e + "');return false;\"></li></ul></div>", o = "<div class='top-bar-menu-button'><ul><li class='a close-app-menu-toggle' title='Close app' onclick=\"window.location.href='Default.aspx';return false;\"></li></ul></div>"; $("#top-button-holder").find(".searchwrapper-tools-search").length > 0 ? $("#top-button-holder").find(".searchwrapper-tools-search").before(a + o) : $("#top-button-holder").append(o) } } function AboutApp_PagedVersion(e) { e && ($("#MainContent_pnl_aboutHolder").html(""), $("#hf_aboutstatsapp").val("about;" + e), loadingPopup.Message("Loading. Please Wait..."), openWSE.CallDoPostBack("hf_aboutstatsapp", "")) } function IsComplexWorkspaceMode() { return "complex" == openWSE_Config.workspaceMode.toLowerCase() || "" == openWSE_Config.workspaceMode } function ConvertBitToBoolean(e) { if (null != e && null != e) { var t = $.trim(e.toString().toLowerCase()); if ("true" != t && "false" != t && "0" != t && "1" != t && "" != t) return !0; if ("1" == t || "true" == t || "" == t) return !0; if ("0" == t || "false" == t) return !1 } return !1 } function CheckIfOnWorkspace() { return -1 !== window.location.href.toLowerCase().indexOf("/default.aspx") || window.location.pathname.lastIndexOf("/") === window.location.pathname.length - 1 } function OpenMobileWorkspace() { var e = openWSE.siteRoot() + "AppRemote.aspx"; if (location.href.indexOf("SiteTools/") > 0) { var t = ""; -1 != (e = location.href).indexOf("#?") && (t = e.split("#?")[1], e = e.replace("#?" + t, "")), e = e.replace("#", ""), "" == location.search ? e += "?mobileMode=true&fromAppRemote=true" : e += "&mobileMode=true&fromAppRemote=true", "" != t && (e += "#?" + t) } return window.open(e, "_blank", "toolbar=no, scrollbars=yes, resizable=yes, width=340, height=550"), !1 } function CheckIfOverlaysExistsOnNonComplex() { $(".no-overlays-found").length > 0 && $(".no-overlays-found").remove(); var e = "You have no overlays being shown. Click the add button to add overlays."; (openWSE_Config.demoMode || 0 == $("#btn_addOverlayButton").length) && (e = "You have no overlays being shown."), allOverlaysDisabled && (e = "Select an application to run"), "" != getParameterByName("AppPage") && null != getParameterByName("AppPage") || ("pnl_OverlaysAll" == openWSE_Config.overlayPanelId || openWSE_Config.demoMode || allOverlaysDisabled || ($("#btn_addOverlayButton").remove(), $("#" + openWSE_Config.overlayPanelId).append("<div id='btn_addOverlayButton'><div class='clear-space'></div><a class='float-right margin-all' onclick='openWSE.CallOverlayList();return false;'>Add</a></div>"), e = "You have no overlays being shown. Click the add button to add overlays."), 0 == $(".workspace-overlay-selector").length && $("#" + openWSE_Config.overlayPanelId).append("<div class='pad-all-big no-overlays-found'>" + e + "</div>")) } function DisableOverlaysOnPagedWorkspace() { allOverlaysDisabled = !0, $("#btn_addOverlayButton").remove() } var currScrollPos_main_container = 0; function autoupdate(e, t, a) { "" == hf_r && "" != e && (hf_r = e), "" == handler && "" != t && (handler = t), "" == updateAppId && "" != a && (updateAppId = a), "" != hf_r && "" != handler && "" != updateAppId && 0 == autoupdaterunning && (openWSE.AjaxCall(t, '{ "_appId": "' + escape(updateAppId) + '" }', null, function (e) { var t = e.d[0]; if ("TURNOFF" != t) if ("refresh" == t) autoupdaterunning = 0, document.getElementById(hf_r).value = "refresh", openWSE.CallDoPostBack(hf_r, ""); else if ("workspace-check" == t) autoupdaterunning = 0, autoupdate(hf_r, handler, updateAppId); else if ("false" != t && "" != t) try { openWSE.ConvertBitToBoolean(e.d[1]) ? (autoupdaterunning = 0, loadingPopup.Message("Receiving Request..."), StartRemoteLoad(t, hf_r, handler, updateAppId)) : (autoupdaterunning = 0, document.getElementById(hf_r).value = t, openWSE.CallDoPostBack(hf_r, "")) } catch (e) { autoupdaterunning = 0, autoupdate(hf_r, handler, updateAppId) } else autoupdaterunning = 0, autoupdate(hf_r, handler, updateAppId); else autoupdaterunning = 1 }, function (e) { autoupdaterunning = 0, autoupdate(hf_r, handler, updateAppId) }), autoupdaterunning = 1) } function AdjustTableSettingsBox() { 0 == $(".pnl-section").length && $(".table-settings-box").length > 0 ? $(".table-settings-box").eq($(".table-settings-box").length - 1).addClass("no-border") : $(".pnl-section").length > 0 && $(".table-settings-box").length > 0 && $(".pnl-section").each(function () { var e = $(this).find(".table-settings-box").length; $(this).find(".table-settings-box").eq(e - 1).addClass("no-border") }) } function setCurrentScrollTopForMainContainer() { var e = $("#main_container"); 0 === e.length && (e = $("body")), cookieFunctions.set("currScrollTop", e.scrollTop(), "30") } function getCurrentScrollTopForMainContainer() { setTimeout(function () { var e = $("#main_container"); 0 === e.length && (e = $("body")), cookieFunctions.get("currScrollTop", function (t) { t && (e.scrollTop(t), cookieFunctions.del("currScrollTop")) }) }, 150) } function SiteStatusAdmin_Clicked() { loadingPopup.Message("Loading Information..."), openWSE.AjaxCall("WebServices/UpdateServerSettings.asmx/AdminOnlineInformation", "{ }", { dataFilter: function (e) { return e } }, function (e) { loadingPopup.RemoveMessage(), AdminOnlineInformationWindow(e) }, function (e) { openWSE.AlertWindow("An error occurred. Please try again.") }) } function AdminOnlineInformationWindow(e) { var t = $.trim(e.d); "" == t && (t = "No information available"); var a = "<div id='AdminOnlineInformation-element' class='Modal-element' style='display: none;'>"; a += "<div class='Modal-overlay'>", a += "<div class='Modal-element-align'>", a += "<div class='Modal-element-modal' data-setwidth='600'>", a += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>", a += "<a href='#' onclick=\"openWSE.CloseAdminOnlineInformationWindow();return false;\" class='ModalExitButton'></a>", a += "</div><span class='Modal-title'></span></div></div>"; a += "<div class='ModalScrollContent'><div class='ModalPadContent'>" + ("You can view more information regarding the status of the site by clicking <a href='" + openWSE.siteRoot() + "SiteTools/NetworkMaintenance/Analytics.aspx'>here</a><div class='clear-space'></div>") + t + "<div class='clear'></div></div></div>", a += "<div class='ModalButtonHolder'><input class='input-buttons modal-cancel-btn' type='button' value='Close' onclick=\"openWSE.CloseAdminOnlineInformationWindow();\" /><div class='clear'></div></div>", a += "</div></div></div></div>", $("body").append(a), LoadModalWindow(!0, "AdminOnlineInformation-element", "Site Information") } function CloseAdminOnlineInformationWindow() { LoadModalWindow(!1, "AdminOnlineInformation-element", ""), $("#AdminOnlineInformation-element").remove() } function AlertWindow(e, t) { if (e && e.statusText && (e = e.statusText), e && "string" == typeof e || (e = "An error has occured that was not specified."), "error" !== e && "Script error." !== e && "Internal Server Error" !== e) { var a = "<div id='AlertWindow-element' class='Modal-element' style='display: none;'>"; a += "<div class='Modal-overlay'>", a += "<div class='Modal-element-align'>", a += "<div class='Modal-element-modal' data-setwidth='370'>", a += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>", a += "<a href='#' onclick=\"openWSE.CloseAlertWindow();return false;\" class='ModalExitButton'></a>", a += "</div><span class='Modal-title'></span></div></div>"; var o = ""; openWSE_Config.reportAlert && (o = "<input class='input-buttons confirm-report-button modal-cancel-btn' type='button' value='Report' onclick=\"openWSE.ReportAlert('" + escape(e) + "','" + escape(t) + "');\" />"), "" == openWSE_Config.siteTheme && (openWSE_Config.siteTheme = "Standard"), a += "<div class='ModalScrollContent'><div class='ModalPadContent'><div class='message-text'><table cellpadding='0' cellspacing='0' width='100%'><tr><td valign='top' style='width: 50px;'>" + ("<img alt='confirm' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Icons/SiteMaster/alert.png' />") + "</td><td valign='middle'>" + e + "</td></tr></table><div class='clear'></div></div></div></div>", a += "<div class='ModalButtonHolder'><input class='input-buttons confirm-ok-button modal-ok-btn' type='button' value='Ok' onclick=\"openWSE.CloseAlertWindow();\" />" + o + "<div class='clear'></div></div>", a += "</div></div></div></div>", $("body").append(a), LoadModalWindow(!0, "AlertWindow-element", "Message"), setTimeout(function () { $("#AlertWindow-element").find(".confirm-ok-button").focus(), loadingPopup.RemoveMessage(), loadingPopup.BindF5KeyPress() }, 250) } } function CloseAlertWindow() { LoadModalWindow(!1, "AlertWindow-element", ""), $("#AlertWindow-element").length > 0 && ($("#AlertWindow-element").hide(), $("#AlertWindow-element").remove()), $("body").removeClass("modal-fixed-position-body"), $("#site_mainbody").length > 0 && "Boxed" === $("#site_mainbody").attr("data-layoutoption") && ($(".fixed-container-border-left").find(".Modal-overlay").remove(), $(".fixed-container-border-right").find(".Modal-overlay").remove(), $(".fixed-footer-container-left").find(".Modal-overlay").remove(), $(".fixed-footer-container-right").find(".Modal-overlay").remove()), loadingPopup.UnbindF5KeyPress() } function ReportAlert(e, t) { "" != t && null != t || (t = window.location.href), OnError(unescape(e), unescape(t)), CloseAlertWindow() } function ConfirmWindow(e, t, a) { "" != e && null != e || (e = "Are you sure you want to continue?"); var o = "<div id='ConfirmWindow-element' class='Modal-element' style='display: none;'>"; o += "<div class='Modal-overlay'>", o += "<div class='Modal-element-align'>", o += "<div class='Modal-element-modal' data-setwidth='370'>", o += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>", o += "<a href='#' onclick=\"openWSE.CloseConfirmWindow();return false;\" class='ModalExitButton confirm-cancel-button-header'></a>", o += "</div><span class='Modal-title'></span></div></div>"; "" == openWSE_Config.siteTheme && (openWSE_Config.siteTheme = "Standard"), o += "<div class='ModalScrollContent'><div class='ModalPadContent'><div class='message-text'><table cellpadding='0' cellspacing='0' width='100%'><tr><td valign='top' style='width: 50px;'>" + ("<img alt='confirm' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Icons/SiteMaster/confirm.png' />") + "</td><td valign='middle'>" + e + "</td></tr></table><div class='clear'></div></div></div></div>", o += "<div class='ModalButtonHolder'><input class='input-buttons confirm-ok-button modal-ok-btn' type='button' value='Ok' /><input class='input-buttons confirm-cancel-button modal-cancel-btn' type='button' value='Cancel' /><div class='clear'></div></div>", o += "</div></div></div></div>", $("body").append(o), $("#ConfirmWindow-element").find(".confirm-ok-button").one("click", function () { openWSE.CloseConfirmWindow(), null != t && t() }), $("#ConfirmWindow-element").find(".confirm-cancel-button, .confirm-cancel-button-header").one("click", function () { openWSE.CloseConfirmWindow(), null != a && a() }), LoadModalWindow(!0, "ConfirmWindow-element", "Confirmation"), setTimeout(function () { $("#ConfirmWindow-element").find(".confirm-ok-button").focus(), loadingPopup.RemoveMessage(), loadingPopup.BindF5KeyPress() }, 250) } function ConfirmWindowAltBtns(e, t, a) { "" != e && null != e || (e = "Are you sure you want to continue?"); var o = "<div id='ConfirmWindow-element' class='Modal-element' style='display: none;'>"; o += "<div class='Modal-overlay'>", o += "<div class='Modal-element-align'>", o += "<div class='Modal-element-modal' data-setwidth='370'>", o += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>", o += "<a href='#' onclick=\"openWSE.CloseConfirmWindow();return false;\" class='ModalExitButton confirm-cancel-button-header'></a>", o += "</div><span class='Modal-title'></span></div></div>"; "" == openWSE_Config.siteTheme && (openWSE_Config.siteTheme = "Standard"), o += "<div class='ModalScrollContent'><div class='ModalPadContent'><div class='message-text'><table cellpadding='0' cellspacing='0' width='100%'><tr><td valign='top' style='width: 50px;'>" + ("<img alt='confirm' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Icons/SiteMaster/confirm.png' />") + "</td><td valign='middle'>" + e + "</td></tr></table><div class='clear'></div></div></div></div>", o += "<div class='ModalButtonHolder'><input class='input-buttons confirm-ok-button modal-ok-btn' type='button' value='Yes' /><input class='input-buttons confirm-cancel-button modal-cancel-btn' type='button' value='No' /><div class='clear'></div></div>", o += "</div></div></div></div>", $("body").append(o), $("#ConfirmWindow-element").find(".confirm-ok-button").one("click", function () { openWSE.CloseConfirmWindow(), null != t && t() }), $("#ConfirmWindow-element").find(".confirm-cancel-button, .confirm-cancel-button-header").one("click", function () { openWSE.CloseConfirmWindow(), null != a && a() }), LoadModalWindow(!0, "ConfirmWindow-element", "Confirmation"), setTimeout(function () { $("#ConfirmWindow-element").find(".confirm-ok-button").focus(), loadingPopup.RemoveMessage() }, 250) } function CloseConfirmWindow() { LoadModalWindow(!1, "ConfirmWindow-element", ""), $("#ConfirmWindow-element").length > 0 && ($("#ConfirmWindow-element").hide(), $("#ConfirmWindow-element").remove()), $("body").removeClass("modal-fixed-position-body"), $("#site_mainbody").length > 0 && "Boxed" === $("#site_mainbody").attr("data-layoutoption") && ($(".fixed-container-border-left").find(".Modal-overlay").remove(), $(".fixed-container-border-right").find(".Modal-overlay").remove(), $(".fixed-footer-container-left").find(".Modal-overlay").remove(), $(".fixed-footer-container-right").find(".Modal-overlay").remove()), loadingPopup.UnbindF5KeyPress() } function OnBrowserClose() { openWSE.AjaxCall("WebServices/AcctSettings.asmx/OnBrowserClose", "", { dataFilter: function (e) { return e }, promise: function () { } }) } function CheckIfWorkspaceLinkAvailable() { var e = !1; return $("#pnl_Login_NonAuth").length > 0 ? e = !0 : $(".site-tools-tablist").each(function (t) { $(".site-tools-tablist").eq(t).find(".app-icon-links").each(function () { "workspace" == $(this).find(".app-icon-font").attr("data-pagetitle").toLowerCase() && (e = !0) }) }), e } Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(function (e, t) { $("#pnl_aboutHolder").length > 0 && "" != $.trim($("#pnl_aboutHolder").html()) && "block" == $("#aboutApp-element").css("display") && (aboutHolder = $.trim($("#pnl_aboutHolder").html())), SaveInnerModalContent(t), $("#main_container").length > 0 && (currScrollPos_main_container = $("#main_container").scrollTop()), activeElementBeforeRequest = null, activeElementTextBeforeRequest = null; try { document.activeElement && "body" != document.activeElement.localName.toLowerCase() && (activeElementBeforeRequest = $(document.activeElement).attr("id")) && (activeElementBeforeRequest = "#" + activeElementBeforeRequest, "input" == document.activeElement.localName.toLowerCase() && "text" == document.activeElement.type.toLowerCase() && (activeElementTextBeforeRequest = document.activeElement.value)) } catch (e) { } setCurrentScrollTopForMainContainer(), SaveAccordionState(!0), SetLeftSidebarScrollTop() }), Sys.WebForms.PageRequestManager.getInstance().add_endRequest(function () { $(".ui-tooltip-content").parents("div").remove(), "" != aboutHolder && ($("#MainContent_pnl_aboutHolder").html(aboutHolder), aboutHolder = ""), loadingPopup.RemoveMessage(), LoadSavedInnerModalContent(), RefreshNotifications(), autoupdate(hf_r, handler, updateAppId), ShowNewNotificationPopup(), CheckIfOverlaysExistsOnNonComplex(), $("#main_container").length > 0 && currScrollPos_main_container >= 0 && setTimeout(function () { $("#main_container").scrollTop(currScrollPos_main_container), currScrollPos_main_container = 0 }, 1), setTimeout(function () { try { activeElementBeforeRequest && null != activeElementBeforeRequest && ($(activeElementBeforeRequest).focus(), activeElementTextBeforeRequest && null != activeElementTextBeforeRequest && $(activeElementBeforeRequest).val(activeElementTextBeforeRequest)) } catch (e) { } activeElementBeforeRequest = null, activeElementTextBeforeRequest = null }, 1), getCurrentScrollTopForMainContainer(), RadioButtonStyle(), openWSE.SetDuplicateAppIcons(), openWSE.ToggleMinimizedAppBar(), getCurrentPostitionForModalWindow(), SetupAccordions(!0), ReapplyActiveIcons(), $(window).resize() }), $(document.body).on("click", ".RandomActionBtns", function () { 0 != $(this).closest(".searchwrapper").length ? loadingPopup.Message("Searching...") : loadingPopup.Message("Updating. Please Wait...") }), $(document.body).on("click", "#lbtn_signoff", function () { loadingPopup.Message("Logging Off. Please Wait...") }), $(document.body).on("keypress", ".searchwrapper-tools-search > input[type='text']", function (e) { 13 == e.which && ($(this).focus(), e.preventDefault(), SearchSite()) }), $(document.body).on("click", ".content-main, .Modal-overlay, #iframe-container-helper, .fixed-container-holder-background", function (e) { 0 === $(e.target).closest("#overlayEdit-element").length && CloseTopDropDowns() }), $(document.body).on("click", ".top-bar-menu-button li.a, .top-bar-userinfo-button li.a", function () { var e = $(this).closest(".top-bar-menu-button, .top-bar-userinfo-button").attr("id"), t = $(this).next(); if (1 == t.length) if (t.is(":visible")) CloseTopDropDowns(); else { switch (CloseTopDropDowns(), (isMobileDevice() || -1 !== window.location.href.toLowerCase().indexOf("appremote.aspx")) && $("body").append("<div class='sidebar-overlay' onclick='openWSE.CloseTopDropDowns();' style='display: block;'></div>"), t.show(), ResizeTopDropDowns(), e) { case "notifications_tab": openWSE.GetUserNotifications(); break; case "background_tab": openWSE.BackgroundSelector(!0); break; case "group_tab": openWSE.GroupLoginModal(); break; case "settings_tab": openWSE.InitializeThemeColorOption("div_ColorOptionsHolder"); break; case "workspace-selector": openWSE.SetBackgroundForWorkspaceDropdown() }$(this).closest(".top-bar-menu-button, .top-bar-userinfo-button").addClass("active") } else CloseTopDropDowns() }), $(document.body).on("click", ".help-icon", function () { HelpOverlay(!1) }), $(document.body).on("click", ".workspace-reminder", function () { var e = $(this).parent(); return $(".app-popup").css("display", "none"), $popup = e.find(".app-popup"), $popup.css("display", "block"), $popup.fadeIn(openWSE_Config.animationSpeed), !1 }), $(document.body).on("mouseover", ".app-icon", function (e) { var t = $(this).find(".app-options"); t.length > 0 && t.css("visibility", "visible") }), $(document.body).on("mouseleave", ".app-icon", function (e) { var t = $(this).find(".app-options"), a = $(this).find(".app-popup"); t.length > 0 && a.length > 0 && (t.css("visibility", "hidden"), a.hide()) }), $(document.body).on("mouseleave", ".app-popup", function (e) { $(this).hide() }), $(document.body).on("click", ".app-icon", function () { if (-1 !== window.location.href.toLowerCase().indexOf("appremote.aspx")) return !0; var e = $(this); if (CloseTopDropDowns(), e.hasClass("app-icon-parms")) return !1; if (openWSE.IsComplexWorkspaceMode() || pagedIconClicked || -1 != window.location.href.toLowerCase().indexOf("appmanager.aspx")) if ($("#workspace_holder").length > 0) { var t = Getworkspace(), a = e.attr("data-appid"), o = $(".app-main-holder[data-appid='" + a + "']"); o.length > 0 && o.hasClass("app-min-bar-preview") && (o.css("opacity", "0.0"), o.css("filter", "alpha(opacity=0)"), o.removeClass("app-min-bar-preview"), ResizeAppBody(o)), LoadApp(e, t), 0 == e.hasClass("active") && e.addClass("active") } else $("#pnl_icons").length > 0 && BuildOpenAppPopup(this); else { var n = "?AppPage=" + e.attr("data-appId"), i = window.location.href.split(/default.aspx/i); if (CheckIfOnWorkspace() && 1 === i.length && i.push(""), i.length > 1 && i[i.length - 1]) if (-1 === i[i.length - 1].toLowerCase().indexOf("apppage=")) n = i[i.length - 1] + "&AppPage=" + e.attr("data-appId"); else { var r = i[i.length - 1].substring(1).split("&"); if (r.length > 1) { n = ""; for (var l = 0; l < r.length; l++)r[l] && -1 === r[l].toLowerCase().indexOf("apppage") && (n += n ? "&" + r[l] : "?" + r[l]); n += n ? "&AppPage=" + e.attr("data-appId") : "?AppPage=" + e.attr("data-appId") } } window.location.href = openWSE.siteRoot() + "Default.aspx" + n } return pagedIconClicked = !1, !1 }), $(document.body).on("click", ".minimize-button-app", function () { if (!minBtn_InProgress) { CloseTopDropDowns(), minBtn_InProgress = !0; var e = $(this).attr("href").replace("#", ""), t = $(".app-main-holder[data-appid='" + e + "']"), a = t.find(".app-title").eq(0).text(), o = t.css("left"), n = t.css("top"), i = t.width(), r = t.height(), l = Getworkspace(); if (0 == $(".app-min-bar[data-appid='" + e + "']").length) { var s = 0; t.hasClass("app-maximized") || t.hasClass("auto-full-page") || (s = ($(window).height() - $("#top_bar").outerHeight()) / 2 - t.outerHeight() / 2, (s -= 25) < 0 && (s = 0)), t.animate({ opacity: 0, left: 0, top: s }, openWSE_Config.animationSpeed, function () { BuildAppMinIcon(t, a, o, n), MoveOffScreen(t), SetContainerTopPos(!0), openWSE.AjaxCall(saveHandler + "/App_Minimize", '{ "appId": "' + e + '","name": "' + a + '","x": "' + o + '","y": "' + n + '","width": "' + i + '","height": "' + r + '","workspace": "' + l + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', null, function (e) { minBtn_InProgress = !1 }, function (e) { minBtn_InProgress = !1 }) }) } } return !1 }), $(document.body).on("dblclick", ".app-head-dblclick", function () { return maxBtn_InProgress || (maxBtn_InProgress = !0, MaximizeApp($(this).closest(".app-main-holder"))), !1 }), $(document.body).on("click", ".maximize-button-app", function () { return maxBtn_InProgress || (CloseTopDropDowns(), maxBtn_InProgress = !0, MaximizeApp($(this).closest(".app-main-holder"))), !1 }), $(document.body).on("click", ".exit-button-app, .exit-button-app-min", function () { if (!exitBtn_InProgress) { CloseTopDropDowns(), exitBtn_InProgress = !0; var e = $(this).attr("href").replace("#", ""); $(".app-snap-helper[data-appid='" + e + "']").remove(); var t = $(".app-main-holder[data-appid='" + e + "']"); $(".app-min-bar[data-appid='" + e + "']").length > 0 && ($(".app-min-bar[data-appid='" + e + "']").remove(), SetContainerTopPos(!0)); t.find(".app-title").eq(0).text(); t.hasClass("app-min-bar-preview") && (t.css("opacity", "0.0"), t.css("filter", "alpha(opacity=0)"), t.removeClass("app-min-bar-preview"), previewHover = !1, previewAppID = "", SetAppMinToMax(e)), RemoveworkspaceAppNum(t), RemoveAppIconActive(t), t.fadeOut(openWSE_Config.animationSpeed, function () { t.hasClass("app-maximized") && t.removeClass("app-maximized"), -1 != t.attr("data-appid").indexOf("app-ChatClient-") && t.remove(); var a = 1; null != document.getElementById("hf_" + e.replace(/#/gi, "")) && (a = 0), null == t.find(".app-body").find("div").html() ? 1 == a && t.find(".app-body").html("") : 1 == a && t.find(".app-body").find("div").html(""), t.css({ visibility: "hidden", left: "", top: "", width: "", height: "" }), t.find(".app-body").css({ height: "", width: "" }), t.find(".options-button-app").length > 0 && (t.find(".options-button-app").removeClass("active"), t.find(".app-popup-inner-app").hide(), "Style_3" == openWSE_Config.appStyle && (t.find(".app-head-button-holder").hide(), optionsOpen_Style3 = !1)); var o = t.attr("data-appid") + outsideAppModal; $("." + o).each(function () { $(this).remove() }), RemoveCSSFilesOnAppClose(t.attr("data-appid")), openWSE.AjaxCall(saveHandler + "/App_Close", '{ "appId": "' + e + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', null, function (e) { exitBtn_InProgress = !1 }, function (e) { exitBtn_InProgress = !1 }) }) } return openWSE.ToggleMinimizedAppBar(), !1 }), $(document.body).on("click", ".app-min-bar", function () { CloseTopDropDowns(); var e = $(this).attr("data-appid"), t = $(".app-main-holder[data-appid='" + e + "']"); t.hasClass("app-min-bar-preview") && (t.css("opacity", "0.0"), t.css("filter", "alpha(opacity=0)"), t.removeClass("app-min-bar-preview")); var a = Getworkspace(); return openWSE.SetLeftSidebarScrollTop(), LoadApp(t, a), $(window).resize(), !1 }), $(document.body).on("click", ".app-main-holder", function (e) { SetActiveApp(this), appMainClicked = 1 }), $(document.body).on("click", ".workspace-holder", function () { openWSE.IsComplexWorkspaceMode() && 0 == appMainClicked && ($(".app-main-holder").removeClass("selected"), SetDeactiveAll()), appMainClicked = 0 }), $(document.body).on("click", ".options-button-app", function () { CloseTopDropDowns(); var e = $(this), t = e.parent(); if ("block" == t.find(".app-popup-inner-app").css("display")) e.removeClass("active"), t.find(".app-popup-inner-app").slideUp(openWSE_Config.animationSpeed), "Style_3" == openWSE_Config.appStyle && (optionsOpen_Style3 = !1); else { e.addClass("active"); var a = t.find(".app-popup-inner-app").find(".app-options-workspace-switch"); if (a.length > 0) { var o = e.closest(".workspace-holder").attr("id").replace("MainContent_workspace_", ""); a.val(o) } t.find(".app-popup-inner-app").slideDown(openWSE_Config.animationSpeed), SetActiveApp(t.parent()), "Style_3" == openWSE_Config.appStyle && (optionsOpen_Style3 = !0) } return !1 }), $(document.body).on("change", ".app-popup-selector, .app-options-workspace-switch", function () { if ("" != $.trim($(this).val()) && "-" != $.trim($(this).val())) if ($("#workspace_holder").length > 0) { MoveAppToworkspace(this); var e = $(this).closest(".app-head-button-holder").parent().find(".options-button-app"); if (e.length > 0) { var t = e.parent(); e.removeClass("active"), t.find(".app-popup-inner-app").hide(), "Style_3" == openWSE_Config.appStyle && (t.find(".app-head-button-holder").hide(), optionsOpen_Style3 = !1) } } else { BuildOpenAppPopup($(this).closest(".app-icon")) } }), $(document.body).on("click", ".app-options", function () { CloseTopDropDowns(), $(".app-popup").css("display", "none"), $(".app-popup-holder").css("margin-left", ""); var e = $(this).find(".app-popup"); e.show(); var t = e.offset().left + e.outerWidth(); return t + 20 > $("#sidebar_container").outerWidth() + $("#sidebar_container").offset().left && e.find(".app-popup-holder").css("margin-left", "-" + Math.abs(t - ($("#sidebar_container").outerWidth() + $("#sidebar_container").offset().left) + 20).toString() + "px"), e.find(".app-popup-selector").val("-"), $(".ui-tooltip").remove(), !1 }), $(document.body).on("keypress", "input[type='text'], textarea", function (e) { if (!$(this).hasClass("mce-textbox") && !$(this).parent().hasClass("ace_editor") && !$(this).attr("data-allowallchars")) { var t = e.which ? e.which : e.keyCode; if (!String.fromCharCode(t).match('^.*?(?=[^"#%&$*<>?{|}]).*$')) return !1 } }); var triggerRadioButtonClick = !1; function RadioButtonStyle() { $(".RadioButton-Toggle-Overlay").remove(), $(".switch").each(function () { var e = $(this); if (0 == e.find(".RadioButton-Toggle-Overlay").length) { var t = $(this).find(".cb-enable"), a = $(this).find(".cb-disable"); 0 == e.find(".switch-slider").length ? (e.append("<div class='switch-slider'><table class='switch-slider-table' cellpadding='0' cellspacing='0'><tbody><tr><td class='td-enable'></td><td class='td-switch' title='Click or Drag'></td><td class='td-disable'></td></tr></tbody></table></div>"), e.find(".td-enable").append(t), e.find(".td-switch").html("<span class='RadioButton-Toggle-Overlay'></span>"), e.find(".td-disable").append(a), t.removeClass("RandomActionBtns"), a.removeClass("RandomActionBtns")) : e.find(".td-switch").html("<span class='RadioButton-Toggle-Overlay'></span>"); var o = e.find(".cb-enable").outerWidth(); 0 == o && (o = e.find(".cb-enable").find("label").outerWidth()); var n = o + e.find(".RadioButton-Toggle-Overlay").outerWidth(); e.width(n - 2); var i = e.outerWidth() - e.find(".RadioButton-Toggle-Overlay").outerWidth() + 2, r = t.find("input"), l = a.find("input"); RadioButtonHasCheckedAttr(r) && r.prop("checked") || t.hasClass("selected") ? (t.addClass("selected"), a.removeClass("selected"), r.prop("checked", !0), l.prop("checked", !1), e.find(".switch-slider").css("left", 0)) : (a.addClass("selected"), t.removeClass("selected"), l.prop("checked", !0), r.prop("checked", !1), e.find(".switch-slider").css("left", -i)), e.find(".switch-slider").draggable({ cancel: ".cb-enable, .cb-disable", axis: "x", drag: function (e, t) { var a = $(this).parent().outerWidth() - $(this).find(".RadioButton-Toggle-Overlay").outerWidth() + 2; return t.position.left < -a ? ($(this).css("left", -a), !1) : t.position.left >= 0 ? ($(this).css("left", 0), !1) : void 0 }, stop: function (t, a) { var o = ($(this).parent().outerWidth() - $(this).find(".RadioButton-Toggle-Overlay").outerWidth() + 2) / 2, n = !1, i = !0; e.find(".cb-disable").each(function () { $(this).find("input").attr("checked"); $(this).hasClass("selected") && (i = !1) }), a.position.left > -o ? (n = !0, $(this).animate({ left: 0 }, openWSE_Config.animationSpeed)) : $(this).animate({ left: -2 * o }, openWSE_Config.animationSpeed), i && !n ? (triggerRadioButtonClick = !0, e.find(".cb-disable").hasClass("no-postback") && (e.find(".cb-enable").find("input").prop("checked", !1), e.find(".cb-disable").find("input").prop("checked", !0), e.find(".cb-enable").removeClass("selected"), e.find(".cb-disable").addClass("selected")), e.find(".cb-disable").find("input").trigger("click")) : !i && n && (triggerRadioButtonClick = !0, e.find(".cb-enable").hasClass("no-postback") && (e.find(".cb-enable").find("input").prop("checked", !0), e.find(".cb-disable").find("input").prop("checked", !1), e.find(".cb-enable").addClass("selected"), e.find(".cb-disable").removeClass("selected")), e.find(".cb-enable").find("input").trigger("click")) } }) } }) } function RadioButtonHasCheckedAttr(e) { if ($(e)[0] && null !== $(e)[0].attributes) { var t = $(e)[0].attributes.checked; if (void 0 !== t && !1 !== t) return !0 } return !1 } function RatingStyleInit(div, rating, disabled, appId, useLargeStars) { try { var _disabled = !1; disabled && (_disabled = !0); var imagePath = openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme; $(div).attr("data-average", rating), $(div).attr("data-id", "1"); var sizeType = "big"; useLargeStars || (sizeType = "small"), eval(function (e, t, a, o, n, i) { if (n = function (e) { return (e < 62 ? "" : n(parseInt(e / 62))) + ((e %= 62) > 35 ? String.fromCharCode(e + 29) : e.toString(36)) }, !"".replace(/^/, String)) { for (; a--;)i[n(a)] = o[a] || n(a); o = [function (e) { return i[e] }], n = function () { return "\\w+" }, a = 1 } for (; a--;)o[a] && (e = e.replace(new RegExp("\\b" + n(a) + "\\b", "g"), o[a])); return e }("(8($){$.1F.1t=8(1p){6 1o={1n:'1g/1f/26.1e',1d:'1g/1f/1c.1e',1b:'1a/1t.1a',1y:'1A',18:m,17:m,w:y,14:m,13:y,V:5,Z:0,n:20,W:-2g,11:5,1j:1,K:J,T:J,I:J};7(4.V>0)F 4.1C(8(){6 3=$.2d(1o,1p),a=0,h=0,g=0,z='',L=m,M=0,N=3.1j;7($(4).2h('o')||3.17)6 o=y;H 6 o=m;1l();$(4).1k(g);6 f=19($(4).15('j-f')),r=t($(4).15('j-1E')),q=h*3.V,1h=f/3.n*q,2e=$('<X>',{'k':'2m',9:{c:1h}}).A($(4)),f=$('<X>',{'k':'1D',9:{c:0,U:-g}}).A($(4)),2p=$('<X>',{'k':'1H',9:{c:q,1k:g,U:-(g*2),1N:'1P('+z+') 1S-x'}}).A($(4));$(4).9({c:q,1Y:'21',22:1,24:'25'});7(!o)$(4).16().2a({2c:8(e){6 s=G(4);6 i=e.D-s;7(3.w)6 1z=$('<p>',{'k':'B',l:u(i)+' <E k=\"Y\">/ '+3.n+'</E>',9:{U:(e.1G+3.11),1i:(e.D+3.W)}}).A('1I').1J()},1K:8(e){$(4).9('S','1L')},1M:8(){$(4).9('S','R');7(L)f.c(M);H f.c(0)},1O:8(e){6 s=G(4);6 i=e.D-s;7(3.18)a=Q.1Q(i/h)*h+h;H a=i;f.c(a);7(3.w)$(\"p.B\").9({1i:(e.D+3.W)}).l(u(a)+' <E k=\"Y\">/ '+3.n+'</E>')},1R:8(){$(\"p.B\").1m()},1T:8(e){6 C=4;L=y;M=a;N--;7(!3.14||t(N)<=0)$(4).16().9('S','R').1U('o');7(3.w)$(\"p.B\").1V('1W',8(){$(4).1m()});e.1X();6 d=u(a);f.c(a);$('.1Z p').l('<b>r : </b>'+r+'<1q /><b>d : </b>'+d+'<1q /><b>1r :</b> 1s');$('.P p').l('<b>27...</b>');7(3.I)3.I(C,d);7(3.13){$.28(3.1b,{r:r,d:d,1r:'1s'},8(j){7(!j.29){$('.P p').l(j.1u);7(3.K)3.K(C,d)}H{$('.P p').l(j.1u);7(3.T)3.T(C,d)}},'2b')}}});8 u(i){6 1v=19((i*1w/q)*t(3.n)/1w);6 O=Q.2f(10,t(3.Z));6 1x=Q.2i(1v*O)/O;F 1x};8 1l(){2j(3.1y){2k'1c':h=12;g=10;z=3.1d;2l;R:h=23;g=20;z=3.1n}};8 G(v){7(!v)F 0;F v.2n+G(v.2o)}})}})(1B);", 0, 150, "|||opts|this||var|if|function|css|newWidth|strong|width|rate||average|starHeight|starWidth|relativeX|data|class|html|false|rateMax|jDisabled||widthRatingContainer|idBox|realOffsetLeft|parseInt|getNote|obj|showRateInfo||true|bgPath|appendTo|jRatingInfos|element|pageX|span|return|findRealLeft|else|onClick|null|onSuccess|hasRated|globalWidth|nbOfRates|dec|serverResponse|Math|default|cursor|onError|top|length|rateInfosX|div|maxRate|decimalLength||rateInfosY||sendRequest|canRateAgain|attr|unbind|isDisabled|step|parseFloat|php|phpPath|small|smallStarsPath|png|icons|jquery|widthColor|left|nbRates|height|getStarWidth|remove|bigStarsPath|defaults|op|br|action|rating|jRating|server|noteBrut|100|note|type|tooltip|big|jQuery|each|jRatingAverage|id|fn|pageY|jStar|body|show|mouseover|pointer|mouseout|background|mousemove|url|floor|mouseleave|repeat|click|addClass|fadeOut|fast|preventDefault|overflow|datasSent||hidden|zIndex||position|relative|stars|Loading|post|error|bind|json|mouseenter|extend|quotient|pow|45|hasClass|round|switch|case|break|jRatingColor|offsetLeft|offsetParent|jstar".split("|"), 0, {})), $(div).jRating({ step: !0, type: sizeType, showRateInfo: !1, canRateAgain: !0, nbRates: 100, bigStarsPath: imagePath + "/Icons/Star_Rating/star-rating-lrg.png", smallStarsPath: imagePath + "/Icons/Star_Rating/star-rating-sml.png", isDisabled: _disabled, decimalLength: 2, length: 4, rateMax: 4, rateMin: 0, phpPath: "", sendRequest: !0, onClick: function (e, t) { $("#AppRating-element").remove(); $("body").append("<div id='AppRating-element' class='Modal-element'><div class='Modal-overlay'><div class='Modal-element-align'><div class='Modal-element-modal' style='min-width: 350px;'><div class='ModalHeader'><div><div class='app-head-button-holder-admin'></div><span class='Modal-title'></span></div></div><div class='ModalScrollContent'><div class='ModalPadContent'></div></div></div></div></div></div>"); var a = "<div class='pad-bottom'>Add a comment to your rating or just press Submit.</div>"; a += "<textarea id='app-rating-comment' rows='4' cols='40' style='width: 96%; font-family: arial; font-size: 14px; padding: 5px; border: 1px solid #DDD;'></textarea>", a += "<div class='clear-space'></div>", a += "<input class='float-right no-margin input-buttons' type='button' value='Cancel' onclick='openWSE.ResetRating(\"" + div + '", "' + rating + '", ' + disabled + ', "' + appId + '", ' + useLargeStars + ');$("#AppRating-element").remove();\' />', a += "<input class='float-left no-margin input-buttons' type='button' value='Submit' onclick='openWSE.UpdateAppRating(\"" + div + '", "' + t + '", ' + disabled + ', "' + appId + '", ' + useLargeStars + ");' />", a += "<div class='clear-space-five'></div>", $("#AppRating-element").find(".ModalPadContent").html(a), LoadModalWindow(!0, "AppRating-element", "Rating Comment") } }), useLargeStars || $(div).find(".jStar").addClass("jStar-Small") } catch (e) { } } function UpdateAppRating(e, t, a, o, n) { loadingPopup.Message("Updating rating..."), openWSE.AjaxCall("WebServices/SaveControls.asmx/UpdateAppRating", '{ "rating": "' + t + '","appId": "' + o + '","description": "' + $("#app-rating-comment").val() + '" }', null, function (i) { $("#AppRating-element").remove(), loadingPopup.RemoveMessage(), openWSE.ResetRating(e, t, a, o, n), $(".app-main-holder[data-appid='" + o + "']").find(".app-popup-inner-app").length > 0 ? (loadingPopup.Message("Updating rating..."), openWSE.AboutApp($(".app-main-holder[data-appid='" + o + "']").find(".app-popup-inner-app")[0])) : $("#hf_refreshAppAbout").length > 0 && (loadingPopup.Message("Updating rating..."), "block" === $("#aboutApp-element").css("display") ? $("#hf_refreshAppAbout").val(o) : $("#hf_refreshAppAbout").val("refresh"), openWSE.CallDoPostBack("hf_refreshAppAbout", "")) }) } function ResetRating(e, t, a, o, n) { $(e).html(""), RatingStyleInit(e, t, a, o, n) } function OpenAppNoti(e) { if (CloseTopDropDowns(), openWSE.IsComplexWorkspaceMode()) if ($("#workspace_holder").length > 0) { if ("none" == $(".app-main-holder[data-appid='" + e + "']").css("display")) { needpostback = 1; var t = Getworkspace(); LoadApp($(".app-main-holder[data-appid='" + e + "']"), t) } } else BuildOpenAppPopup($(".app-icon[data-appid='" + e + "']")); else window.location.href = openWSE.siteRoot() + "Default.aspx?AppPage=" + e } function SearchSite() { var e = $.trim($(".searchwrapper-tools-search").find("input[type='text']").val()); "" != e && (loadingPopup.Message("Searching. Please Wait..."), document.getElementById("hf_SearchSite").value = e, CloseTopDropDowns(), $(".searchwrapper-tools-search").find("input[type='text']").val(""), openWSE.CallDoPostBack("hf_SearchSite", "")) } function SearchExternalSite(e) { CloseTopDropDowns(), window.open("http://google.com/search?q=" + e) } function BuildOpenAppPopup(e) { var t = $(e), a = "<div id='ConfirmApp-element' class='Modal-element' style='display: none;'>"; a += "<div class='Modal-overlay'>", a += "<div class='Modal-element-align'>", a += "<div class='Modal-element-modal' style='width: 400px; min-width: 400px;'>", a += "<div class='ModalHeader'><div><span class='Modal-title'></span></div></div>"; var o = t.find(".app-icon-font").text(); "" == o && "" == (o = t.find(".app-title").eq(0).text()) && (o = t.find("span").text()); var n = t.attr("data-appid"), i = ""; "" != t.attr("popoutloc") && null != t.attr("popoutloc") && null != t.attr("popoutloc") && (i = "<div class='clear-space'></div><a href='#' onclick='openWSE.PopOutFrameFromSiteTools(\"" + o + '", "' + t.attr("popoutloc") + "\");return false;'>Open in new window</a><div class='clear'></div>"); var r = "1"; "" != t.attr("currentworkspace") && null != t.attr("currentworkspace") && null != t.attr("currentworkspace") && (r = t.attr("currentworkspace")), "-" !== t.find(".app-popup-selector").val() && (r = t.find(".app-popup-selector").val()); var l = "<input type='button' class='input-buttons modal-ok-btn' value='Yes' onclick='openWSE.LoadAppFromSiteTools(\"" + n + '", "' + o + '", "workspace_' + r + "\");' />", s = "<input type='button' class='input-buttons modal-cancel-btn' value='No' onclick=\"$('#ConfirmApp-element').remove();return false;\" />", d = "You must be on the workspace to load this app. Would you like to go back to your workspace?"; if (!openWSE.CheckIfWorkspaceLinkAvailable()) { l = ""; s = "<input type='button' class='input-buttons modal-cancel-btn' value='Close' onclick=\"$('#ConfirmApp-element').remove();return false;\" />"; d = "You are not authorized to use the workspace. ", "" != i && (d += "However, you can open this app in a seperate window.") } a += "<div class='ModalScrollContent'><div class='ModalPadContent'>", a += d + i + "<div class='clear'></div>", a += "</div></div>", a += "<div class='ModalButtonHolder'>" + l + s + "<div class='clear'></div></div>", a += "</div></div></div></div>", $("body").append(a), openWSE.LoadModalWindow(!0, "ConfirmApp-element", "Open " + o) } function LoadModalWindow(e, t, a, o) { 0 != t.indexOf("#") && (t = "#" + t); var n = $(t); if (e) { n.show(); var i = n.find(".Modal-element-modal"), r = ".ModalScrollContent, .ModalPadContent, .ModalExitButton, .ModalButtonHolder"; "Style_2" == openWSE_Config.appStyle ? (n.addClass("modal-style2"), n.find(".ModalExitButton").html("<span></span>"), i.append(n.find(".ModalHeader"))) : "Style_3" == openWSE_Config.appStyle ? (n.addClass("modal-style3"), n.find(".ModalHeader-hoverclass").remove(), n.find(".move-button-modal").remove(), n.find(".Modal-element-modal").prepend("<div class='ModalHeader-hoverclass'></div>"), n.find(".ModalHeader > div").prepend("<a class='move-button-modal' title='Move'></a>"), n.find(".ModalHeader-hoverclass").unbind("mouseenter"), n.find(".ModalHeader").unbind("mouseleave"), n.find(".ModalHeader-hoverclass").bind("mouseenter", function () { $(this).parent().find(".ModalHeader").show() }), n.find(".ModalHeader").bind("mouseleave", function () { $(this).hide() }), r += ", .Modal-title") : n.addClass("modal-style1"), o || (o = "body"); parseInt(i.attr("data-setwidth")); if (null != i.attr("data-setwidth") && "" != i.attr("data-setwidth")) { var l = Math.round(parseInt(i.attr("data-setwidth")) / 1.7); null != i.attr("data-setmaxheight") && "" != i.attr("data-setmaxheight") && (l = parseInt(i.attr("data-setmaxheight"))), i.find(".ModalScrollContent").css("max-height", l), i.find(".ModalScrollContent").attr("data-tempmaxheight", l), i.css({ width: parseInt(i.attr("data-setwidth")), minWidth: parseInt(i.attr("data-setwidth")) }) } else $(o).width() > 100 && i.css("max-width", $(o).width() - 100), $(o).height() > 100 && (i.find(".ModalScrollContent").css("max-height", $(o).height() - 100), i.find(".ModalScrollContent").attr("data-tempmaxheight", $(o).height() - 100)); n.attr("data-containment", o), i.draggable({ containment: o, cancel: r, drag: function (e, t) { var a = $(this); if (a.css("opacity", "0.6"), a.css("filter", "alpha(opacity=60)"), a.find("iframe").length > 0) { var o = a.find(".ModalScrollContent"); $wo = o.find(".app-overlay-fix"), 0 == $wo.length && 1 == o.length && o.append("<div class='app-overlay-fix'></div>") } }, stop: function (e, t) { var a = $(this); a.css("opacity", "1.0"), a.css("filter", "alpha(opacity=100)"), $wo = $(this).find(".app-overlay-fix"), 1 == $wo.length && $wo.remove() } }), "" != a && n.find(".Modal-title").html(a), FinishModalLoad(t) } else n.hide(), n.css("visibility", "hidden"), n.find(".Modal-title").html(""), $("body").removeClass("modal-fixed-position-body"), $("#site_mainbody").length > 0 && "Boxed" === $("#site_mainbody").attr("data-layoutoption") && ($(".fixed-container-border-left").find(".Modal-overlay").remove(), $(".fixed-container-border-right").find(".Modal-overlay").remove(), $(".fixed-footer-container-left").find(".Modal-overlay").remove(), $(".fixed-footer-container-right").find(".Modal-overlay").remove()), setTimeout(function () { if (n.hasClass("outside-main-app-div")) for (var e = GetElementClassList(n[0]), t = 0; t < e.length; t++)if (e[t].indexOf(outsideAppModal) > 0) { var a = e[t].replace(outsideAppModal, ""); SetActiveApp($(".app-main-holder[data-appid='" + a + "']")); break } }, 25) } function SaveInnerModalContent(e) { try { var t = e.get_postBackElement(); null != t && ("hf_UpdateAll" != t.id && "MainContent_hf_UpdateAll" != t.id || 0 == innerModalContent.length && (innerModalContent = new Array, $(".Modal-element").each(function () { var e = $(this); if ("block" == e.css("display") && 0 == e.find("iframe").length) { var t = escape($.trim(e.find(".ModalScrollContent").html())); if ("" != t && "undefined" != t && null != t) { var a = new Array; if ("" != e.attr("id")) { a[0] = e.attr("id"), a[1] = t; var o = new Array; e.find(".ModalScrollContent").find("input").each(function () { "checkbox" == $(this).attr("type") ? o.push($(this).prop("checked")) : o.push($(this).val()) }), a[2] = o; var n = new Array; e.find(".ModalScrollContent").find("textarea").each(function () { n.push($(this).val()) }), a[3] = n, innerModalContent.push(a) } } } }))) } catch (e) { } if ("none" != $(".Modal-element").css("display")) { var a = $(".Modal-element").find(".ModalScrollContent"); a.length > 0 && (innerScrollPos = a.scrollTop()) } } function LoadSavedInnerModalContent() { if (innerModalContent.length > 0 && ($(".Modal-element").each(function () { var e = $(this); if ("block" == e.css("display") && 0 == e.find("iframe").length) for (var t = 0; t < innerModalContent.length; t++)if (innerModalContent[t][0] == e.attr("id")) { var a = unescape(innerModalContent[t][1]); e.find(".ModalScrollContent").html(a), e.find(".ModalScrollContent").find("input").each(function (e) { "checkbox" == $(this).attr("type") ? ($(this).prop("checked", !1), innerModalContent[t][2][e] && $(this).prop("checked", !0)) : innerModalContent[t][2][e] && $(this).val(innerModalContent[t][2][e]) }), e.find(".ModalScrollContent").find("textarea").each(function (e) { innerModalContent[t][3][e] && $(this).val(innerModalContent[t][3][e]) }); break } }), innerModalContent = new Array), "block" == $(".Modal-element").css("display")) { var e = $(".Modal-element").find(".ModalScrollContent"); e.length > 0 && (e.scrollTop(innerScrollPos), innerScrollPos = 0) } } function FinishModalLoad(e) { if (null != e) { $("body").addClass("modal-fixed-position-body"), $("#site_mainbody").length > 0 && "Boxed" === $("#site_mainbody").attr("data-layoutoption") && ($(".fixed-container-border-left").append("<div class='Modal-overlay' style='position: absolute!important;'></div>"), $(".fixed-container-border-right").append("<div class='Modal-overlay' style='position: absolute!important;'></div>"), $(".fixed-footer-container-left").append("<div class='Modal-overlay' style='position: absolute!important; top: -1px!important;'></div>"), $(".fixed-footer-container-right").append("<div class='Modal-overlay' style='position: absolute!important; top: -1px!important;'></div>")); var t = $(e); if (t.find(".Modal-element-align").css({ marginTop: -t.find(".Modal-element-modal").height() / 2, marginLeft: -t.find(".Modal-element-modal").width() / 2 }), t.find(".ModalButtonHolder").length > 0) { var a = t.find(".ModalButtonHolder"); a.find(".modal-button-holder-clear").length > 0 && a.find(".modal-button-holder-clear").remove(), a.append('<div class="clear modal-button-holder-clear"></div>') } t.find(".app-head-button-holder-admin").show(), "" === $.trim(t.find(".app-head-button-holder-admin").html()) && t.find(".app-head-button-holder-admin").hide(), t.css("visibility", "visible"), AdjustModalWindowView(), CloseTopDropDowns(), "Style_3" == openWSE_Config.appStyle && (t.find(".ModalHeader").show(), t.find(".ModalHeader-hoverclass").css("width", t.find(".ModalHeader").outerWidth()), t.find(".ModalHeader").hide()) } } function AdjustModalWindowView() { $(".Modal-element").each(function () { var e = $(this).find(".ModalScrollContent").scrollTop(); if ($(this).removeClass("modal-fixed-position"), $(this).find(".Modal-element-modal").css("height", ""), $(this).find(".ModalScrollContent").css("max-height", ""), "block" == $(this).css("display")) { var t = $(window).height(), a = $(window).width(), o = $(this).attr("data-containment"); o && (t = $(o).outerHeight(), a = $(o).outerWidth()), $(this).find(".ModalScrollContent").attr("data-tempmaxheight") && $(this).find(".ModalScrollContent").css("max-height", $(this).find(".ModalScrollContent").attr("data-tempmaxheight") + "px"); var n = $(this).find(".Modal-element-modal"); n.length > 0 && n.outerWidth() > a || n.outerHeight() > t ? ($(this).addClass("modal-fixed-position"), $(this).find(".ModalScrollContent").css("max-height", "")) : $(this).find(".ModalScrollContent").attr("data-tempmaxheight") && $(this).find(".ModalScrollContent").css("max-height", $(this).find(".ModalScrollContent").attr("data-tempmaxheight") + "px"), $(this).find(".ModalScrollContent").scrollTop(e) } }) } function getCurrentPostitionForModalWindow() { for (var e = 0; e < $(".Modal-element").length; e++) { var t = $(".Modal-element").eq(e); if ("block" == t.css("display")) { var a = t.find(".Modal-element-modal"); if (null != a.attr("data-setwidth") && "" != a.attr("data-setwidth")) { var o = Math.round(parseInt(a.attr("data-setwidth")) / 1.7); null != a.attr("data-setmaxheight") && "" != a.attr("data-setmaxheight") && (o = parseInt(a.attr("data-setmaxheight"))), a.find(".ModalScrollContent").css("max-height", o), a.find(".ModalScrollContent").attr("data-tempmaxheight", o), a.css({ width: parseInt(a.attr("data-setwidth")), minWidth: parseInt(a.attr("data-setwidth")) }) } if (t.find(".ModalButtonHolder").length > 0) { var n = t.find(".ModalButtonHolder"); n.find(".modal-button-holder-clear").length > 0 && n.find(".modal-button-holder-clear").remove(), n.append('<div class="clear modal-button-holder-clear"></div>') } } } } function CloseTopDropDowns() { $(".top-bar-menu-button, .top-bar-userinfo-button").removeClass("active"), $(".top-bar-menu-button li.b, .top-bar-userinfo-button li.b").hide(), -1 === window.location.href.toLowerCase().indexOf("appremote.aspx") && (CloseNoti(), $("#background-selector-holder").html(""), CloseGroupLoginModal()), (isMobileDevice() || -1 !== window.location.href.toLowerCase().indexOf("appremote.aspx")) && $(".sidebar-overlay").remove() } function ResizeTopDropDowns() { var e = null, t = null, a = $("#top_bar"); 0 == a.length && (a = $("#top_bar_toolview_holder")); for (var o = 0; o < a.find("li.b").length; o++) { var n = a.find("li.b").eq(o); if (n.is(":visible")) { e = n.parent().find(".a"), t = n, n.parent().parent().attr("id"); break } } if (null !== e && e.length > 0 && null !== t && t.length > 0) { t.css("right", ""), t.css("left", ""), t.find(".li-pnl-tab").css("max-width", $(window).outerWidth() - 20); var i = $("#main_container").outerWidth(); "true" === getParameterByName("mobileMode") && (i -= $(".iframe-title-logo").outerWidth()); try { if (e.offset().left > $(window).outerWidth() / 2) { var r = $(window).outerWidth() - e.offset().left - e.outerWidth(); t.css("right", r + 10), t.outerWidth() + r >= i && (t.css("right", $(".fixed-container-holder").offset().left + 10), $("#top-logo-holder").length > 0 && $("#top-logo-holder").width() !== $(window).width() && t.find(".li-pnl-tab").css("max-width", i - 2 - 30)) } else { var l = e.offset().left; t.css("left", l + 10), t.outerWidth() + (l - $("#main_container").offset().left) >= i ? $("#top-logo-holder").width() !== $(window).width() ? (t.css("left", $("#main_container").offset().left + 10), t.find(".li-pnl-tab").css("max-width", i - 2 - 20)) : t.css("left", $(".fixed-container-holder").offset().left + 10) : i - 2 - 20 > $(window).outerWidth() - 20 && t.find(".li-pnl-tab").css("max-width", i - 2 - 20) } } catch (e) { } setTimeout(function () { var e = $(window).height() - (t.offset().top + $("#footer_container").outerHeight() + t.find(".li-header").outerHeight() + t.find(".li-footer").outerHeight() + 1); isNaN(e) && (e = $(window).height() - (t.offset().top + $("#footer_container").outerHeight() + t.find(".li-header").outerHeight() + 1)), t.find(".li-pnl-tab").css("max-height", e - 20) }, 1) } } $(document.body).on("click", ".RadioButton-Toggle-Overlay", function () { var e = $(this).closest(".switch-slider"); if (triggerRadioButtonClick = !0, e.find(".cb-disable").hasClass("selected")) e.find(".cb-enable").hasClass("no-postback") && (e.find(".cb-enable").find("input").prop("checked", !0), e.find(".cb-disable").find("input").prop("checked", !1), e.find(".cb-enable").addClass("selected"), e.find(".cb-disable").removeClass("selected")), e.animate({ left: 0 }, openWSE_Config.animationSpeed, function () { e.find(".cb-enable").find("input").trigger("click") }); else { e.find(".cb-disable").hasClass("no-postback") && (e.find(".cb-enable").find("input").prop("checked", !1), e.find(".cb-disable").find("input").prop("checked", !0), e.find(".cb-enable").removeClass("selected"), e.find(".cb-disable").addClass("selected")); var t = e.parent().outerWidth() - e.find(".RadioButton-Toggle-Overlay").outerWidth() + 2; e.animate({ left: -t }, openWSE_Config.animationSpeed, function () { e.find(".cb-disable").find("input").trigger("click") }) } }), $(document.body).on("click", ".cb-enable, .cb-disable", function () { if (!triggerRadioButtonClick) return !1; $(this).hasClass("no-postback") || loadingPopup.Message("Updating..."), triggerRadioButtonClick = !1 }); var emailFocus = !1, focusPassword = !1, newUserHelp = !1, needEmailChange = !1, adminPasswordChange = !1, showIntroPage = !0, introPageNumber = 0; function HelpOverlay(e) { "none" == $("#help_main_holder").css("display") ? ($("#iframe-container-helper").length > 0 && CloseIFrameContent(), AddUrlHashQueryPath("help", (newUserHelp = e).toString())) : CloseHelpOverlay() } function HelpOverlayHistory() { !newUserHelp && CheckIfOnWorkspace() ? (HelpMenuPageLoadWorkspace(), $("#help_main_holder").fadeIn(openWSE_Config.animationSpeed)) : openWSE.AjaxCall(saveHandler + "/GetTotalHelpPages", '{ "currentPage": "' + document.location.href + '" }', null, function (e) { var t = parseInt(e.d); t > 0 ? (totalHelpPages = t, HelpMenuPageLoad(0, newUserHelp), $("#help_main_holder").fadeIn(openWSE_Config.animationSpeed)) : newUserHelp ? (NewUserPageLoad(), $("#help_main_holder").fadeIn(openWSE_Config.animationSpeed)) : (openWSE.AlertWindow("There are no help pages available for this webpage."), CloseHelpOverlay()) }, function (e) { newUserHelp ? (NewUserPageLoad(), $("#help_main_holder").fadeIn(openWSE_Config.animationSpeed)) : (openWSE.AlertWindow("There was an error retrieving the help pages. Please try again."), CloseHelpOverlay()) }) } function HelpMenuPageLoad(e, t) { var a = "<span class='pad-left'>Welecome to " + openWSE_Config.siteName + "</span>"; t || (a = "<span class='pad-left'>" + openWSE_Config.siteName + " Help Pages</span>"); var o = ""; t || (o += "<a onclick='openWSE.HelpOverlay(false, " + adminPasswordChange + ")' class='close-help float-right' title='Close'></a>"), e + 1 < totalHelpPages ? o += "<input type='button' class='input-buttons-create float-right margin-left' onclick='openWSE.HelpMenuPageLoad(" + (e + 1).toString() + "," + t + ")' value='Next' />" : e + 1 == totalHelpPages && t && (o += "<input type='button' class='input-buttons-create float-right margin-left' onclick='openWSE.NewUserPageLoad()' value='Next' />"), e > 0 && (o += "<input type='button' class='input-buttons-create float-right margin-left' onclick='openWSE.HelpMenuPageLoad(" + (e - 1).toString() + "," + t + ")' value='Back' />"), $("#helpmenu_title").html("<div class='help-Title-Top'>" + a + o + "</div>"), e += 1; var n = document.location.href; n = (n = n.substring(n.lastIndexOf("/") + 1)).replace(n.substring(n.indexOf(".")), ""), loadingPopup.Message("Loading..."), $("#helpdiv_pageholder").load(openWSE.siteRoot() + "HelpPages/" + n + "/HelpPage" + e + ".html", function () { loadingPopup.RemoveMessage(), $(".help-images-workspace-img").each(function () { if (!$(this).hasClass("ignoreSrc")) { var e = $(this).attr("src"); $(this).attr("src", openWSE.siteRoot() + "HelpPages/" + n + "/images/" + e) } }) }) } function HelpMenuPageLoadWorkspace() { var e = "<span class='pad-left'>" + openWSE_Config.siteName + " Help Pages</span>", t = "<a onclick='openWSE.HelpOverlay(false, " + adminPasswordChange + ")' class='close-help float-right' title='Close'></a>"; $("#helpmenu_title").html("<div class='help-Title-Top'>" + e + t + "</div>"), $("#helpdiv_pageholder").html(BuildHelpIntro()) } function NewUserPageLoad() { var e = "<span class='pad-left'>Welecome to " + openWSE_Config.siteName + "</span>", t = ""; t += "<input id='btnFinish' type='button' class='input-buttons-create float-right display-none' onclick='openWSE.NewUserfinsh()' value='Finish' />", totalHelpPages > 0 && (t += "<input type='button' class='input-buttons-create float-right margin-left' onclick='openWSE.HelpMenuPageLoad(" + (totalHelpPages - 1).toString() + ",true)' value='Back' />"), $("#helpmenu_title").html("<div class='help-Title-Top'>" + e + t + "</div>"), $("#helpdiv_pageholder").html("<div style='position: absolute; top: 50%; left: 50%; margin-left: -95px; margin-top: -45px; padding: 20px;'><div class='loading-icon-lrg margin-top-sml'></div><h3 style='color: #FFF; float: left; font-weight: bold;'>Loading Step....</h3></div>"), loadingPopup.Message("Loading..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/CheckForEmailAddress", "", null, function (e) { needEmailChange = openWSE.ConvertBitToBoolean(e.d[0]), adminPasswordChange = openWSE.ConvertBitToBoolean(e.d[1]); var t = ""; t = needEmailChange || adminPasswordChange ? NewUserEmailContainer() : UserSetupContainer(), $("#helpdiv_pageholder").html(t), setTimeout(function () { emailFocus ? $("#tb_emailaddress_update").focus() : focusPassword && $("#tb_newpassword_update").focus() }, 500), loadingPopup.RemoveMessage() }) } function UpdateEmail() { var e = $.trim($("#tb_emailaddress_update").val()); "" != e && (loadingPopup.Message("Updating..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/AddEmailAddress", '{"email": "' + escape(e) + '"}', null, function (e) { openWSE.ConvertBitToBoolean(e.d) && (needEmailChange = !1, $("#update-email-helpdiv").remove()), 0 == $("#update-password-helpdiv").length && NewUserPageLoad(), loadingPopup.RemoveMessage() })) } function UpdateAdminPassword() { var e = $.trim($("#tb_newpassword_update").val()), t = $.trim($("#tb_confirmnewpassword_update").val()); $("#span_passwordmismatch").html(""), "" == e ? $("#span_newpassword_update").show() : $("#span_newpassword_update").hide(), "" == t ? $("#span_confirmnewpassword_update").show() : $("#span_confirmnewpassword_update").hide(), e == t && "" != e && "" != t ? e.length < openWSE_Config.minPasswordLength ? $("#span_passwordmismatch").html("Password does not meet requirements.") : (loadingPopup.Message("Updating..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/UpdateAdminPassword", '{"password1": "' + escape(e) + '"}', null, function (e) { openWSE.ConvertBitToBoolean(e.d) && (adminPasswordChange = !1, $("#update-password-helpdiv").remove()), 0 == $("#update-email-helpdiv").length && NewUserPageLoad(), loadingPopup.RemoveMessage() })) : "" != e && "" != t && $("#span_passwordmismatch").html("Passwords do not match.") } function NewUserEmailContainer() { var e = ""; return needEmailChange ? (emailFocus = !0, focusPassword = !1, e += "<div id='update-email-helpdiv' class='pad-all' align='center'>", e += "<h3>Before you can continue, you must provide a valid email address.<br />This email address will be used for notifications and password recovery.<br />If you fail to provide a valid email address, you will not be able to use the password recovery feature on the login page.</h3>", e += "<div class='clear-space'></div>", e += "<div class='clear-space'></div>", e += "<h3>Please provide a valid email address</h3>", e += "<div class='clear-space'></div>", e += "<span class='pad-right font-bold'>Email Address</span><input type='text' id='tb_emailaddress_update' onkeypress='openWSE.OnEmailUpdate_KeyPress(event)' class='textEntry margin-right' style='width: 200px;' />", e += "<input type='button' class='input-buttons' onclick='openWSE.UpdateEmail()' value='Update' />", e += "<div class='clear-space'></div>", e += "<div class='clear-space'></div>", e += "<div class='clear-space'></div>", e += "</div>") : adminPasswordChange && (emailFocus = !1, focusPassword = !0, e += "<div id='update-password-helpdiv' class='pad-all' align='center'>", e += "<h3>You are currently signed in as Administrator. Create a new password for your Administrator account.</h3>", e += "<div class='clear-space-two'></div><small><b class='pad-right-sml'>Note:</b>Password must be at least " + openWSE_Config.minPasswordLength + " characters long.</small>", e += "<div class='clear-space'></div><table border='0' cellpadding='0' cellspacing='0'>", e += "<tr><td align='right'><span class='pad-right font-bold'>New Password:</span></td>", e += "<td align='left'><input type='password' id='tb_newpassword_update' onkeypress='openWSE.OnPasswordUpdate_KeyPress(event)' class='textEntry margin-right' style='width: 200px;' /><span id='span_newpassword_update' style='display: none; color: Red;'>*</span></td></tr>", e += "<tr><td></td><td><div class='clear-space'></div></td></tr>", e += "<tr><td align='right'><span class='pad-right font-bold'>Confirm New Password:</span></td>", e += "<td align='left'><input type='password' id='tb_confirmnewpassword_update' onkeypress='openWSE.OnPasswordUpdate_KeyPress(event)' class='textEntry margin-right' style='width: 200px;' /><span id='span_confirmnewpassword_update' style='display: none; color: Red;'>*</span></td></tr></table>", e += "<div class='clear-space'></div>", e += "<input type='button' class='input-buttons no-margin' onclick='openWSE.UpdateAdminPassword()' value='Change Password' />", e += "<div class='clear-space'></div>", e += "<span id='span_passwordmismatch' style='color: Red;'></div>", e += "</div>"), e } function OnEmailUpdate_KeyPress(e) { 13 != e.which && 13 != e.keyCode || (openWSE.UpdateEmail(), e.preventDefault()) } function OnPasswordUpdate_KeyPress(e) { 13 != e.which && 13 != e.keyCode || (openWSE.UpdateAdminPassword(), e.preventDefault()) } function UserSetupContainer() { var e = ""; return showIntroPage ? e = BuildHelpIntro() : (e = "<div class='pad-all' align='center'>", e += "<h3>You are now setup. Please click finish to load your workspace. You can change your email address within your 'Account Settings' page. If you need help in the future, click on the help icon at the bottom left hand corner of the workspace.</h3>", e += "<h3>By using this site you agree that OpenWSE can save cookies to your device. These cookies contain no information regarding your personal information.</h3>", e += "<div class='clear-space'></div>", e += "<a href='#' onclick='openWSE.HelpIntroRestart();return false;'>Go back to the Intro Pages</a>", e += "<div class='clear-space'></div>", e += "</div>", $("#btnFinish").removeClass("display-none")), e } function NewUserfinsh() { openWSE.AjaxCall("WebServices/AcctSettings.asmx/UpdateAcctNewMember", "", null, function (e) { var t = e.d; openWSE.ConvertBitToBoolean(t) && ("true" === getParameterByName("mobileMode") ? window.location = openWSE.siteRoot() + "AppRemote.aspx" : window.location = openWSE.siteRoot() + "Default.aspx") }) } function CloseHelpOverlay() { newUserHelp = !1, adminPasswordChange = !1, "block" == $("#help_main_holder").css("display") && $("#help_main_holder").fadeOut(openWSE_Config.animationSpeed, function () { $("#helpmenu_title, #helpdiv_1, #helpdiv_2").html("") }), RemoveUrlHashQueryPath("help"); try { var e = window.location.href; if (-1 != e.indexOf("?help")) { if ((a = e.split("?help")).length > 1) { var t = "?help" + a[1]; e = e.replace(t, ""), window.location = e } else e = e.replace("?help", ""); window.location = e } else if (-1 != e.indexOf("&help")) { var a; if ((a = e.split("&help")).length > 1) { t = "&help" + a[1]; e = e.replace(t, "") } else e = e.replace("&help", ""); window.location = e } } catch (e) { } } function BuildHelpIntro() { var e = ""; switch (newUserHelp ? (e += "<input type='button' class='input-buttons float-right' value='Next' onclick='openWSE.HelpIntroNext();' style='margin-top:-20px; margin-right: 7%;' />", e += introPageNumber > 0 ? "<input type='button' class='input-buttons float-left' value='Back' onclick='openWSE.HelpIntroBack();' style='margin-top:-20px; margin-left: 7%;' />" : "<input type='button' class='input-buttons float-left' value='Back' onclick='openWSE.HelpIntroBack();' style='margin-top:-20px; margin-left: 7%; visibility: hidden;' />") : (e += introPageNumber > 3 ? "<input type='button' class='input-buttons float-right' value='Next' onclick='openWSE.HelpIntroNext();' style='margin-top:-20px; margin-right: 7%; visibility: hidden;' />" : "<input type='button' class='input-buttons float-right' value='Next' onclick='openWSE.HelpIntroNext();' style='margin-top:-20px; margin-right: 7%;' />", e += introPageNumber > 0 ? "<input type='button' class='input-buttons float-left' value='Back' onclick='openWSE.HelpIntroBack();' style='margin-top:-20px; margin-left: 7%;' />" : "<input type='button' class='input-buttons float-left' value='Back' onclick='openWSE.HelpIntroBack();' style='margin-top:-20px; margin-left: 7%; visibility: hidden;' />"), introPageNumber) { case 0: e += "<span class='intro-title'>Workspace App List</span>", e += "<div class='clear-space'></div>", e += "<div class='workspace-intro'>", e += "<img alt='workspace' src='" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/workspace.jpg' />", e += "<div class='help-intro-overlay'>", e += "<div class='help-intro-circle' style='top: 7%; left: 0px; height: 22%; width: 10%; background-image: url(\"" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/app-selector.png\");'></div>", e += "<div class='help-intro-text' style='top: 10%; left: 15%;'><ul>", e += "<li>All your available apps will open in the workspace portion of the page (where your custom background appears).</li>", e += "<li>You can load as many apps as you want and move them anywhere you like. The site will record the position and save it to the database where it can retrieve it on page loads.</li>", e += "<li>If you are logged into a group, you only see the apps availble to that group. Once you log out of that group, all your apps will appear again.</li>", e += "<li>If you have more than 1 total workspaces, When hovering over an app, you will see a box to the right that you can select. This will bring up a dropdown that will allow you to pick which workspace to load that app on.</li>", e += "</ul></div>", e += "</div>", e += "</div>"; break; case 1: e += "<span class='intro-title'>Workspace Controls</span>", e += "<div class='clear-space'></div>", e += "<div class='workspace-intro'>", e += "<img alt='workspace' src='" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/workspace.jpg' />", e += "<div class='help-intro-overlay'>", e += "<div class='help-intro-circle' style='top: 0%; left: 24%; height: 51%; width: 37.5%; background-image: url(\"" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/top-right-btns.png\");'></div>", e += "<div class='help-intro-text' style='top: 5%; right: 0; width: 23%;'>You can select the workspace you want to work on. Apps can be placed in each workspace anyway you want.</div>", e += "<div class='help-intro-text' style='top: 5%; right: 30%; width: 15%;'>The top buttons to the left will show you different features such as:<br /><ul class='pad-left-big'><li>Group Login</li><li>Login/Logout</li><li>Overlay View</li><li>Notifications</li><li>Search</li></ul></div>", e += "</div>", e += "</div>"; break; case 2: e += "<span class='intro-title'>Workspace Opened App</span>", e += "<div class='clear-space'></div>", e += "<div class='workspace-intro'>", e += "<img alt='workspace' src='" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/workspace.jpg' />", e += "<div class='help-intro-overlay'>", e += "<div class='help-intro-circle' style='top: 7%; left: 0px; height: 22%; width: 10%; background-image: url(\"" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/app-selector-with-openapp.png\");'></div>", e += "<div class='help-intro-circle' style='top: 7%; left: 15%; height: 50%; width: 15.5%; background-image: url(\"" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/app.png\");'></div>", e += "<div class='help-intro-text' style='bottom: 5%; left: 15%;'><ul>", e += "<li>All apps are configurable to your liking. Each app will also come with option buttons, which can be found at the top right of the app header (If App Style is Style 2)</li>", e += "<li>Moving, resizing, minimizing, maximizing, and closing will be saved to your profile. This way each time you login, these settings will be applied to make it look and feel like you never left.</li>", e += "</ul></div>", e += "</div>", e += "</div>"; break; case 3: e += "<span class='intro-title'>App Options</span>", e += "<div class='clear-space'></div>", e += "<div class='workspace-intro'>", e += "<img alt='workspace' src='" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/workspace.jpg' />", e += "<div class='help-intro-overlay'>", e += "<div class='help-intro-no-circle' style='top: 7%; left: 0px; height: 22%; width: 10%; background-image: url(\"" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/app-selector-with-openapp.png\");'><div class='help-intro-overlay'></div></div>", e += "<div class='help-intro-no-circle' style='top: 7%; left: 15%; height: 50%; width: 15.5%; background-image: url(\"" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/app.png\");'><div class='help-intro-overlay'></div></div>", e += "<div class='help-intro-circle' style='top: 7%; left: 24%; height: 20%; width: 6%; background-image: url(\"" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/app-options.png\");'></div>", e += "<div class='help-intro-text' style='bottom: 5%; left: 15%;'><ul>", e += "<li>Each app will have the options menu at the top right of app header bar.</li>", e += "<li>You will have up to 4 options to choose from: Refresh, Pop app out, About, and Move to Workspace Number.</li>", e += "</ul></div>", e += "</div>", e += "</div>"; break; case 4: e += "<span class='intro-title'>Minimized App</span>", e += "<div class='clear-space'></div>", e += "<div class='workspace-intro'>", e += "<img alt='workspace' src='" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/workspace.jpg' />", e += "<div class='help-intro-overlay'>", e += "<div class='help-intro-no-circle' style='top: 7%; left: 0; height: 22%; width: 10%; background-image: url(\"" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/app-selector-with-openapp.png\");'><div class='help-intro-overlay'></div></div>", e += "<div class='help-intro-circle' style='top: 9%; left: 0; height: 4%; width: 2%; background-image: url(\"" + GetSiteRoot() + "Standard_Images/NewUserIntro/Workspace/app-minimized.png\");'></div>", e += "<div class='help-intro-text' style='top: 10%; left: 15%;'><ul>", e += "<li>When apps are minimized, they will be moved completely off the screen.</li>", e += "<li>If you hover over the minimized app, a preview will be shown with the exact place the app was before being minimized. (Only if option is on in settings)</li>", e += "<li>You can close out of the app by clicking on the 'x' to the right of the minimized button.</li>", e += "<li>To restore the app, simply click on the minimized button at the top. You can also click on the app icon under your Available Apps.</li>", e += "</ul></div>", e += "</div>", e += "</div>"; break; default: newUserHelp && (showIntroPage = !1, NewUserPageLoad()) }return e } function HelpIntroRestart() { introPageNumber = 0, showIntroPage = !0, NewUserPageLoad() } function HelpIntroNext() { introPageNumber++ , newUserHelp ? NewUserPageLoad() : $("#helpdiv_pageholder").html(BuildHelpIntro()) } function HelpIntroBack() { --introPageNumber < 0 && (introPageNumber = 0), newUserHelp ? NewUserPageLoad() : $("#helpdiv_pageholder").html(BuildHelpIntro()) } var showUpdatesModalTriggered = !1; function ShowUpdatesPopup(e) { setTimeout(function () { if (!showUpdatesModalTriggered) { var t = "<div id='OpenWSEUpdates-element' class='Modal-element' style='display: none;'>"; t += "<div class='Modal-overlay'>", t += "<div class='Modal-element-align'>", t += "<div class='Modal-element-modal' data-setwidth='550'>", t += "<div class='ModalHeader'><div><span class='Modal-title'></span></div></div>", t += "<div class='ModalScrollContent'><div class='ModalPadContent'>" + unescape(e) + "</div></div>", t += "</div></div></div></div></div>", $("body").append(t), openWSE.LoadModalWindow(!0, "OpenWSEUpdates-element", "Site Updates"), showUpdatesModalTriggered = !0 } }, 100) } var showActivationModalTriggered = !1; function ShowActivationPopup(e) { setTimeout(function () { if (!showActivationModalTriggered) { var t = unescape(e), a = "<div id='Activation-element' class='Modal-element' style='display: none;'>"; a += "<div class='Modal-overlay'>", a += "<div class='Modal-element-align'>", a += "<div class='Modal-element-modal' data-setwidth='500'>", a += "<div class='ModalHeader'><div><span class='Modal-title'></span></div></div>"; var o = "<img alt='' class='float-left pad-right' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/App/approve.png' style='height: 17px;' />"; a += "<div class='ModalScrollContent'><div class='ModalPadContent'>" + t + "<div class='clear-space'></div><div align='center'>" + ("<a href='" + openWSE.siteRoot() + "Default.aspx' class='input-buttons no-margin' style='text-decoration: none!important;'>" + o + " <span style='font-size: 15px'>Got it</span></a>") + "</div>", a += "</div></div></div></div></div></div></div>", $("body").append(a), openWSE.LoadModalWindow(!0, "Activation-element", "Activation"), showActivationModalTriggered = !0 } }, 100) } function CloseUpdatesPopup() { LoadModalWindow(!1, "OpenWSEUpdates-element", ""), $("#OpenWSEUpdates-element").remove() } function OverlayDisable(e) { loadingPopup.Message("Closing Overlay..."); var t = $(e).closest(".workspace-overlay-selector"); 0 == t.length && (t = $("." + e)), t.remove(), openWSE.AjaxCall(saveHandler + "/Overlay_Disable", '{ "classes": "' + t.attr("class") + '" }', null, function (e) { TryRemoveLoadOverlay(e.d), loadingPopup.RemoveMessage() }), CheckIfOverlaysExistsOnNonComplex() } function TryAddLoadOverlay(e) { for (var t = e.split(","), a = "#" + openWSE_Config.overlayPanelId, o = 0; o < t.length; o++)"" != t[o] && ($(a).find("." + t[o]).length > 0 && $(a).find("." + t[o]).remove(), $(a).hide().prepend($(".move-holder").find("." + t[o])).show()); "" != e && UpdateOverlayTable() } function TryRemoveLoadOverlay(e) { var t = $("." + e); t.length > 0 && t.remove(), RemoveCSSFilesOnAppClose(e), UpdateOverlayTable(), CheckIfOverlaysExistsOnNonComplex() } function CallOverlayList() { loadingPopup.Message("Loading..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/GetUserOverlays", "{ }", null, function (e) { var t = ""; if (null != e.d) { t += "<div class='add-item-list-header'>Available Overlays</div>"; for (var a = 0; a < e.d.length; a++) { var o = "Add Overlay", n = ""; openWSE.ConvertBitToBoolean(e.d[a][3]) && (o = "Remove Overlay", n = "add-item-list-item-hasitem"); var i = "<table width='100%'><tr><td style='width: 170px;'><div class='pad-right-big'>" + e.d[a][0] + "</div></td><td align='left'>" + e.d[a][2] + "</td></tr></table>"; t += "<div class='add-item-list-item " + n + "' title='" + o + "' onclick=\"openWSE.AddRemoveOverlayClick('" + e.d[a][1] + "', this);\">" + i + "</div>" } 0 == e.d.length && (t += "<div class='emptyGridView'>No overlays available</div>") } 0 === $("body").find("#overlayEdit-element").length && $("body").append($("#overlayEdit-element")), $("#overlayEdit-element").find("#overlay-edit-list").html(t), loadingPopup.RemoveMessage(), LoadModalWindow(!0, "overlayEdit-element", "Add/Remove Overlay") }, function (e) { loadingPopup.RemoveMessage(), openWSE.AlertWindow("There was an error retrieving your overlays. Please try again.") }) } function AddRemoveOverlayClick(e, t) { $(t).hasClass("add-item-list-item-hasitem") ? (OverlayDisable(e), $(t).removeClass("add-item-list-item-hasitem")) : (loadingPopup.Message("Adding Overlay..."), $(t).addClass("add-item-list-item-hasitem"), $("#hf_loadOverlay1").val(e), openWSE.CallDoPostBack("hf_loadOverlay1", "")) } function UpdateOverlayTable() { if ($("#" + openWSE_Config.overlayPanelId).length > 0) { $(".workspace-overlay-selector").each(function (e) { LoadCSSFilesInApp($(this).attr("data-overlayid")) }) } } function GetUserNotifications() { if (!openWSE_Config.demoMode && ($("#notification-tab-b").is(":visible") || $("#Notifications_tab").hasClass("active-tab")) && !runningNoti) { runningNoti = !0; var e = new Array; $("#table_NotiMessages tr").each(function (t) { e[t] = $(this).attr("id") }); openWSE.siteRoot(); openWSE.AjaxCall("WebServices/NotificationRetrieve.asmx/LoadUserNotifications", '{ "_currIds": "' + e + '" }', null, function (e) { null != e.d && "" != e.d ? ($("#NotificationHolder").html($.trim(e.d)), $("#no-notifications-id").length > 0 ? $("#lb_clearNoti").hide() : $("#lb_clearNoti").show()) : $("#lb_clearNoti").hide(), runningNoti = !1, CheckIfCanAddMore(), SetNotificationScroll() }, function (e) { SetNotificationScroll(), $("#NotificationHolder").html("<div class='pad-top-big pad-bottom' style='color: Red; text-align: center;'>Error retrieving notifications!</div>"), $("#lb_clearNoti").hide(), runningNoti = !1 }) } } function CheckIfCanAddMore() { var e = $("#notification-tab-b").find(".li-pnl-tab")[0]; if (null != e) { var t = $("#notification-tab-b").find(".li-pnl-tab").innerHeight(), a = parseInt($("#notification-tab-b").find(".li-pnl-tab").css("max-height")); if (t >= e.scrollHeight || e.scrollHeight < a) { var o = parseInt($("#lbl_notifications").find("span").html()); parseInt($("#table_NotiMessages tr").length) < o && GetMoreUserNotifications() } } } function GetMoreUserNotifications() { if (!openWSE_Config.demoMode && ($("#notification-tab-b").is(":visible") || $("#Notifications_tab").hasClass("active-tab")) && !runningMoreNoti && !runningNoti) { runningMoreNoti = !0; var e = new Array; $("#table_NotiMessages tr").each(function (t) { e[t] = $(this).attr("id") }), openWSE.AjaxCall("WebServices/NotificationRetrieve.asmx/LoadMoreUserNotifications", '{ "_currIds": "' + e + '","_currCount": "' + parseInt($("#table_NotiMessages tr").length) + '" }', null, function (e) { null != e.d && "" != e.d && $("#table_NotiMessages").append($.trim(e.d)), SetNotificationScroll(), runningMoreNoti = !1, CheckIfCanAddMore() }, function (e) { SetNotificationScroll(), $("#NotificationHolder").append("<div class='pad-top-big pad-bottom' style='color: Red; text-align: center;'>Error retrieving notifications!</div>"), runningMoreNoti = !1 }) } } function RefreshNotifications() { if (!openWSE_Config.demoMode && ($("#notification-tab-b").is(":visible") || $("#Notifications_tab").hasClass("active-tab")) && !runningMoreNoti) { runningMoreNoti = !0; var e = new Array; $("#table_NotiMessages tr").each(function (t) { e[t] = $(this).attr("id") }), openWSE.AjaxCall("WebServices/NotificationRetrieve.asmx/RefreshUserNotifications", '{ "_currIds": "' + e + '" }', null, function (e) { if (null != e.d[0] && "" != e.d[0]) if ($("#table_NotiMessages").length > 0) $("#table_NotiMessages").prepend($.trim(e.d[0])); else { var t = "<table ID='table_NotiMessages' class='table-notiMessages' cellpadding='5' cellspacing='5'>"; t += $.trim(e.d[0]) + "</table>", $("#NotificationHolder").html(t) } if (null != e.d[1]) for (var a = 0; a < e.d[1].length; a++) { var o = e.d[1][a]; $("#" + o).fadeOut(openWSE_Config.animationSpeed, function () { $("#" + o).remove() }) } "0" == $("#lbl_notifications").find("span").html() ? ($("#NotificationHolder").html("<div id='no-notifications-id'>No notifications found</div>"), $("#lb_clearNoti").hide()) : $("#lb_clearNoti").show(), SetNotificationScroll(), runningMoreNoti = !1 }, function (e) { SetNotificationScroll(), $("#NotificationHolder").html("<div class='pad-top-big pad-bottom' style='color: Red; text-align: center;'>Error retrieving notifications!</div>"), runningMoreNoti = !1 }) } } function CloseNoti() { $("#NotificationHolder").html("<div class='pad-all'>Loading notifications...</div>"), $("#lb_clearNoti").hide(), runningNoti = !1 } function ResetNoti() { $("#lbl_notifications").removeClass("notifications-new"), $("#lbl_notifications").addClass("notifications-none"), $("#lbl_notifications").html("<span>0</span>"), $("#NotificationHolder").html("<div id='no-notifications-id'>No notifications found</div>"), $("#lb_clearNoti").hide() } function NotiActionsClearAll() { openWSE_Config.demoMode || openWSE.ConfirmWindow("Are you sure you want to dismiss all notifications?", function () { loadingPopup.Message("Clearing Notifications..."), openWSE.AjaxCall("WebServices/NotificationRetrieve.asmx/DeleteNotifications", '{ "id": "ClearAll" }', null, function (e) { openWSE.ConvertBitToBoolean(e.d) && (loadingPopup.RemoveMessage(), ResetNoti(), CloseTopDropDowns()) }) }, null) } function NotiActionsHideInd(e) { if (!openWSE_Config.demoMode) { loadingPopup.Message("Deleting. Please Wait..."); var t = $(e).closest("tr"), a = t.attr("id"); openWSE.AjaxCall("WebServices/NotificationRetrieve.asmx/DeleteNotifications", '{ "id": "' + a + '" }', null, function (e) { openWSE.ConvertBitToBoolean(e.d) && t.fadeOut(openWSE_Config.animationSpeed, function () { if (loadingPopup.RemoveMessage(), t.remove(), "1" == $("#lbl_notifications").find("span").html()) ResetNoti(); else { var e = parseInt($("#lbl_notifications").find("span").html()); (e -= 1) < 0 && (e = 0), $("#lbl_notifications").html("<span>" + e + "</span>") } CheckIfCanAddMore() }) }) } } function SetNotificationScroll() { var e = $("#notification-tab-b").find(".li-pnl-tab"); -1 !== window.location.href.toLowerCase().indexOf("appremote.aspx") & $("#Notifications_tab").length > 0 && $("#Notifications_tab").hasClass("active-tab") && (e = $("#main_container")), e.scroll(function () { if (null != this) { var e = $(this), t = e.scrollTop(), a = e.innerHeight(); if (t > 0 && t + a >= this.scrollHeight) { var o = parseInt($("#lbl_notifications").find("span").html()); parseInt($("#table_NotiMessages tr").length) < o && GetMoreUserNotifications() } } }), openWSE.ResizeTopDropDowns() } function ShowNewNotificationPopup() { if (0 === $("#pnl_myNotificationList").length && $("#lbl_notifications").length > 0) try { var e = document.getElementById("hf_noti_update_hiddenField").value; if ("" == e && (e = "0"), openWSE.ConvertBitToBoolean(e)) { var t = $.trim($("#lbl_noti_update_message").html()), a = $.trim($("#lbl_noti_update_popup_Description").html()); t && ($("#noti-update-element").find(".noti-update-element-align").css("top", ""), $("#top_bar_toolview_holder").length > 0 && $("#top_bar_toolview_holder").is(":visible") && $("#noti-update-element").find(".noti-update-element-align").css("top", $("#top_bar_toolview_holder").outerHeight() + 10 + "px"), $("#noti-update-element").show(), a && notifyMeFromBrowser(t, $("#noti-update-element").find("#img_noti_update_image").attr("src"), a), setTimeout(function () { $("#noti-update-element").hide(), $("#hf_noti_update_hiddenField").val("false") }, 2500)) } } catch (e) { } } function UpdateNotificationCount(e) { (e = parseInt(e)) > 0 ? ($("#lbl_notifications").html("<span>" + e + "</span>"), $("#lbl_notifications").removeClass("notifications-none").addClass("notifications-new")) : ($("#lbl_notifications").html("<span>0</span>"), $("#lbl_notifications").removeClass("notifications-new").addClass("notifications-none")) } function notifyMeFromBrowser(e, t, a) { try { if ("Notification" in window) { var o, n = { body: a, icon: t }; "granted" === Notification.permission ? o = new Notification(e, n) : "denied" !== Notification.permission && Notification.requestPermission(function (t) { "granted" === t && (o = new Notification(e, n)) }), null != o && (o.onclick = function (e) { e.preventDefault(), window.open(GetSiteRoot() + "SiteTools/UserTools/MyNotifications.aspx", "_blank"); try { e.target && e.target.close() } catch (e) { } }) } } catch (e) { } } function LoadCreateAccountHolder() { if ("none" != $("#Login-holder").css("display")) { $("#Login-holder").hide(); var e = GetSiteRoot() + "SiteTools/iframes/CreateAccount.aspx"; "/Scripts/SiteCalls/Full/" != GetSiteRoot() && "/Scripts/SiteCalls/Min/" != GetSiteRoot() || (e = "/SiteTools/iframes/CreateAccount.aspx"), $("#iframe-createaccount-holder").html("<iframe id='iframe-demo' src='" + e + "' frameborder='0' width='595px' style='visibility: hidden;'></iframe>"), $("#iframe-createaccount-holder").append("<div style='text-align: center;'><h3 id='loadingControls'>Loading Controls. Please Wait...</h3></div>"), $("#CreateAccount-holder").fadeIn(openWSE_Config.animationSpeed), document.getElementById("iframe-demo").onload = function () { $("#loadingControls").remove(), $("#register_password_cancel").show(), $("#iframe-demo").css({ height: "290px", visibility: "visible" }), AdjustLoginModalPopup() } } else $("#CreateAccount-holder, #ForgotPassword-holder, #register_password_cancel").hide(), $("#iframe-createaccount-holder").html(""), $("#Login-holder").fadeIn(openWSE_Config.animationSpeed); AdjustLoginModalPopup() } function LoadRecoveryPassword() { $("#tb_username_recovery").val(""), $("#lbl_passwordResetMessage").html(""), $("#UserNameRequired_recovery").css("visibility", "hidden"), $("#Login-holder").hide(), $("#register_password_cancel").show(), $("#ForgotPassword-holder").fadeIn(openWSE_Config.animationSpeed), AdjustLoginModalPopup() } function AdjustLoginModalPopup() { $("#LoginModalPopup-element").length > 0 && "block" == $("#LoginModalPopup-element").css("display") && ("auto" == $("#LoginModalPopup-element").find(".Modal-element-modal").css("top") && $("#LoginModalPopup-element").find(".Modal-element-align").css({ marginTop: -$("#LoginModalPopup-element").find(".Modal-element-modal").height() / 2, marginLeft: -$("#LoginModalPopup-element").find(".Modal-element-modal").width() / 2 })) } function LoadIFrameContent(e) { AddUrlHashQueryPath("iframecontent", e) } function LoadIFrameContentHistory(e) { $("#iframe-container-helper").remove(), $(".remove-on-iframe-close").remove(), e = unescape(e); var t = $(window).height() - 40; isExternal(e) || (e = openWSE.siteRoot() + e); var a = e; if (a.indexOf(".") > 0 && (iframeTitle_split = e.split("."), (a = iframeTitle_split[iframeTitle_split.length - 2]).indexOf("/") >= 0)) { iframeTitle_split = a.split("/"); var o = (a = iframeTitle_split[iframeTitle_split.length - 1]).replace(/([A-Z]+)/g, ",$1").replace(/^,/, ""); if (iframeTitle_split = o.split(","), iframeTitle_split.length > 0) { a = ""; for (var n = 0; n < iframeTitle_split.length; n++)a += iframeTitle_split[n] + " "; a = $.trim(a) } } window.location.href.toLowerCase().indexOf("grouporg.aspx") > 0 && "acct settings" === a.toLowerCase() ? a = "Group Defaults" : window.location.href.toLowerCase().indexOf("useraccounts.aspx") > 0 && window.location.href.toLowerCase().indexOf("demouser") > 0 && "acct settings" === a.toLowerCase() ? a = "Demo User Defaults" : window.location.href.toLowerCase().indexOf("useraccounts.aspx") > 0 && window.location.href.toLowerCase().indexOf("newuserdefaults") > 0 && "acct settings" === a.toLowerCase() ? a = "New User Defaults" : window.location.href.toLowerCase().indexOf("useraccounts.aspx") > 0 && window.location.href.toLowerCase().indexOf("acctsettings.aspx") > 0 && (a = "Account Settings"); var i = openWSE_Config.siteName; if ("" !== openWSE_Config.groupLoginName && $("#lnk_BackToWorkspace").find(".title-text").length > 0) { var r = $.trim($("#lnk_BackToWorkspace").find(".title-text").html()); r && (i = r) } CloseTopDropDowns(); var l = $("#lnk_BackToWorkspace").find(".title-logo").css("background-image"); l || (l = openWSE.siteRoot() + "Standard_Images/logo.png"), 0 !== l.indexOf("url(") && (l = "url(" + l + ")"); var s = ""; ($("#lnk_BackToWorkspace").find(".title-logo").hasClass("large-img") || $("#top_bar_toolview_holder").find(".title-logo").hasClass("large-img")) && (s = " large-img"); var d = "<div class='iframe-top-bar remove-on-iframe-close'><div class='iframe-title-logo" + s + "'><span class='title-logo' style='background-image: " + l + ";'></span><span class='title-text'>" + i + "</span><div class='clear'></div></div><span class='iframe-title-top-bar'>" + a + "</span><a onclick='openWSE.CloseIFrameContent();return false;' class='close-iframe' title='Close'></a><div class='clear'></div></div>" + "<div id='iframe-container-helper' style='top: 41px; bottom: 0;'>" + ("<iframe id='iframe-content-src' src='" + e + "' width='100%' frameborder='0' style='height: " + t + "px;'></iframe>") + "<div class='loading-background-holder' data-usespinner='true'><div></div></div></div>"; $("body").append(d), $("form").hide(), $("#iframe-container-helper").fadeIn(openWSE_Config.animationSpeed), document.getElementById("iframe-content-src").onload = function () { $(document).ready(function () { setTimeout(function () { $("#iframe-container-helper").find(".loading-background-holder").remove() }, 150) }) }, $(".ui-helper-hidden-accessible").find("div").hide(), SetContainerTopPos(!0) } function CloseIFrameContent() { $("form").show(), $("#iframe-container-helper").remove(), $(".remove-on-iframe-close").remove(), SetContainerTopPos(!0), RemoveUrlHashQueryPath("iframecontent"), openWSE.SetLeftSidebarScrollTop(), $(window).resize() } function isExternal(e) { var t = e.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/); return "string" == typeof t[1] && t[1].length > 0 && t[1].toLowerCase() !== location.protocol || "string" == typeof t[2] && t[2].length > 0 && t[2].replace(new RegExp(":(" + { "http:": 80, "https:": 443 }[location.protocol] + ")?$"), "") !== location.host } $(document).keydown(function (e) { if (e = e || window.event, $("#workspace_holder").length > 0 && (e.altKey && 38 == e.which || e.altKey && 40 == e.which)) { var t = parseInt(Getworkspace().replace("workspace_", "")), a = $(".dropdown-db-selector").find("ul").find("li").length, o = null; if (null != (o = 40 == e.which ? t + 1 <= a ? $(".workspace-selection-item").eq(t) : $(".workspace-selection-item").eq(0) : t - 1 >= 1 ? $(".workspace-selection-item").eq(t - 2) : $(".workspace-selection-item").eq(a - 1))) { o.trigger("click"); var n = "#MainContent_" + openWSE.Getworkspace(), i = "#MainContent_workspace_" + o.attr("data-number"); openWSE.HoverWorkspacePreview(n, i) } } }); var selectedImgFolder = "user", imgFolderChange = !1; function BackgroundSelector(e) { try { $("#background_selector_overlay").length > 0 && $("#background_selector_overlay").remove(), e ? $("#background-selector-holder").html("<div class='pad-all-sml'>Loading background settings...</div>") : loadingPopup.Message("Loading..."); var t = Getworkspace().replace("workspace_", ""); openWSE_Config.multipleBackgrounds || (t = "1"), openWSE.AjaxCall("WebServices/AcctSettings.asmx/GetServerImageList", '{ "_workspace": "' + t + '", "folder": "' + selectedImgFolder + '" }', null, function (e) { if (9 == e.d.length) { if ($("#background-selector-holder").html(""), $(".background-more-settings-holder").html(""), "" != e.d[0]) { var t = ""; $("#hyp_AccountCustomizations").attr("target") && (t = " target='" + $("#hyp_AccountCustomizations").attr("target") + "'"), $(".background-more-settings-holder").html("<a href='" + GetSiteRoot() + "SiteTools/UserTools/AcctSettings.aspx#?tab=pnl_WorkspaceContainer'" + t + " onclick='openWSE.CloseTopDropDowns();'>More Settings</a>") } var a = "<div id='background-settings-div'>"; a += "<div class='clear-space'></div>", a += "<h3>Background</h3>", a += "<div class='clear-space-two'></div>", a += "<div class='pad-top pad-bottom'>", openWSE_Config.demoMode ? a += "<div class='current-background-list-holder'><small><i>Current background list cannot be viewed in demo mode</i></small><div class='clear-space'></div></div>" : a += "<div class='current-background-list-holder'>" + e.d[8] + "</div>", a += "<div class='clear'></div>", a += "<div class='input-settings-holder float-left' style='clear: none!important; margin-right: 30px;'><span class='font-bold'>Solid Color</span><div class='clear-space-two'></div>", a += "<input id='tb_solidColorBg' type='color' class='textEntry float-left margin-right' style='width: 75px;' value='#FFFFFF' />", a += "<input id='btn_urlbgcolor' type='button' value='Set Color' class='input-buttons float-left' onclick='openWSE.updateBackgroundColor()' />", a += "<div class='clear'></div></div>", a += "<div class='input-settings-holder float-left' style='clear: none!important;'><span class='font-bold'>Url Image</span><div class='clear-space-two'></div>", a += "<input id='tb_imageurl' type='text' class='textEntry'>", a += "<input id='btn_urlupdate' type='button' value='Set Url Image' class='input-buttons margin-left' onclick='openWSE.updateBackgroundURL()' />", a += "<div class='clear-space-two'></div>", a += "<small>Copy and paste any link that contains an image</small>", a += "</div>", "" != e.d[0] ? (a += "<div class='clear'></div><div class='input-settings-holder'><span class='font-bold'>Upload Image</span><div class='clear'></div>", a += "<iframe src='" + e.d[0] + "' frameborder='0' style='width: 100%; height: 50px; overflow: hidden;'></iframe>", a += "</div>", a += "<div class='clear-space'></div>", a += "<div class='float-left'><span class='font-bold pad-right'>Folder</span><select id='dd_userimagefolder' onchange='openWSE.ChangeImageFolder();'><option value='public'>Public</option><option value='user'>User Uploads</options></select></div>", a += "<div class='clear-space'></div>") : selectedImgFolder = "user", a += "<div class='img-list-selector' style='width: 630px; overflow: auto; margin-right: 10px; clear: both; white-space: nowrap;'>" + e.d[1] + "</div>", a += "<div class='clear-space'></div>", a += "<a onclick='openWSE.ClearBackground();return false;'>Clear Backgrounds</a>", a += "<div class='clear'></div>", a += "</div>", a += "<div class='clear-space'></div>", a += "<div class='border-top'></div>", a += "<div class='clear-space'></div>"; a += "<div class='float-left margin-bottom-big' style='padding-right: 50px;'><h3>Background Position</h3>", a += "<div class='clear-space-two'></div>", a += "<div class='pad-top pad-bottom'>", a += "<select class='background-setting-select' onchange=\"openWSE.UpdateBackgroundSetting(this);\" data-name='backgroundposition'>", a += "<option value='left top'>Left Top</option>", a += "<option value='left center'>Left Center</option>", a += "<option value='left bottom'>Left Bottom</option>", a += "<option value='right top'>Right Top</option>", a += "<option value='right center'>Right Center</option>", a += "<option value='right bottom'>Right Bottom</option>", a += "<option value='center top'>Center Top</option>", a += "<option value='center center'>Center Center</option>", a += "<option value='center bottom'>Center Bottom</option>", a += "</select>", a += "</div></div>", a += "<div class='float-left margin-bottom-big' style='padding-right: 50px;'><h3>Background Size</h3>", a += "<div class='clear-space-two'></div>", a += "<div class='pad-top pad-bottom'>", a += "<select class='background-setting-select' onchange=\"openWSE.UpdateBackgroundSetting(this);\" data-name='backgroundsize'>", a += "<option value='auto'>Normal</option>", a += "<option value='100% 100%'>Stretch</option>", a += "<option value='cover'>Cover</option>", a += "<option value='contain'>Contain</option>", a += "</select>", a += "</div></div>", a += "<div id='background-repeat-holder'>", a += "<div class='float-left margin-bottom-big' style='padding-right: 50px;'><h3>Repeat Background</h3>", a += "<div class='clear-space-two'></div>", a += "<div class='pad-top pad-bottom'>", a += "<div class='field switch inline-block'>", a += "<span class='background-setting-select cb-enable selected'><input id='rb_backgroundrepeat_on' type='radio' onchange=\"openWSE.UpdateBackgroundSetting(this);\" data-name='backgroundrepeat' checked='checked'><label for='rb_backgroundrepeat_on'>Yes</label></span>", a += "<span class='background-setting-select cb-disable'><input id='rb_backgroundrepeat_off' type='radio' onchange=\"openWSE.UpdateBackgroundSetting(this);\" data-name='backgroundrepeat'><label for='rb_backgroundrepeat_off'>No</label></span>", a += "</div>", a += "</div></div>", a += "</div>", a += "<div class='float-left margin-bottom-big' style='padding-right: 50px;'><h3>Default Background</h3>", a += "<div class='clear-space-two'></div>", a += "<div class='pad-top pad-bottom'>", a += "<div class='float-left'><input id='tb_defaultbackgroundcolor' type='color' class='textEntry float-left margin-right' style='width: 75px;' /></div>", a += "<input id='btn_defaultbackgroundcolor' type='button' value='Update' class='input-buttons float-left background-setting-color' onclick='openWSE.UpdateBackgroundSetting(this)' data-name='backgroundcolor' />", a += "<div class='clear-space'></div>", a += "</div></div>", a += "<div id='background-timer-holder'>", a += "<div class='float-left margin-bottom-big' style='padding-right: 50px;'><h3>Background Timer</h3>", a += "<div class='clear-space-two'></div>", a += "<div class='pad-top pad-bottom'>", a += "<div class='float-left'><input id='tb_defaultbackgroundtimer' type='number' class='textEntry float-left margin-right' min='1' max='999' style='width: 55px;' /></div>", a += "<input id='btn_defaultbackgroundtimer' type='button' value='Update' class='input-buttons float-left background-setting-timer' onclick='openWSE.UpdateBackgroundSetting(this)' data-name='backgroundlooptimer' />", a += "<div class='clear-space'></div>", a += "</div></div>", a += "</div>", a += "<div id='background-individual-workspace-holder'>", a += "<div class='float-left margin-bottom-big' style='padding-right: 50px;'><h3>Individual Workspace Backgrounds</h3>", a += "<div class='clear-space-two'></div>", a += "<div class='pad-top pad-bottom'>", a += "<div class='field switch inline-block'>", a += "<span class='background-setting-select cb-enable selected'><input id='rb_backgroundindividual_on' type='radio' onchange=\"openWSE.UpdateBackgroundSetting(this);\" data-name='backgroundindividual' checked='checked'><label for='rb_backgroundindividual_on'>Yes</label></span>", a += "<span class='background-setting-select cb-disable'><input id='rb_backgroundindividual_off' type='radio' onchange=\"openWSE.UpdateBackgroundSetting(this);\" data-name='backgroundindividual'><label for='rb_backgroundindividual_off'>No</label></span>", a += "</div>", a += "</div></div>", a += "</div>", a += "<div class='clear'></div>", a += "</div>", $("#background-selector-holder").html(a), "" != e.d[0] && $("#background-selector-holder").find("#dd_userimagefolder").val(selectedImgFolder), "" != e.d[2] && $(".background-setting-select[data-name='backgroundposition']").val(e.d[2]), "" != e.d[3] && ($(".background-setting-select[data-name='backgroundsize']").val(e.d[3]), "100% 100%" != e.d[3] && "cover" != e.d[3] || $("#background-repeat-holder").hide()), "" != e.d[4] && ("true" == e.d[4] || "1" == e.d[4] ? ($("#rb_backgroundrepeat_on").attr("checked", "checked"), $("#rb_backgroundrepeat_off").removeAttr("checked"), $("#rb_backgroundrepeat_on").parent().addClass("selected"), $("#rb_backgroundrepeat_off").parent().removeClass("selected")) : ($("#rb_backgroundrepeat_on").removeAttr("checked"), $("#rb_backgroundrepeat_off").attr("checked", "checked"), $("#rb_backgroundrepeat_on").parent().removeClass("selected"), $("#rb_backgroundrepeat_off").parent().addClass("selected"))), "" != e.d[5] && $("#tb_defaultbackgroundcolor").val(e.d[5]), "" != e.d[6] && $("#tb_defaultbackgroundtimer").val(e.d[6]), "" != e.d[7] && ("true" == e.d[7] || "1" == e.d[7] ? ($("#rb_backgroundindividual_on").attr("checked", "checked"), $("#rb_backgroundindividual_off").removeAttr("checked"), $("#rb_backgroundindividual_on").parent().addClass("selected"), $("#rb_backgroundindividual_off").parent().removeClass("selected")) : ($("#rb_backgroundindividual_on").removeAttr("checked"), $("#rb_backgroundindividual_off").attr("checked", "checked"), $("#rb_backgroundindividual_on").parent().removeClass("selected"), $("#rb_backgroundindividual_off").parent().addClass("selected"))), $("#workspace-selector").is(":visible") ? $("#background-individual-workspace-holder").show() : $("#background-individual-workspace-holder").hide(), RadioButtonStyle(), $("#background-timer-holder").hide(), GetBackgroundArray().length > 1 && $("#background-timer-holder").show(), $("#background-selector-holder").find(".img-list-selector").find(".image-selector").length > 0 && $("#background-selector-holder").find(".img-list-selector").find(".no-images-found").length > 0 && $("#background-selector-holder").find(".img-list-selector").find(".no-images-found").remove(), loadingPopup.RemoveMessage(), openWSE.ResizeTopDropDowns(), $("#background-selector-holder").find(".img-list-selector .image-selector").each(function () { $(this).attr("onclick", "openWSE.BackgroundImageSelect_Clicked(this, event);") }), $("#background-selector-holder").find(".img-list-selector .delete-uploadedimg").each(function () { $(this).attr("onclick", "openWSE.BackgroundImageDelete_Clicked(this);") }), $("#background-selector-holder").find(".current-background-list-holder .remove-selectedimg").each(function () { $(this).attr("onclick", "openWSE.BackgroundImageAddRemove_Clicked(this);") }) } else AlertWindow("There was an error pulling the backgrounds down from the server. Please try again.", window.location.href) }) } catch (e) { $("#background-selector-holder").html("<div class='pad-all-sml'>No settings found</div>") } openWSE.ResizeTopDropDowns() } function ClearBackground() { loadingPopup.Message("Updating..."); var e = Getworkspace(); openWSE_Config.multipleBackgrounds || (e = "workspace_1"), $("#MainContent_" + e).attr("data-backgroundimg", ""), SetNewBackground(), openWSE.AjaxCall("WebServices/AcctSettings.asmx/SaveNewBackground", '{ "_workspace": "' + e + '","_img": "","folder": "' + selectedImgFolder + '" }', null, function (e) { loadingPopup.RemoveMessage(), BackgroundSelector(!1) }) } function updateBackgroundURL() { var e = $.trim($("#background-selector-holder").find("#tb_imageurl").val()); e && SaveNewBg(e) } function updateBackgroundColor() { var e = $("#background-selector-holder").find("#tb_solidColorBg").val(); 7 == e.length && SaveNewBg(e) } function SaveNewBg(e) { var t = Getworkspace(); openWSE_Config.multipleBackgrounds || (t = "workspace_1"), $("#MainContent_" + t).attr("data-backgroundimg") ? ConfirmWindowAltBtns("Do you want to remove the previous selected background(s)? Click No to add the new background to the existing list.", function () { openWSE_Config.demoMode || (loadingPopup.Message("Updating..."), $("#MainContent_" + t).attr("data-backgroundimg", ""), openWSE.AjaxCall("WebServices/AcctSettings.asmx/SaveNewBackground", '{ "_workspace": "' + t.replace("workspace_", "") + '","_img": "","folder": "' + selectedImgFolder + '" }', null, function (a) { loadingPopup.RemoveMessage(), loadingPopup.Message("Saving Background"), openWSE.AjaxCall("WebServices/AcctSettings.asmx/SaveNewBackground", '{ "_workspace": "' + t.replace("workspace_", "") + '","_img": "' + e + '","folder": "' + selectedImgFolder + '" }', null, function (e) { loadingPopup.RemoveMessage(), BackgroundSelector(!1) }) })), UpdateDataBackgroundImageAttr(e), SetNewBackground() }, function () { openWSE_Config.demoMode || (loadingPopup.Message("Saving Background"), openWSE.AjaxCall("WebServices/AcctSettings.asmx/SaveNewBackground", '{ "_workspace": "' + t.replace("workspace_", "") + '","_img": "' + e + '","folder": "' + selectedImgFolder + '" }', null, function (e) { loadingPopup.RemoveMessage(), BackgroundSelector(!1) })), UpdateDataBackgroundImageAttr(e), SetNewBackground() }) : (openWSE_Config.demoMode || (loadingPopup.Message("Saving Background"), openWSE.AjaxCall("WebServices/AcctSettings.asmx/SaveNewBackground", '{ "_workspace": "' + t.replace("workspace_", "") + '","_img": "' + e + '","folder": "' + selectedImgFolder + '" }', null, function (e) { loadingPopup.RemoveMessage(), BackgroundSelector(!1) })), UpdateDataBackgroundImageAttr(e), SetNewBackground()) } function UpdateDataBackgroundImageAttr(e) { var t = GetBackgroundArray(); -1 == e.indexOf("http://") && -1 === e.indexOf("https://") && -1 === e.indexOf("www://") && (e.length > 6 && 0 !== e.indexOf("#") ? -1 == e.indexOf("/" + openWSE_Config.siteRootFolder) && (0 !== e.indexOf("/") && (e = "/" + e), e = "/" + openWSE_Config.siteRootFolder + e) : e = "#" + e.replace("#", "")); for (var a = "", o = !1, n = 0; n < t.length; n++)t[n] == e ? o = !0 : -1 === t[n].indexOf("App_Themes/" + openWSE_Config.siteTheme + "/Body/default-bg.jpg") && (a += t[n] + "|"); o || (a += e + "|"); var i = Getworkspace(); openWSE_Config.multipleBackgrounds || (i = "workspace_1"), $("#MainContent_" + i).attr("data-backgroundimg", a) } function ChangeImageFolder() { selectedImgFolder = $("#background-selector-holder").find("#dd_userimagefolder").val(), imgFolderChange = !0, BackgroundSelector(!1) } function UpdateBackgroundSetting(e) { if ($(e).length > 0) { var t = $(e).attr("data-name"), a = $(e).val(); if ($(e).hasClass("background-setting-color")) a = $.trim($("#tb_defaultbackgroundcolor").val()), openWSE_Config.defaultBackgroundColor = "#" + a; else if ($(e).hasClass("background-setting-timer")) a = $.trim($("#tb_defaultbackgroundtimer").val()), openWSE_Config.backgroundTimerLoop = a; else switch (t) { case "backgroundposition": openWSE_Config.defaultBackgroundPosition = a; break; case "backgroundsize": openWSE_Config.defaultBackgroundSize = a, "100% 100%" == a || "cover" == a ? $("#background-repeat-holder").hide() : $("#background-repeat-holder").show(); break; case "backgroundrepeat": "rb_backgroundrepeat_off" == $(e).attr("id") ? (openWSE_Config.defaultBackgroundRepeat = "no-repeat", $("#rb_backgroundrepeat_on").removeAttr("checked"), $("#rb_backgroundrepeat_off").attr("checked", "checked"), $("#rb_backgroundrepeat_on").parent().removeClass("selected"), $("#rb_backgroundrepeat_off").parent().addClass("selected"), a = "0") : (openWSE_Config.defaultBackgroundRepeat = "repeat", $("#rb_backgroundrepeat_on").attr("checked", "checked"), $("#rb_backgroundrepeat_off").removeAttr("checked"), $("#rb_backgroundrepeat_on").parent().addClass("selected"), $("#rb_backgroundrepeat_off").parent().removeClass("selected"), a = "1"); break; case "backgroundindividual": "rb_backgroundindividual_off" == $(e).attr("id") ? (openWSE_Config.multipleBackgrounds = !1, $("#rb_backgroundindividual_on").removeAttr("checked"), $("#rb_backgroundindividual_off").attr("checked", "checked"), $("#rb_backgroundindividual_on").parent().removeClass("selected"), $("#rb_backgroundindividual_off").parent().addClass("selected"), a = "0") : (openWSE_Config.multipleBackgrounds = !0, $("#rb_backgroundindividual_on").attr("checked", "checked"), $("#rb_backgroundindividual_off").removeAttr("checked"), $("#rb_backgroundindividual_on").parent().addClass("selected"), $("#rb_backgroundindividual_off").parent().removeClass("selected"), a = "1") }SetCurrentWorkspaceBackground(), openWSE_Config.demoMode ? (setTimeout(function () { loadingPopup.RemoveMessage() }, 100), "backgroundindividual" == t && BackgroundSelector(!1)) : openWSE.AjaxCall("WebServices/AcctSettings.asmx/SaveBackgroundSetting", '{ "name": "' + t + '","value": "' + a + '" }', null, function (e) { loadingPopup.RemoveMessage(), "backgroundindividual" == t && BackgroundSelector(!1) }) } } function BackgroundImageSelect_Clicked(e, t) { if (!(t && t.target && $(t.target).hasClass("delete-uploadedimg"))) { var a = !1, o = Getworkspace(); openWSE_Config.multipleBackgrounds || (o = "workspace_1"), $("#MainContent_" + o).attr("data-backgroundimg") && (a = !0), a ? ConfirmWindowAltBtns("Do you want to remove the current selected background(s)? Click No to add the new background to the existing list.", function () { loadingPopup.Message("Updating..."), $("#MainContent_" + o).attr("data-backgroundimg", ""), openWSE.AjaxCall("WebServices/AcctSettings.asmx/SaveNewBackground", '{ "_workspace": "' + o + '","_img": "","folder": "' + selectedImgFolder + '" }', null, function (t) { loadingPopup.RemoveMessage(), openWSE.BackgroundImageAddRemove_Clicked(e) }) }, function () { openWSE.BackgroundImageAddRemove_Clicked(e) }) : openWSE.BackgroundImageAddRemove_Clicked(e) } } function BackgroundImageDelete_Clicked(e) { var t = $(e).attr("data-imgsrc"); !openWSE_Config.demoMode && t && ConfirmWindowAltBtns("Are you sure you want to permanently delete " + t + "?", function () { loadingPopup.Message("Deleting Background..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/DeleteUploadedImage", '{ "_img": "' + t + '" }', null, function (e) { loadingPopup.RemoveMessage(), BackgroundSelector(!1) }) }, null) } function BackgroundImageAddRemove_Clicked(e) { var t = $(e); t.hasClass("remove-selectedimg") && (t = $(e).parent()); var a = ""; if (0 === (a = t.find(".color-bg-div").length > 0 ? t.find(".color-bg-div").attr("data-color") : t.find("img").attr("data-imgsrc")).indexOf("Standard_Images/") && (a = "/" + a), !openWSE_Config.demoMode) { var o = Getworkspace().replace("workspace_", ""); openWSE_Config.multipleBackgrounds || (o = "1"), loadingPopup.Message("Saving Background"), openWSE.AjaxCall("WebServices/AcctSettings.asmx/SaveNewBackground", '{ "_workspace": "' + o + '","_img": "' + a + '","folder": "' + selectedImgFolder + '" }', null, function (e) { loadingPopup.RemoveMessage(), BackgroundSelector(!1), SetCurrentWorkspaceBackground() }) } UpdateDataBackgroundImageAttr(a), SetNewBackground() } function SetBackgroundForWorkspaceDropdown() { var e = 0, t = 0; if (($("#workspace-selector").hasClass("active") || "none" !== $("#workspace-selector").find(".b").css("display")) && $("#workspace-selector").find(".dropdown-db-selector").find(".workspace-selection-item").each(function () { var a = "1"; openWSE_Config.multipleBackgrounds && (a = $(this).attr("data-number")), $(this).find(".app-preview-holder").length > 0 && $(this).find(".app-preview-holder").remove(); var o = $("#main_container"), n = $("#MainContent_workspace_" + a); if (n.length > 0) { var i = n.attr("data-backgroundimg"); i ? i = i.split("|")[0] : (i = "/" + openWSE_Config.siteRootFolder + "/App_Themes/" + openWSE_Config.siteTheme + "/Body/default-bg.jpg", openWSE_Config.siteRootFolder || (i = "/App_Themes/" + openWSE_Config.siteTheme + "/Body/default-bg.jpg")), $(this).css("background-color", ""), $(this).css("background-image", ""), 0 == i.indexOf("#") ? $(this).css("background-color", i) : $(this).css("background-image", "url('" + i + "')") } if (showAppPreviewInWorkspaceSelector && (n = $("#MainContent_workspace_" + $(this).attr("data-number"))).length > 0) { for (var r = "", l = 0; l < n.find(".app-main-holder").length; l++) { var s = n.find(".app-main-holder").eq(l); if ("visible" === s.css("visibility") && "none" !== s.css("display")) { var d = parseInt(s.css("left").replace("px", "")) / o.outerWidth() * $(this).outerWidth(), p = parseInt(s.css("top").replace("px", "")) / o.outerHeight() * $(this).outerHeight(), c = s.outerWidth() / o.outerWidth() * $(this).outerWidth(), u = s.outerHeight() / o.outerHeight() * $(this).outerHeight(), h = s.css("z-index"); (s.hasClass("app-maximized") || s.hasClass("auto-full-page")) && (d = 0, p = 0, c = $(this).outerWidth(), u = $(this).outerHeight()), c -= 8, u -= 8.5; var f = ""; "function" == typeof html2canvas && openWSE_Config.canvasWorkspaceAppPreviews ? (t++ , "hidden" === n.css("visibility") && n.addClass("workspace-selector-clicked"), html2canvas(s, { allowTaint: !0, onrendered: function (t) { t.className = "app-preview-holder", t.style.width = this.width, t.style.height = this.height, t.style.top = this.offsetTop, t.style.left = this.offsetLeft, t.style.zIndex = this.zIndex, t.setAttribute("data-appid", this.appId), $(this.li).find("div.app-preview-holder[data-appid='" + this.appId + "']").length > 0 && $(this.li).find("div.app-preview-holder[data-appid='" + this.appId + "']").remove(), $(this.li).append(t), e++ }.bind({ li: this, width: c + "px", height: u + "px", offsetTop: p + "px", offsetLeft: d + "px", zIndex: h, appId: s.attr("data-appid") }) })) : s.find(".app-header-icon").length > 0 && "none" != s.find(".app-header-icon").css("display") ? f = "url('" + s.find(".app-header-icon").attr("src") + "')" : $(".app-icon[data-appid='" + s.attr("data-appid") + "']").find("img").length > 0 && (f = "url('" + $(".app-icon[data-appid='" + s.attr("data-appid") + "']").find("img").attr("src") + "')"), r += '<div class="app-preview-holder" data-appid="' + s.attr("data-appid") + '" style="width: ' + c + "px; height: " + u + "px; top: " + p + "px; left: " + d + "px; z-index: " + h + ";", f && (r += " background-image: " + f + ";"), r += '"></div>' } } $(this).append(r) } }), t > 0) var a = setInterval(function () { e >= t && ($(".workspace-holder").removeClass("workspace-selector-clicked"), clearInterval(a)) }, 1) } var backgroundLoopTimer = null, backgroundLoopIndex = 0; function BackgroundLoop() { $("#workspace_holder").length > 0 && (clearInterval(backgroundLoopTimer), backgroundLoopIndex = 0, backgroundLoopTimer = setInterval(function () { var e = GetBackgroundArray(); e.length > 1 ? ((backgroundLoopIndex += 1) >= e.length && (backgroundLoopIndex = 0), SetNewBackground(e[backgroundLoopIndex])) : clearInterval(backgroundLoopTimer) }, 1e3 * parseInt(openWSE_Config.backgroundTimerLoop))) } function GetBackgroundArray() { var e = new Array; if ($("#workspace_holder").length > 0) { var t = Getworkspace(); openWSE_Config.multipleBackgrounds || (t = "workspace_1"); var a = $("#MainContent_" + t).attr("data-backgroundimg"); a || (a = "/" + openWSE_Config.siteRootFolder + "/App_Themes/" + openWSE_Config.siteTheme + "/Body/default-bg.jpg", openWSE_Config.siteRootFolder || (a = "/App_Themes/" + openWSE_Config.siteTheme + "/Body/default-bg.jpg")); for (var o = a.split("|"), n = 0; n < o.length; n++)"" != o[n] && e.push(o[n]) } return e } function SetCurrentWorkspaceBackground() { $("#workspace_holder").length > 0 && (SetNewBackground(GetBackgroundArray()[0]), openWSE.BackgroundLoop()) } function SetNewBackground(e) { if (!e) { var t = GetBackgroundArray(); e = t[t.length - 1] } e.length > 6 && 0 !== e.indexOf("#") ? ($("#site_mainbody").css("background-image", "url('" + e + "')"), $("#site_mainbody").css("background-color", openWSE_Config.defaultBackgroundColor), $("#site_mainbody").css("background-position", openWSE_Config.defaultBackgroundPosition), $("#site_mainbody").css("background-repeat", openWSE_Config.defaultBackgroundRepeat), $("#site_mainbody").css("background-size", openWSE_Config.defaultBackgroundSize)) : 0 == e.indexOf("#") ? ($("#site_mainbody").css("background-image", ""), $("#site_mainbody").css("background-color", e)) : ($("#site_mainbody").css("background-image", ""), $("#site_mainbody").css("background-color", "#" + e)) } function HideTasks(e) { $(e).find(".app-main-holder").each(function (e) { var t = $(this).attr("data-appid"); 0 != $("#minimized_app_bar_holder").find(".app-min-bar[data-appid='" + t + "']").length && "none" != $("#minimized_app_bar_holder").find(".app-min-bar[data-appid='" + t + "']").css("display") && $("#minimized_app_bar_holder").find(".app-min-bar[data-appid='" + t + "']").hide() }), openWSE.ToggleMinimizedAppBar() } function ShowTasks(e) { $(e).find(".app-main-holder").each(function (e) { var t = $(this).attr("data-appid"); 0 != $("#minimized_app_bar_holder").find(".app-min-bar[data-appid='" + t + "']").length && "none" == $("#minimized_app_bar_holder").find(".app-min-bar[data-appid='" + t + "']").css("display") && $("#minimized_app_bar_holder").find(".app-min-bar[data-appid='" + t + "']").show() }), openWSE.ToggleMinimizedAppBar() } function LoadCurrentWorkspace(e) { SetWorkspaceNumber(e), id = "#MainContent_workspace_" + e, ResizeAllAppBody($(id)), $(id).css({ visibility: "visible", opacity: 1, filter: "alpha(opacity=100)" }), $("#workspace_holder .workspace-holder").each(function (e) { "visible" != $(this).css("visibility") && MoveOffScreen(this) }), SetCurrentWorkspaceBackground() } function Getworkspace() { for (var e = $("#workspace_holder").find(".workspace-holder"), t = e.length, a = 0; a < t; a++)if ("visible" == e.eq(a).css("visibility")) { var o = e.eq(a).attr("id"); return "workspace_" + o.substring(o.lastIndexOf("_") + 1) } return "workspace_1" } function HoverWorkspacePreview(e, t) { MoveOffScreen($(e)), MoveOnScreen_WorkspaceOnly($(t)), openWSE_Config.taskBarShowAll || (HideTasks($(e)), ShowTasks($(t))), $(e).css({ opacity: 0, filter: "alpha(opacity=0)" }), openWSE_Config.animationSpeed > 0 ? $(t).fadeTo(openWSE_Config.animationSpeed, 1) : $(t).css({ opacity: 1, filter: "alpha(opacity=100)" }), openWSE_Config.multipleBackgrounds && SetCurrentWorkspaceBackground(), ResizeAllAppBody($(t)), openWSE.ToggleMinimizedAppBar() } function SetWorkspaceNumber(e) { $("#workspace-selector").find(".workspace-menu-toggle").html("<span>" + e + "</span>") } function AutoRotateWorkspace(e, t, a, o) { setTimeout(function () { t == a ? t = 1 : t++; var n = "#MainContent_workspace_" + t; SetWorkspaceNumber(t); var i = !1, r = !1; $("#workspace_holder .workspace-holder").each(function () { "visible" == $(this).css("visibility") && (!openWSE_Config.taskBarShowAll && openWSE.ConvertBitToBoolean($("#minimized_app_bar").attr("data-show")) && $("#minimized_app_bar").show(), $(this).fadeTo(openWSE_Config.animationSpeed, 0, function () { if (!i) return i = !0, MoveOffScreen(this), MoveOnScreen_WorkspaceOnly($(n)), openWSE_Config.taskBarShowAll || (HideTasks(this), ShowTasks($(n))), $(n).find(".app-main-holder").each(function (e) { o && AutoUpdateOnRotate(this) }), openWSE_Config.multipleBackgrounds && SetCurrentWorkspaceBackground(), ResizeAllAppBody($(n)), $(n).fadeTo(openWSE_Config.animationSpeed, 1, function () { r || (r = !0) }), !1 })) }), AutoRotateWorkspace(e, t, a, o) }, 1e3 * e) } function AutoUpdateOnRotate(e) { $(e).find(".app-title").eq(0).text(); var t = $(e), a = t.attr("data-appid"); if ("block" == t.css("display")) if (ResizeAppBody($(".app-main-holder[data-appid='" + a + "']")), $(".app-main-holder").css("z-index", "1000"), t.css("z-index", "3000"), t.find(".iFrame-apps").length > 0) { var o = t.find(".iFrame-apps"); o && null != o && null != o.src && (o.src = o.src) } else $("#hf_ReloadApp").val(a), openWSE.CallDoPostBack("hf_ReloadApp", "") } function ToggleMinimizedAppBar() { if (0 === $("#minimized_app_bar_holder").find(".app-min-bar").length) $("#minimized_app_bar").hide(); else { for (var e = !1, t = $("#minimized_app_bar_holder").find(".app-min-bar"), a = 0; a < t.length; a++)if ("none" !== t.eq(a).css("display")) { e = !0; break } e && openWSE.ConvertBitToBoolean($("#minimized_app_bar").attr("data-show")) ? $("#minimized_app_bar").show() : $("#minimized_app_bar").hide() } } function AppsSortUnlocked(e) { canSortMyAppOverlay = !0, e && (canSaveSort = !0, canSaveSortedMyAppOverlay = !0), $("#updatePnl_AppList").sortable({ cancel: ".app-icon-category-list, .app-popup", containment: "#updatePnl_AppList", scrollSensitivity: 40, scrollSpeed: 40, tolerance: "pointer", start: function (e, t) { $(document).tooltip({ disabled: !0 }), $(".app-icon").each(function () { $(this).css("-moz-transition", "none"), $(this).css("-webkit-transition", "none"), $(this).css("transition", "none") }) }, stop: function (e, t) { var a = ""; $(".app-icon").each(function () { $(this).css("-moz-transition", ""), $(this).css("-webkit-transition", ""), $(this).css("transition", ""); var e = $(this).attr("data-appid"); "" != e && -1 == a.indexOf(e + ",") && (a += e + ",") }), canSaveSort && openWSE.AjaxCall(saveHandler + "/App_UpdateIcons", '{ "appList": "' + escape(a) + '" }'), openWSE_Config.showToolTips && $(document).tooltip({ disabled: !1 }) } }), 0 == $(".app-icon.Icon_Only").length && 0 == $(".app-icon.Icon_And_Text_Only").length && 0 == $(".app-icon.Icon_And_Color_Only").length && 0 == $(".app-icon.Icon_Plus_Color_And_Text").length && $("#updatePnl_AppList").sortable("option", "axis", "y"), $("#updatePnl_AppList").disableSelection() } function CreateSOApp(e, t, a, o, n, i, r, l, s) { var d = $(".app-main-holder[data-appid='" + e + "']"); if (ApplyStyle3HeightFix(d), null != a && "" != a) { a = unescape(a), d.find(".app-title").text(t), openWSE.ConvertBitToBoolean(s) && (d.addClass("app-maximized"), d.find(".maximize-button-app").addClass("active")), "" != i && d.css("width", i), "" != r && d.css("height", r), openWSE.ConvertBitToBoolean(l) ? (BuildAppMinIcon(d, t, o, n), MoveOffScreen(d)) : (d.css({ visibility: "visible", display: "block", zIndex: 3e3 }), openWSE.ConvertBitToBoolean(s) || (d.removeClass("app-maximized"), d.find(".maximize-button-app").removeClass("active"), parseInt(n) < 0 && (n = "0"), parseInt(o) < 0 && (o = "0"), d.css({ left: o, top: n }))), IsValidAscxFile(a) ? LoadCSSFilesInApp(d.attr("data-appid")) : -1 != a.indexOf("ChatClient/ChatWindow.html") ? (d.find(".app-body").html("<iframe class='iFrame-apps' src='" + openWSE.siteRoot() + a + "' width='100%' frameborder='0'></iframe>"), ResizeAppBody(d), d.find("iframe").one("load", function () { ResizeAppBody(d), d.find(".loading-background-holder").each(function () { $(this).remove() }) })) : IsValidAspxFile(a) || IsValidHttpBasedAppType(a) ? (d.find(".app-body").html("<iframe class='iFrame-apps' src='" + a + "' width='100%' frameborder='0'></iframe>"), ResizeAppBody(d), d.find("iframe").one("load", function () { ResizeAppBody(d), d.find(".loading-background-holder").each(function () { $(this).remove() }) })) : d.find(".app-body").load(a, function () { LoadCSSFilesInApp(d.attr("data-appid")), d.find(".app-body").find("iframe").length > 0 && (d.find(".app-body").find(".loading-background-holder").length <= 0 && AppendLoadingMessage(d.find(".app-body")), ResizeAppBody(d), d.find(".app-body").find("iframe").one("load", function () { ResizeAppBody(d), d.find(".app-body").find(".loading-background-holder").each(function () { $(this).remove() }) })) }), SetAppIconActive(d); var p = d.parent().attr("id"); null != p && null != p && "" != p && AddworkspaceAppNum(p, e) } } function BuildAppMinIcon(e, t, a, o) { var n = $(e); if (n.length > 0) { var i = n.attr("data-appid"), r = n.find(".app-header-icon"); (0 === r.length || r.hasClass("display-none")) && $(".app-icon[data-appid='" + i + "']").find("img").length > 0 && (r = $(".app-icon[data-appid='" + i + "']").find("img").eq(0)); var l = n.find(".app-title").eq(0); (0 === l.length || l.hasClass("display-none")) && $(".app-icon[data-appid='" + i + "']").find(".app-icon-font").length > 0 && (l = $(".app-icon[data-appid='" + i + "']").find(".app-icon-font").eq(0)); var s = !1, d = !1, p = "", c = "app-min-bar"; -1 != i.replace(/#/gi, "").indexOf("app-ChatClient-") && (c = "app-min-bar chat-modal", p = " chat-username='" + n.attr("chat-username") + "'"); var u = "<div data-appid='" + i + "' class='" + c + "'" + p + " data-x='" + a + "' data-y='" + o + "'>"; if (r.hasClass("display-none") || 0 == r.length || l.hasClass("display-none")) if ((r.hasClass("display-none") || 0 == r.length) && l.hasClass("display-none")) u += "<span class='app-title pad-right'>" + t + "</span>", u += "<a href='#" + i + "' class='exit-button-app-min'></a></div>"; else { var h = !1, f = !0; r.hasClass("display-none") || (u += r.outerHTML(), h = !0, "none" == r.css("display") && (s = !0)), l.hasClass("display-none") ? (u += "<span class='app-title pad-right display-none'>" + t + "</span>", d = !0, f = !1) : u += "<span class='app-title pad-right'>" + t + "</span>"; var g = ""; h && !f && (g = " style='margin-left: 5px;'"), u += "<a href='#" + i + "' class='exit-button-app-min'" + g + "></a></div>" } else u += r.outerHTML(), "none" == r.css("display") && (s = !0), u += "<span class='app-title pad-right'>" + t + "</span>", u += "<a href='#" + i + "' class='exit-button-app-min'></a></div>"; 0 == $(".app-min-bar[data-appid='" + i + "']").length && $("#minimized_app_bar_holder").append(u), s && $(".app-min-bar[data-appid='" + i + "']").find(".app-header-icon").show(), d && $(".app-min-bar[data-appid='" + i + "']").attr("title", t); var m = $(".app-icon[data-appid='" + i + "']"); if (m.length > 0 && (m.hasClass("Color_And_Description") || m.hasClass("Icon_And_Color_Only") || m.hasClass("Icon_Plus_Color_And_Text"))) { var v = $(".app-icon[data-appid='" + i + "']").css("background"); $(".app-min-bar[data-appid='" + i + "']").css("background", v); var b = $(".app-min-bar[data-appid='" + i + "']").find(".app-title").eq(0); if (b.length > 0) { var C = m.find(".app-icon-font").css("color"); b.css("color", C) } } n.css({ visibility: "hidden", display: "block" }) } openWSE.ToggleMinimizedAppBar() } function LoadApp(e, t) { e.length && e.length > 0 && (e = $(e[0])); var a = $(e).find(".app-icon-font").text(); "" == a && "" == (a = $(e).find(".app-title").eq(0).text()) && (a = $(e).find("span").text()); var o = $(e).attr("data-appid"); if (null != o && null != o && "" != o) { var n = $(".app-main-holder[data-appid='" + o + "']"); ApplyStyle3HeightFix(n); var i = n.attr("data-content"); "" == i || null == i || null == i ? openWSE.AjaxCall(saveHandler + "/App_Open", '{ "appId": "' + o + '","name": "' + a + '","workspace": "' + t + '","width": "' + n.width() + '","height": "' + n.height() + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', null, function (e) { "" != e.d && FinishContentLoad(n, o, t, e.d, a) }) : (FinishContentLoad(n, o, t, i, a), openWSE.AjaxCall(saveHandler + "/App_Open_NoContent", '{ "appId": "' + o + '","name": "' + a + '","workspace": "' + t + '","width": "' + n.width() + '","height": "' + n.height() + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }')) } openWSE.ToggleMinimizedAppBar() } function FinishContentLoad(e, t, a, o, n) { e.length && e.length > 0 && (e = $(e[0])); var i = $(e); if (0 !== i.length) { SetActiveApp(i), MoveToCurrworkspace(a, t), AddworkspaceAppNum(a, t); var r = i.width(), l = i.height(); if ("block" != i.css("display") || "visible" != i.css("visibility") || previewHover) { var s = ""; if ("" == (s = null == i.find(".app-body").find("div").html() ? $.trim(i.find(".app-body").html()) : $.trim(i.find(".app-body").find("div").html()))) { if (-1 != t.indexOf("app-ChatClient-")) o = "ChatClient/ChatWindow.html?user=" + i.attr("chat-username") + "&displayVersion=workspace"; null == i.css("left") && null == i.css("top") || "auto" == i.css("left") && "auto" == i.css("top") ? CreateSOApp(t, n, o, "50px", "50px", r, l, "1", "0") : (parseInt(i.css("top")) < 0 && i.css("top", "50px"), parseInt(i.css("left")) < 0 && i.css("left", "50px"), CreateSOApp(t, n, o, i.css("left"), i.css("top"), r, l, "1", "0")) } if (i.css("display", "block"), i.css("visibility", "visible"), i.css("z-index", "3000"), 0 != $(".app-min-bar[data-appid='" + t + "']").length) { i.find(".loading-background-holder").length <= 0 && "" == s && AppendLoadingMessage(i.find(".app-body")), i.hasClass("auto-full-page") || i.hasClass("auto-full-page-min") || i.hasClass("app-maximized") || i.hasClass("app-maximized-min") ? (SetAppMinToMax(i), i.find(".maximize-button-app").addClass("active"), i.css("top", "0px")) : (i.find(".maximize-button-app").removeClass("active"), i.css("width", r), i.css("height", l), i.css("top", topBarHt)); var d = $(".app-min-bar[data-appid='" + t + "']").attr("data-x"), p = $(".app-min-bar[data-appid='" + t + "']").attr("data-y"); previewHover && previewAppID == t ? i.css({ visibility: "visible", display: "block", opacity: 1, left: d, top: p }) : i.css({ visibility: "visible", display: "block" }).animate({ opacity: 1, filter: "alpha(opacity=100)", left: d, top: p }, openWSE_Config.animationSpeed), openWSE.AjaxCall(saveHandler + "/App_Move", '{ "appId": "' + t + '","name": "' + n + '","x": "' + d + '","y": "' + p + '","width": "' + r + '","height": "' + l + '","workspace": "' + a + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }'), ResizeAllAppBody(i) } else i.css({ top: topBarHt, visibility: "visible", display: "block" }).fadeIn(openWSE_Config.animationSpeed); if ($(".app-min-bar[data-appid='" + t + "']").remove(), previewHover = !1, previewAppID = "", 1 == needpostback) { var c = document.getElementById("hf_loadApp1"); 0 == appsToLoad.length ? (appsToLoad[0] = t, c.value = t, openWSE.CallDoPostBack("hf_loadApp1", "")) : appsToLoad[appsToLoad.length - 1] = t } else IsValidAscxFile(o) && 0 == needpostback && i.find(".loading-background-holder").each(function () { $(this).remove() }) } openWSE.ToggleMinimizedAppBar() } else $(".app-icon[data-appid='" + t + "']").removeClass("active") } function ApplyStyle3HeightFix(e) { var t = $(e); if (t.length > 0 && t.hasClass("app-main-style3") && !t.hasClass("style3-resize-applied") && t.find(".app-head").length > 0) { var a = window.getComputedStyle(t.find(".app-head")[0], null).getPropertyValue("height"); if (a) { var o = parseInt(a.replace("px", "").replace("em", "")); if (o) { var n = parseInt(t.css("min-height").replace("px", "").replace("em", "")); n && t.css("min-height", n - o); var i = parseInt(t.css("height").replace("px", "").replace("em", "")); i && t.css("height", i - o); var r = parseInt(t.find(".app-body").css("height").replace("px", "").replace("em", "")); r && t.find(".app-body").css("height", r - o) } } t.addClass("style3-resize-applied") } } function LoadAppFromSiteTools(e, t, a) { null != e && null != e && "" != e && ($("#ConfirmApp-element").remove(), loadingPopup.Message("Loading. Please Wait..."), cookieFunctions.set("active_app", e, 30, function () { var o = $(".app-main-holder[data-appid='" + e + "']").width(), n = $(".app-main-holder[data-appid='" + e + "']").height(); openWSE.AjaxCall(saveHandler + "/App_Open_ChangeWorkspace", '{ "appId": "' + e + '","name": "' + t + '","workspace": "' + a + '","width": "' + o + '","height": "' + n + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', null, function (e) { window.location = openWSE.siteRoot() + "Default.aspx" }) })) } function DetermineNeedPostBack(e, t) { "none" == $(".app-main-holder[data-appid='" + $(e).attr("data-appid") + "']").css("display") && (needpostback = t) } function WatchForLoad(e) { var t = $(".app-main-holder[data-appid='" + e + "']"); t.find("iframe").one("load", function () { t.find(".loading-background-holder").each(function () { $(this).remove() }) }) } function LoadUserControl(e) { for (var t = document.getElementById("hf_loadApp1"), a = 0; a < appsToLoad.length; a++)appsToLoad[a] == e && appsToLoad.splice(a, 1); var o = "#MainContent_" + e.replace(/-/gi, "_") + "_advPanel"; $(o).html(""), $(".move-holder").find(".main-div-app-bg").length > 0 && $(o).hide().append($(".move-holder").find(".main-div-app-bg")).show(); var n = $(".app-main-holder[data-appid='" + e + "']"), i = $(o).closest(".app-body").parent().parent(); i.length > 0 && (LoadCSSFilesInApp(e), n.length > 0 && n.find(".outside-main-app-div").each(function () { $(this).addClass(e + outsideAppModal), i.append($(this)) }), $(".move-holder").find(".outside-main-app-div").length > 0 && $(".move-holder").find(".outside-main-app-div").each(function () { 1 == n.length && ($(this).addClass(e + outsideAppModal), i.append($(this))) })), ResizeAppBody(n), n.find(".loading-background-holder").each(function () { $(this).remove() }), appsToLoad.length > 0 && (t.value = appsToLoad[0], openWSE.CallDoPostBack("hf_loadApp1", "")), needpostback = 0 } function MoveOutsideModalWindows() { $(".outside-main-app-div").each(function () { var e = $(this).closest(".app-body").parent().parent(); if (e.length > 0 && 1 == $("#" + $(this).attr("id")).length) { var t = $(this).closest(".app-body").parent().attr("data-appid"); $(this).addClass(t + outsideAppModal), e.append($(this)) } }) } function MoveOutSideModalWindowToWorkspace(e) { var t = $(".app-main-holder[data-appid='" + e + "']").parent(); $("." + e + outsideAppModal).each(function () { t.length > 0 && 1 == $("#" + $(this).attr("id")).length && t.append($(this)) }) } function LoadCSSFilesInApp(e) { var t = $(".app-main-holder[data-appid='" + e + "']"); if (0 === t.length && (t = $(".workspace-overlay-selector[data-overlayid='" + e + "']")), t.length > 0) { var a = document.head || document.getElementsByTagName("head")[0]; t.find("link").each(function () { var t = $.trim($(this).attr("href")); t ? 0 === $("link[data-id='" + e + "'][href='" + t + "']").length && (0 == (t = AppendTimestampToUrl(t)).indexOf("~/") ? (t = openWSE.siteRoot() + t.replace("~/", ""), $(this).attr("href", t)) : 0 == t.indexOf("App/") && (t = openWSE.siteRoot() + t, $(this).attr("href", t)), $(this).attr("data-id", e), $(document.head).append($(this))) : 0 === $("link[data-id='" + e + "']").length && ($(this).attr("data-id", e), $(document.head).append($(this))) }), t.find("style").each(function () { 0 === $("style[data-id='" + e + "']").length && ($(this).attr("data-id", e), $(document.head).append($(this))) }), t.find("script").each(function () { var t = $.trim($(this).attr("src")); if (t) { if (0 === $("script[data-id='" + e + "'][src='" + t + "']").length) { 0 == (t = AppendTimestampToUrl(t)).indexOf("~/") ? t = openWSE.siteRoot() + t.replace("~/", "") : 0 == t.indexOf("App/") && (t = openWSE.siteRoot() + t); var o = document.createElement("script"); o.src = t, o.type = $(this).attr("type"), o.setAttribute("data-id", e), o.async = !1, $(this).remove(), a.insertBefore(o, a.firstChild) } } else 0 === $("script[data-id='" + e + "']").length && ($(this).attr("data-id", e), $(document.head).append($(this))) }), t.find("input[data-scriptelement='true']").each(function () { var t = $(this).attr("data-tagname"); if (t) { t = $.trim(t).toLowerCase(); var o = $(this).attr("data-tagtype"); o && (o = $.trim(o)); var n = $(this).attr("data-tagrel"); n && (n = $.trim(n)); var i = $(this).attr("data-tagsrc"); i && (0 == (i = AppendTimestampToUrl(i = $.trim(i))).indexOf("~/") ? i = openWSE.siteRoot() + i.replace("~/", "") : 0 == i.indexOf("App/") && (i = openWSE.siteRoot() + i)); var r = document.createElement(t); if (r) switch (r.setAttribute("data-id", e), r.type = o, n && (r.rel = n), t) { case "script": if (0 === $("script[data-id='" + e + "'][src='" + i + "']").length) { r.src = i; var l = $(this).attr("data-tagasync"); r.async = !!l && "true" == $.trim(l), a.insertBefore(r, a.firstChild) } break; case "link": 0 === $("link[data-id='" + e + "'][href='" + i + "']").length && (r.href = i, a.insertBefore(r, a.firstChild)) } } }) } } function RemoveCSSFilesOnAppClose(e) { $("link[data-id='" + e + "']").length > 0 && $("link[data-id='" + e + "']").remove(), $("style[data-id='" + e + "']").length > 0 && $("style[data-id='" + e + "']").remove(), $("script[data-id='" + e + "']").length > 0 && $("script[data-id='" + e + "']").remove() } function AppendTimestampToUrl(e) { if (openWSE_Config.appendTimestampOnScripts) { var t = Math.floor(Date.now() / 1e3); e.indexOf("?") > 0 ? e += "&" + openWSE_Config.timestampQuery + t : e += "?" + openWSE_Config.timestampQuery + t } return e } function IsValidAspxFile(e) { return (e = e.toLowerCase()).length > 5 && ".aspx" == e.substring(e.length - 5) } function IsValidAscxFile(e) { return (e = e.toLowerCase()).length > 5 && ".ascx" == e.substring(e.length - 5) || e.length > 5 && ".dll" == e.substring(e.length - 4) } function IsValidHttpBasedAppType(e) { return 0 === (e = e.toLowerCase()).indexOf("//") || -1 != e.indexOf("http://") || -1 != e.indexOf("https://") || -1 != e.indexOf("www.") } function ResizeAllAppBody(e) { $(e).find(".app-main-holder").each(function (e) { ResizeAppBody(this) }) } function ResizeAppBody(e) { var t = $(e); if (t.length > 0 && t.hasClass("app-main-holder")) { var a = t.outerHeight(), o = t.find(".app-head"), n = 0; o.length > 0 && "none" != o.css("display") && (n = o.outerHeight()); var i = 0; if ("" != t.css("border")) { var r = t.css("border").split("px")[0]; (r = parseInt(r)) && "NaN" != r.toString() && (i = 2 * r) } else { if ("" != t.css("border-top")) { r = t.css("border-top").split("px")[0]; (r = parseInt(r)) && "NaN" != r.toString() && (i = r) } if ("" != t.css("border-bottom")) { r = t.css("border-bottom").split("px")[0]; (r = parseInt(r)) && "NaN" != r.toString() && (i += r) } } var l = a - (n + i); if (t.find(".app-body").css({ height: l, width: t.width() }), t.find(".iFrame-apps").length > 0) { var s = 0; t.find(".app-title-bg-color").length > 0 && (s = t.find(".app-title-bg-color").outerHeight()), t.find(".iFrame-apps").css("height", l - s) } } } function ApplyOverlayFix(e) { var t = $(e); t.length > 0 && ($wo = t.find(".app-overlay-fix"), 0 == $wo.length && ($wb = t.find(".app-body"), 1 == $wb.length && $wb.append("<div class='app-overlay-fix'></div>"))) } function RemoveOverlayFix(e) { $wo = $(e).find(".app-overlay-fix"), 1 == $wo.length && $wo.remove() } function MoveOffScreen(e) { var t = $(e), a = t.height(), o = $(window).height(), n = -(a + o); t.css({ visibility: "hidden", top: n, bottom: o, zIndex: -1 }), SetAppMaxToMin(e) } function MoveOnScreen_WorkspaceOnly(e) { var t = $(e); t.css({ visibility: "visible", top: 0, bottom: 0, zIndex: "" }), SetAppMinToMax(t) } function MoveToCurrworkspace(e, t) { var a = $(".app-main-holder[data-appid='" + t + "']"); SetAppMinToMax(a); var o = "MainContent_" + e; a.parent().attr("id") != o && (a.find("iframe").length > 0 && (a.find(".loading-background-holder").length <= 0 && AppendLoadingMessage(a.find(".app-body")), WatchForLoad(t)), $("#" + o).prepend(a), AddworkspaceAppNum(e, t), MoveOutSideModalWindowToWorkspace(t), ResizeAppBody(a)) } function SetAppMaxToMin(e) { var t = $(e); t.hasClass("app-maximized") && (t.removeClass("app-maximized"), t.addClass("app-maximized-min")), t.hasClass("auto-full-page") && (t.removeClass("auto-full-page"), t.addClass("auto-full-page-min")) } function SetAppMinToMax(e) { var t = $(e); t.hasClass("app-maximized-min") && (t.removeClass("app-maximized-min"), t.addClass("app-maximized")), t.hasClass("auto-full-page-min") && (t.removeClass("auto-full-page-min"), t.addClass("auto-full-page")), ResizeAppBody(e) } function HoverOverAppMin(e) { if (!previewHover && $(".app-min-bar[data-appid='" + $(e).attr("data-appid") + "']").length > 0) { previewHover = !0, previewAppID = $(e).attr("data-appid"); var t = Getworkspace(), a = $("#MainContent_" + t).find(".app-main-holder[data-appid='" + previewAppID + "']"); if (a.length > 0) { var o = $(".app-min-bar[data-appid='" + previewAppID + "']").attr("data-x"), n = $(".app-min-bar[data-appid='" + previewAppID + "']").attr("data-y"); null != o && "" != o || (o = 0), null != n && "" != n || (n = 0), SetAppMinToMax(a), a.css("left", o), a.css("top", n), a.addClass("app-min-bar-preview"), ResizeAppBody(a), a.fadeTo(openWSE_Config.animationSpeed, .65) } } } function HoverOutAppMin() { if ((e = $(".app-main-holder[data-appid='" + previewAppID + "']")).hasClass("app-min-bar-preview")) e.css("opacity", "0.0"), e.css("filter", "alpha(opacity=0)"), e.removeClass("app-min-bar-preview"), SetAppMaxToMin(e), MoveOffScreen(e), previewAppID = "", previewHover = !1; else { var e, t = Getworkspace(); 0 == (e = $("#MainContent_" + t).find(".app-main-holder[data-appid='" + previewAppID + "']")).length && (previewAppID = "", previewHover = !1) } } function SetActiveApp(e) { if (openWSE.IsComplexWorkspaceMode()) { var t = $(e); if (SetDeactiveApps(t), t.length > 0) { t.addClass("selected"), t.css("z-index", "3000"); var a = t.attr("data-appid"); cookieFunctions.set("active_app", a, "30") } } } function SetDeactiveApps(e) { if (openWSE.IsComplexWorkspaceMode()) { var t = $(e).attr("data-appid"); $(".app-main-holder").css("z-index", "1000"), $(".app-main-holder").removeClass("selected"), $(".app-main-holder").each(function (e) { var a = $(this).attr("data-appid"); "block" == $(this).css("display") && (a != t ? ApplyOverlayFix(this) : a == t && $(this).find(".app-overlay-fix").remove()) }) } } function SetDeactiveAll() { cookieFunctions.del("active_app"), $(".app-main-holder").each(function (e) { "block" == $(this).css("display") && ApplyOverlayFix(this) }) } function LoadActiveAppCookie() { openWSE.IsComplexWorkspaceMode() && cookieFunctions.get("active_app", function (e) { null != e && "" != e && null != e ? SetActiveApp($(".app-main-holder[data-appid='" + e + "']")) : SetDeactiveAll() }) } function StartRemoteLoad(e, t, a, o) { openWSE.AjaxCall(saveHandler + "/App_RemoteLoad", '{ "_Id": "' + escape(e) + '" }', null, function (e) { try { null != e.d && LoadRemotely(unescape(e.d[0]), unescape(e.d[1]), unescape(e.d[2])) } catch (e) { } loadingPopup.RemoveMessage(), autoupdate(t, a, o) }, function (e) { loadingPopup.RemoveMessage(), autoupdate(t, a, o) }) } function LoadRemotely(e, t, a) { "close" == t && ("block" == (i = $(".app-main-holder[data-appid='" + e + "']")).css("display") && i.find(".exit-button-app").length > 0 && (exitBtn_InProgress = !1, i.find(".exit-button-app").click())); if ("close-all" == t) $(".app-main-holder").each(function () { "block" == $(this).css("display") && $(this).find(".exit-button-app").length > 0 && (exitBtn_InProgress = !1, $(this).find(".exit-button-app").click()) }); else if ("workspace-selector" == e) { try { $(".workspace-selection-item").eq(parseInt(t) - 1).trigger("click") } catch (e) { } var o = "#MainContent_" + Getworkspace(), n = "#MainContent_workspace_" + t; SetWorkspaceNumber(t), HoverWorkspacePreview(o, n) } else { var i, r = t.split(";"), l = "1"; if (l = "" != r[0] && "0" != r[0] ? r[0] : Getworkspace().replace("workspace_", ""), needpostback = openWSE.ConvertBitToBoolean(a) ? 1 : 0, -1 != e.indexOf("app-ChatClient-")) for (var s = e.replace("app-ChatClient-", ""), d = 0; d < $(".ChatUserNotSelected").length; d++) { var p = $(".ChatUserNotSelected").eq(d); if (1 == p.length && 1 == p.find(".usersclick[chat-userid='" + s + "']").length) { var c = $.trim(p.find(".usersclick[chat-userid='" + s + "']").html()), u = p.attr("chat-username"); return void chatClient.BuildChatWindow(u, s, c) } } if (0 == (i = $(".app-icon[data-appid='" + e + "']")).length) return; var h = r[2].replace("px", ""), f = r[3].replace("px", ""), g = r[4].replace("px", ""), m = r[5].replace("px", ""); if ("" != $("#hf_appContainer").val()) { h = parseInt(h), f = parseInt(f), g = parseInt(g), m = parseInt(m); f + g > $("#main_container").outerWidth() && (f = Math.abs($("#main_container").outerWidth() - g) - 2), h + m > $("#main_container").outerHeight() && (h = Math.abs($("#main_container").outerHeight() - m) - 2) } if ("block" == $(".app-main-holder[data-appid='" + e + "']").css("display") ? $(".app-main-holder[data-appid='" + e + "']").css({ top: h + "px", left: f + "px" }) : $(".app-main-holder[data-appid='" + e + "']").css({ top: "auto", left: "auto" }), $(".app-main-holder[data-appid='" + e + "']").hasClass("ui-resizable") && $(".app-main-holder[data-appid='" + e + "']").css({ width: g + "px", height: m + "px" }), "block" == $(".app-main-holder[data-appid='" + e + "']").css("display")) ReloadApp($(".app-main-holder[data-appid='" + e + "']").find(".reload-button-app").parent()); LoadApp(i, "workspace_" + l), 0 == i.hasClass("active") && i.addClass("active"), SetRemoteLoadingOptions(e, l, r[1]) } } function SetRemoteLoadingOptions(e, t, a) { var o = $(".app-main-holder[data-appid='" + e + "']"); if ("block" == o.css("display")) { t = t.substring(t.lastIndexOf("_") + 1); try { $(".workspace-selection-item").eq(parseInt(t) - 1).trigger("click") } catch (e) { } var n = "#MainContent_" + Getworkspace(), i = "#MainContent_workspace_" + t; if (SetWorkspaceNumber(t), HoverWorkspacePreview(n, i), MoveAppToworkspace(t), "" != a) { var r = !1; switch (a) { case "minimize": if (0 == $(".app-min-bar[data-appid='" + e + "']").length) o.find(".minimize-button-app").length > 0 && (o.find(".minimize-button-app").click(), r = !0); else var l = setInterval(function () { "visible" == o.css("visibility") && (o.find(".minimize-button-app").click(), r = !0, clearInterval(l)) }, 50); break; case "maximize": o.find(".maximize-button-app").length > 0 && !o.hasClass("app-maximized") && (o.find(".maximize-button-app").click(), r = !0); break; case "normal": o.hasClass("app-maximized") && o.find(".maximize-button-app").length > 0 && (o.find(".maximize-button-app").click(), r = !0) }r || setTimeout(function () { openWSE.AjaxCall(saveHandler + "/App_Position", '{ "appId": "' + o.attr("data-appid") + '","posX": "' + o.css("left") + '","posY": "' + o.css("top") + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }') }, openWSE_Config.animationSpeed) } } else setTimeout(function () { SetRemoteLoadingOptions(e, t, a) }, 100) } function MaximizeApp(e) { var t = Getworkspace(), a = $(e), o = a.find(".app-title").eq(0).text(), n = a.css("left").replace("px", ""), i = a.css("top").replace("px", ""), r = a.width(), l = a.height(); SetActiveApp(e), a.hasClass("app-maximized") ? (a.removeClass("app-maximized"), ResizeAppBody(e), a.find(".maximize-button-app").removeClass("active"), openWSE.AjaxCall(saveHandler + "/App_Maximize", '{ "appId": "' + a.attr("data-appid") + '","name": "' + o + '","x": "' + n + '","y": "' + i + '","width": "' + r + '","height": "' + l + '","workspace": "' + t + '","ismax": "0","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', null, function (e) { maxBtn_InProgress = !1, openWSE.SetLeftSidebarScrollTop(), $(window).resize() }, function (e) { maxBtn_InProgress = !1 })) : (a.addClass("app-maximized"), ResizeAppBody(e), a.find(".maximize-button-app").addClass("active"), openWSE.AjaxCall(saveHandler + "/App_Maximize", '{ "appId": "' + a.attr("data-appid") + '","name": "' + o + '","x": "' + n + '","y": "' + i + '","width": "' + r + '","height": "' + l + '","workspace": "' + t + '","ismax": "1","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', null, function (e) { maxBtn_InProgress = !1, openWSE.SetLeftSidebarScrollTop(), $(window).resize() }, function (e) { maxBtn_InProgress = !1 })) } function SetAppIconActive(e) { var t = $(e).attr("data-appid"); if (null != t && null != t) if (-1 == t.indexOf("app-ChatClient-")) for (var a = $(".app-icon").find("span").length, o = 0; o < a; o++) { $(".app-icon").eq(o).attr("data-appid") == t && 0 == $(".app-icon").eq(o).hasClass("active") && $(".app-icon").eq(o).addClass("active") } else { var n = $(".app-main-holder[data-appid='" + t + "']").attr("chat-username"); $(".ChatUserNotSelected[chat-username='" + n + "']").length > 0 ? $(".ChatUserNotSelected[chat-username='" + n + "']").addClass("ChatUserSelected") : $(".ChatUserNotSelected[chat-username='" + n.toLowerCase() + "']").addClass("ChatUserSelected") } } function AddworkspaceAppNum(e, t) { if (openWSE_Config.ShowWorkspaceNumApp && openWSE.IsComplexWorkspaceMode()) { var a = $(".app-icon[data-appid='" + t + "']"); if (a.length > 0) { var o, n = t + "-workspace-reminder", i = "workspace-reminder font-no-bold " + n, r = "display:block;"; if (a.find(".app-icon-font").length > 0 && (a.hasClass("Icon_And_Color_Only") || a.hasClass("Color_And_Description") || a.hasClass("Icon_Plus_Color_And_Text"))) r += "color:" + a.find(".app-icon-font").css("color") + "!important;"; $("." + n).length > 0 && $("." + n).remove(), "" != (o = "<span class='" + i + "' style='" + r + "'>" + e.substring(e.lastIndexOf("_") + 1) + "</span>") && a.append(o) } } } function RemoveworkspaceAppNum(e) { if (openWSE.IsComplexWorkspaceMode()) { var t = $(e).attr("data-appid"); if ($(".app-icon[data-appid='" + t + "']").length > 0) { var a = t + "-workspace-reminder"; $("." + a).length > 0 && $("." + a).remove() } } } function RemoveAppIconActive(e) { var t = $(e).attr("data-appid"); if ($(".app-main-holder[data-appid='" + t + "']").find(".maximize-button-app").removeClass("active"), -1 == t.indexOf("app-ChatClient-")) for (var a = $(".app-icon").find("span").length, o = 0; o < a; o++) { $(".app-icon").eq(o).attr("data-appid") == t && 1 == $(".app-icon").eq(o).hasClass("active") && $(".app-icon").eq(o).removeClass("active") } else { var n = $(".app-main-holder[data-appid='" + t + "']").attr("chat-username"); chatClient.displayMessageNoti(n); var i = $(".ChatUserNotSelected[chat-username='" + n + "']"); i.length > 0 && setTimeout(function () { i.removeClass("ChatUserSelected"), i.removeClass("chatisNew") }, openWSE_Config.animationSpeed), chatClient.notificationCleared = 1, document.title = chatClient.currTitle } } function CategoryClick(e, t) { CollapseAllAdminLinks(); var a = $("." + e + "-category-holder"); if (a.length > 0) { a.hasClass("show-category") ? ($(".app-icon-category-list[data-appid='" + e + "']").removeClass("show-category"), a.removeClass("show-category"), a.slideUp(openWSE_Config.animationSpeed, function () { a.addClass("hide-category") })) : (CollapseAllAppCategories(), $(".app-icon-category-list[data-appid='" + e + "']").addClass("show-category"), a.addClass("show-category"), a.slideDown(openWSE_Config.animationSpeed, function () { a.removeClass("hide-category") })); var o = ""; $(".app-icon-category-list.show-category").each(function () { o += $(this).attr("data-appid") + "~" }), o ? cookieFunctions.set("categories-expanded", o, 30) : cookieFunctions.del("categories-expanded") } } function CollapseAllAppCategories() { $(".app-icon-category-list.show-category").each(function () { var e = $(this).attr("data-appid"); $(".app-icon-category-list[data-appid='" + e + "']").removeClass("show-category"), $("." + e + "-category-holder").removeClass("show-category"), $("." + e + "-category-holder").slideUp(openWSE_Config.animationSpeed, function () { $("." + e + "-category-holder").addClass("hide-category") }) }), cookieFunctions.del("categories-expanded") } function LoadCategorySections() { $(".app-icon-category-list").length > 0 && $(".app-icon-category-list").each(function () { var e = $(this).attr("data-appid"); e && ($("." + e + "-category-holder").append($(".app-category-div." + e)), $(".app-category-div." + e).show()) }) } function LoadCategoryCookies() { LoadCategorySections(), cookieFunctions.get("categories-expanded", function (e) { if (e) for (var t = e.split("~"), a = 0; a < t.length; a++)if (t[a]) { $(".app-icon-category-list[data-appid='" + t[a] + "']").addClass("show-category"); var o = $("." + t[a] + "-category-holder"); o.addClass("show-category"), o.removeClass("hide-category"), o.show() } }) } jQuery.fn.outerHTML = function (e) { return e ? this.before(e).remove() : jQuery("<p>").append(this.eq(0).clone()).html() }, $(document.body).on("click", "#workspace-selector", function (e) { var t = $(this).find(".dropdown-db-selector"); if (t.length > 0 && !$(e.target).hasClass("workspace-selection-item") && !$(e.target).hasClass("workspace-selection-item-span") && !$(e.target).hasClass("app-preview-holder")) { for (var a = $("#workspace-selector").find(".workspace-menu-toggle > span").html(), o = 0; o < t.find(".workspace-selection-item").length; o++) { var n = t.find(".workspace-selection-item").eq(o); n.attr("data-number") == a ? n.addClass("selected") : n.removeClass("selected") } openWSE_Config.hoverPreviewWorkspace && $(".workspace-selection-item").hover(function () { var e = "#MainContent_" + openWSE.Getworkspace(), t = "#MainContent_workspace_" + $(this).attr("data-number"); e !== t && openWSE.HoverWorkspacePreview(e, t) }, function () { if ("block" == t.find("ul").css("display")) { var e = "#MainContent_workspace_" + $(this).attr("data-number"), a = "#MainContent_workspace_" + $("#workspace-selector").find(".workspace-menu-toggle > span").html(); e !== a && openWSE.HoverWorkspacePreview(e, a) } }), $("#ddl_WorkspaceSelector").addClass("active"), $("#ddl_WorkspaceSelector").parent().addClass("active") } }), $(document.body).on("click", ".workspace-selection-item", function () { var e = $("#workspace-selector").find(".workspace-menu-toggle > span").html(), t = $(this).attr("data-number"); if ($(".workspace-selection-item").removeClass("selected"), $(this).addClass("selected"), e != t) { if (openWSE.SetWorkspaceNumber(t), !openWSE_Config.hoverPreviewWorkspace) { var a = "#MainContent_workspace_" + e, o = "#MainContent_workspace_" + t; openWSE.HoverWorkspacePreview(a, o) } openWSE.AjaxCall(saveHandler + "/App_CurrentWorkspace", '{ "workspace": "' + t + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }') } CloseTopDropDowns() }); var previousWidth = 0, previousHeight = 0, resizeAxis = null, dragStart_Style3 = !1, optionsOpen_Style3 = !1; function ApplyAppDragResize() { if (openWSE.IsComplexWorkspaceMode()) { var e = ".app-body, .exit-button-app, .minimize-button-app, .maximize-button-app, .options-button-app, .app-maximized, .auto-full-page, .app-popup-inner-app, .app-head-style3"; "Style_3" != openWSE_Config.appStyle ? e += ", .app-head-button-holder" : "Style_3" == openWSE_Config.appStyle && ($(".app-main-style3 .app-head-hover-button").unbind("mouseenter"), $(".app-main-style3 .app-head-button-holder").unbind("mouseleave"), $(".app-main-style3 .app-head-hover-button").bind("mouseenter", function () { $(this).parent().find(".app-head-button-holder").show() }), $(".app-main-style3 .app-head-button-holder").bind("mouseleave", function () { dragStart_Style3 || optionsOpen_Style3 || $(this).parent().find(".app-head-button-holder").hide() }), $(document.body).on("click", ".move-button-app", function () { return !1 })), $(".app-main-holder").draggable({ scroll: !0, cancel: e, start: function (e, t) { CloseTopDropDowns(); var a = $(this); SetActiveApp(a), CreateDragSnapObjects(this), a.css("opacity", "0.6"), a.css("filter", "alpha(opacity=60)"), "Style_3" == openWSE_Config.appStyle && (a.find(".app-head-button-holder").show(), dragStart_Style3 = !0), $(".app-main-holder").each(function (e) { "block" == $(this).css("display") && ApplyOverlayFix(this) }), e.stopPropagation() } }).resizable({ handles: "se, s, e", minWidth: 150, minHeight: 150, create: function (e, t) { var a = $(this); a.hasClass("no-resize") && (!a.hasClass("app-main") || a.hasClass("auto-full-page") || a.hasClass("auto-full-page-min") ? a.hasClass("app-main") && (a.hasClass("auto-full-page") || a.hasClass("auto-full-page-min")) ? a.hasClass("auto-full-page-min") ? a.className = "app-main-holder app-main auto-full-page-min ui-draggable" : a.className = "app-main-holder app-main auto-full-page ui-draggable" : !a.hasClass("app-main-nobg") || a.hasClass("auto-full-page") || a.hasClass("auto-full-page-min") ? a.className = "app-main-holder app-main-nobg auto-full-page ui-draggable" : a.className = "app-main-holder app-main-nobg ui-draggable" : a.className = "app-main-holder app-main ui-draggable", a.find(".ui-resizable-handle").remove()) } }), openWSE_Config.appSnapHelper && $(".app-main-holder").draggable({ snap: ".app-snap-helper", snapped: function (e, t) { AddSnapHelperClass(t.snapElement) }, drag: function (e, t) { var a = $(this).data("ui-draggable"); $.each(a.snapElements, function (o, n) { n.snapping && a._trigger("snapped", e, $.extend({}, t, { snapElement: $(n.item) })) }) } }), "" != $("#hf_appContainer").val() && ($(".app-main-holder").draggable("option", "containment", $("#hf_appContainer").val()), $(".app-main-holder").resizable("option", "containment", "parent")), $(".app-main-holder").on("dragstop", function (e, t) { var a = $(this); "Style_3" == openWSE_Config.appStyle && (dragStart_Style3 = !1), a.css("opacity", "1.0"), a.css("filter", "alpha(opacity=100)"), this.offsetTop < 0 && a.animate({ top: 0 }, openWSE_Config.animationSpeed, function () { a.css("top", "0") }), this.offsetLeft < 0 && a.animate({ left: 0 }, openWSE_Config.animationSpeed, function () { a.css("left", "0") }); var o = a.find(".app-title").eq(0).text(), n = Getworkspace(), i = a.width(), r = a.height(); RemoveOverlayFix(this), openWSE.AjaxCall(saveHandler + "/App_Move", '{ "appId": "' + a.attr("data-appid") + '","name": "' + o + '","x": "' + a.css("left") + '","y": "' + a.css("top") + '","width": "' + i + '","height": "' + r + '","workspace": "' + n + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }') }), $(".app-main-holder").on("resize", function (e, t) { if (null != t) { var a = $(this); if (a.hasClass("no-resize")) a.css({ width: previousWidth, height: previousHeight }); else { var o = t.size.width, n = parseInt(a.css("min-width")); o < n && (o = n); var i = t.size.height, r = parseInt(a.css("min-height")); i < r && (i = r), a.css({ width: o, height: i }), previousWidth = o, previousHeight = i, ResizeSnapHelper(this, o, i) } ResizeAppBody(this) } }), $(".app-main-holder").on("resizestart", function (e, t) { if (resizingAppInProgress = !0, CloseTopDropDowns(), $(this).hasClass("app-maximized")) { $(this).removeClass("app-maximized"); var a = $(this).find(".maximize-button-app"); a.length > 0 && a.removeClass("active") } null != $(this).data("ui-resizable") && (resizeAxis = $(this).data("ui-resizable").axis), SetActiveApp(this), CreateDragSnapObjects(this), $(".app-main-holder").each(function (e) { "block" == $(this).css("display") && ApplyOverlayFix(this) }), e.stopPropagation() }), $(".app-main-holder").on("resizestop", function (e, t) { resizingAppInProgress = !1, $(this).hasClass("no-resize") || (ResizeAppBody(this), previousWidth = 0, previousHeight = 0, RemoveOverlayFix(this), openWSE.AjaxCall(saveHandler + "/App_Resize", '{ "appId": "' + $(this).attr("data-appid") + '","width": "' + t.size.width + '","height": "' + t.size.height + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }')) }) } } function ResizeSnapHelper(e, t, a) { if (openWSE_Config.appSnapHelper) for (var o = $(e), n = o.position().top, i = o.position().left, r = Getworkspace(), l = $("#MainContent_" + r), s = 0; s < l.find(".app-snap-helper").length; s++) { var d = l.find(".app-snap-helper").eq(s); if (ResizeSnapHelperLeftRight(e, d, i, t) || ResizeSnapHelperTopBottom(e, d, n, a)) { ResizeSnapHelperActive(e, d); break } } } function ResizeSnapHelperLeftRight(e, t, a, o) { var n = $(t).attr("data-type"), i = $(t).position().left, r = $(t).outerWidth(); if (!("se" != resizeAxis && "e" != resizeAxis || "left" != n && "right" != n)) { var l = a + o; if (l >= i + r - 10 && l <= i + r + 10) { var s = 1; if ("" != $(e).css("border")) { var d = $(e).css("border").split("px")[0]; (d = parseInt(d)) && "NaN" != d.toString() && (s = d - 2) } else if ("" != $(e).css("border-left")) { d = $(e).css("border-left").split("px")[0]; (d = parseInt(d)) && "NaN" != d.toString() && (s = d - 2) } return previousWidth -= l - (i + s), !0 } } return !1 } function ResizeSnapHelperTopBottom(e, t, a, o) { var n = $(t).attr("data-type"), i = $(t).position().top, r = $(t).outerHeight(); if (!("se" != resizeAxis && "s" != resizeAxis || "top" != n && "bottom" != n)) { var l = a + o; if (l >= i + r - 10 && l <= i + r + 10) { var s = 1; if ("" != $(e).css("border")) { var d = $(e).css("border").split("px")[0]; (d = parseInt(d)) && "NaN" != d.toString() && (s = d - 2) } else if ("" != $(e).css("border-top")) { d = $(e).css("border-top").split("px")[0]; (d = parseInt(d)) && "NaN" != d.toString() && (s = d - 2) } return previousHeight -= l - (i + s), !0 } } return !1 } function ResizeSnapHelperActive(e, t) { AddSnapHelperClass(t), $(e).addClass("no-resize"), setTimeout(function () { $(e).removeClass("no-resize") }, 200) } function ReloadApp(e) { $(e).closest(".app-head-button-holder").parent().find(".app-title").eq(0).text(); var t = $(e).closest(".app-head-button-holder").parent(), a = t.attr("data-appid"); ResizeAppBody(t), $(".app-main-holder").css("z-index", "1000"), t.css("z-index", "3000"); var o = t.find(".options-button-app"), n = o.parent(); if (o.removeClass("active"), n.find(".app-popup-inner-app").hide(), "Style_3" == openWSE_Config.appStyle && (n.find(".app-head-button-holder").hide(), optionsOpen_Style3 = !1), $("." + (a + outsideAppModal)).each(function () { $(this).remove() }), t.find(".iFrame-apps").length > 0) { var i = t.find(".iFrame-apps")[0]; if (null != i.src) { var r = i.src; i.src = "", setTimeout(function () { i.src = r, null == t.find(".app-body").find("div").html() ? (t.find(".app-body").find(".loading-background-holder").length <= 0 && AppendLoadingMessage(t.find(".app-body")), t.find(".iFrame-apps").one("load", function () { t.find(".app-body").find(".loading-background-holder").each(function () { $(this).remove() }) })) : (t.find(".app-body").find("div").find(".loading-background-holder").length <= 0 && AppendLoadingMessage(t.find(".app-body").find("div")), t.find(".iFrame-apps").one("load", function () { t.find(".app-body").find("div").find(".loading-background-holder").each(function () { $(this).remove() }) })) }, 100) } } else $("#MainContent_" + a.replace(/-/g, "_") + "_advPanel").length > 0 && $("#MainContent_" + a.replace(/-/g, "_") + "_advPanel").hide(), t.find(".app-body").find(".loading-background-holder").length <= 0 && AppendLoadingMessage(t.find(".app-body")), $("#hf_ReloadApp").val(a), openWSE.CallDoPostBack("hf_ReloadApp", "") } function AboutApp(e) { var t = $(e).closest(".app-head-button-holder").parent(); 0 === t.length && (t = $(e)); var a = t.attr("data-appid"); $("#hf_aboutstatsapp").val("about;" + a); var o = t.find(".options-button-app"), n = o.parent(); o.removeClass("active"), n.find(".app-popup-inner-app").hide(), "Style_3" == openWSE_Config.appStyle && (n.find(".app-head-button-holder").hide(), optionsOpen_Style3 = !1), $("#MainContent_pnl_aboutHolder").html(""), loadingPopup.Message("Loading. Please Wait..."), openWSE.CallDoPostBack("hf_aboutstatsapp", "") } function UninstallApp(e) { openWSE.ConfirmWindow("Are you sure you want to remove this app?", function () { $("#hf_aboutstatsapp").val("uninstall;" + e), $(".app-main-holder[data-appid='" + e + "']").find(".exit-button-app").trigger("click"), $(".app-main-holder[data-appid='" + e + "']").remove(), loadingPopup.Message("Removing App"), openWSE.CallDoPostBack("hf_aboutstatsapp", "") }, null) } function PopOutFrame(e, t) { var a = $(e).closest(".app-head-button-holder").parent(), o = 315, n = 425; if (a.length > 0) { var i = a.find(".app-title").eq(0).text(); o = a.width(), n = a.height() } a.fadeOut(openWSE_Config.animationSpeed, function () { a.hasClass("app-maximized") && a.removeClass("app-maximized"), RemoveworkspaceAppNum(a), RemoveAppIconActive(a); var e = 1; null != document.getElementById("hf_" + a.attr("id")) && (e = 0), null == a.find(".app-body").find("div").html() ? 1 == e && a.find(".app-body").html("") : 1 == e && a.find(".app-body").find("div").html(""), a.css({ visibility: "hidden", left: "", top: "", width: "", height: "" }), a.find(".options-button-app").length > 0 && (a.find(".options-button-app").removeClass("active"), a.find(".app-popup-inner-app").hide(), "Style_3" == openWSE_Config.appStyle && (a.find(".app-head-button-holder").hide(), optionsOpen_Style3 = !1)), openWSE.AjaxCall(saveHandler + "/App_Close", '{ "appId": "' + a.attr("data-appid") + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }') }); var r = "width=" + o + "px,height=" + n + "px,location=no,menubar=no,toolbar=no,status=no,resizable=yes,scrollbars=yes"; myWindow = window.open(t, i, r), myWindow.focus() } function PopOutFrameFromSiteTools(e, t) { myWindow = window.open(t, e, "width=400px,height=400px,location=no,menubar=no,toolbar=no,status=no,resizable=yes,scrollbars=yes"), myWindow.focus(), openWSE.LoadModalWindow(!1, "ConfirmApp-element", ""), $("#ConfirmApp-element").remove() } function PopOutTool(e) { window.location.href = e } function MoveAppToworkspace(e) { var t = ""; if ("" != (t = $(e).length > 0 ? $(e).hasClass("app-popup-selector") || $(e).hasClass("app-options-workspace-switch") ? $.trim($(e).val()) : $.trim($(e).text()) : e) && "-" != t) { SetWorkspaceNumber(t); var a = t; t = "workspace_" + t; var o = Getworkspace(); $_name = $(e).closest(".app-icon"), 0 == $_name.length && ($_name = $(e).closest(".app-head-button-holder").parent()); var n = 0, i = $_name.attr("data-appid"); "" != i && null != i && null != i && (AddworkspaceAppNum(t, i), "block" == $("#" + i).css("display") && (n = 1)), (o != t || 0 == n || 1 == n && o == t) && (openWSE.AjaxCall(saveHandler + "/App_CurrentWorkspace", '{ "workspace": "' + a + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }'), LoadApp($_name, t), o != t && (_id = "#MainContent_" + t, $("#workspace_holder .workspace-holder").each(function () { "visible" == $(this).css("visibility") && (!openWSE_Config.taskBarShowAll && openWSE.ConvertBitToBoolean($("#minimized_app_bar").attr("data-show")) && $("#minimized_app_bar").hide(), $(this).fadeTo(openWSE_Config.animationSpeed, 0, function () { MoveOffScreen(this), openWSE_Config.taskBarShowAll || (HideTasks(this), ShowTasks(_id)) })) }), $(_id).fadeTo(openWSE_Config.animationSpeed, 1), MoveOnScreen_WorkspaceOnly($(_id)), ResizeAllAppBody($(_id)), MoveOutSideModalWindowToWorkspace(i), $(".app-options").css("visibility", "hidden"), setTimeout(function () { $(".app-popup").hide() }, openWSE_Config.animationSpeed))) } } function ReapplyActiveIcons() { $(".app-main-holder").each(function () { if ("block" == $(this).css("display")) { SetAppIconActive(this); var e = $(this).parent().attr("id"); null != e && null != e && "" != e && AddworkspaceAppNum(e, $(this).attr("data-appid")) } }) } function AppendLoadingMessage(e) { $(e).append(loadingMessage); var t = $(e).closest(".app-main-holder"); if (t.length > 0) { var a = $(".app-icon[data-appid='" + t.attr("data-appid") + "']"); a.length > 0 && a.find("img").length > 0 && "none" != a.find("img").css("display") && !a.find("img").hasClass("display-none") && ($(e).find(".loading-background-holder").css("background-image", "url('" + a.find("img").attr("src") + "')"), $(e).find(".loading-background-holder").attr("data-usespinner", "false")) } } function CreateDragSnapObjects(e) { if (openWSE_Config.appSnapHelper && (RemoveSnapHelperClass(e), null != e)) { var t = $(e).data("ui-draggable"), a = Getworkspace(), o = $("#MainContent_" + a); o.length > 0 && o.find(".app-main-holder").each(function () { if (!$(this).hasClass("app-maximized") && !$(this).hasClass("auto-full-page")) { var a = $(this).attr("data-appid"); if ("block" == $(this).css("display") && "hidden" != $(this).css("visibility") && $(e).attr("data-appid") != a && 0 == $(".app-snap-helper[data-appid='" + a + "']").length) { var n = GetBorderWidthForHelper(this, "left", 0, 0), i = GetBorderWidthForHelper(this, "right", 0, 0), r = GetBorderWidthForHelper(this, "top", 0, 0), l = GetBorderWidthForHelper(this, "bottom", 0, 0), s = parseInt($(this).css("left").replace("px", "")) + (n - 1), d = s + $(this).outerWidth() - (i + n) + 1, p = parseInt($(this).css("top").replace("px", "")) + (r - 1), c = p + $(this).outerHeight() - (l + r) + 1; o.append("<div class='app-snap-helper' data-appid='" + a + "' data-type='left' style='left: " + s + "px; top: 0; bottom: 0; width: 1px;'></div>"), o.append("<div class='app-snap-helper' data-appid='" + a + "' data-type='right' style='left: " + d + "px; top: 0; bottom: 0; width: 1px;'></div>"), o.append("<div class='app-snap-helper' data-appid='" + a + "' data-type='top' style='top: " + p + "px; left: 0; right: 0; height: 1px;'></div>"), o.append("<div class='app-snap-helper' data-appid='" + a + "' data-type='bottom' style='top: " + c + "px; left: 0; right: 0; height: 1px;'></div>"), t && AddItemToSnapElements(a, s, d, p, c, t) } } }) } } function AddItemToSnapElements(e, t, a, o, n, i) { var r = $(".app-main-holder[data-appid='" + e + "']"), l = GetBorderWidthForHelper(r, "left", -1, 1), s = GetBorderWidthForHelper(r, "right", -1, -1), d = GetBorderWidthForHelper(r, "top", -1, 1), p = GetBorderWidthForHelper(r, "bottom", -1, -1), c = { height: $(".app-snap-helper[data-appid='" + e + "'][data-type='left']").height(), item: $(".app-snap-helper[data-appid='" + e + "'][data-type='left']")[0], left: t + $("#main_container").position().left + l, snapping: !1, top: $("#top_bar").outerHeight(), width: 1 }, u = { height: $(".app-snap-helper[data-appid='" + e + "'][data-type='right']").height(), item: $(".app-snap-helper[data-appid='" + e + "'][data-type='right']")[0], left: a + $("#main_container").position().left + s, snapping: !1, top: $("#top_bar").outerHeight(), width: 1 }, h = { height: 1, item: $(".app-snap-helper[data-appid='" + e + "'][data-type='top']")[0], left: $("#main_container").position().left, snapping: !1, top: o + $("#top_bar").outerHeight() + d, width: $(".app-snap-helper[data-appid='" + e + "'][data-type='top']").width() }, f = { height: 1, item: $(".app-snap-helper[data-appid='" + e + "'][data-type='bottom']")[0], left: $("#main_container").position().left, snapping: !1, top: n + $("#top_bar").outerHeight() + p, width: $(".app-snap-helper[data-appid='" + e + "'][data-type='bottom']").width() }; i.snapElements.push(c), i.snapElements.push(u), i.snapElements.push(h), i.snapElements.push(f) } function AddSnapHelperClass(e) { e && ($(e).addClass("app-snap-helper-highlight"), setTimeout(function () { $(e).removeClass("app-snap-helper-highlight") }, 1500)) } function RemoveSnapHelperClass(e) { var t = $(e).data("ui-draggable"); t && (t.snapElements = new Array), $(".app-snap-helper").remove() } function GetBorderWidthForHelper(e, t, a, o) { var n = $(e); if (n.length > 0) if ("" != n.css("border")) { var i = n.css("border").split("px")[0]; if ((i = parseInt(i)) && "NaN" != i.toString()) return i + a } else if ("" != n.css("border-" + t)) { i = n.css("border-" + t).split("px")[0]; if ((i = parseInt(i)) && "NaN" != i.toString()) return i + a } return o } function GroupLoginModal() { $("#group_tab").hasClass("active") ? $("#group_tab").find("#grouplistdiv").html("") : GetandBuildGroupList() } function GetandBuildGroupList() { var e = $("#group_tab").find("#grouplistdiv"); 0 === e.length && $("#pnlContent_Groups").length > 0 && (e = $("#pnlContent_Groups").find("#grouplistdiv")), e.html("<div class='pad-all'>Loading groups...</div>"), $("#divGroupLogoff").hide(), openWSE.AjaxCall("WebServices/AcctSettings.asmx/GetUserGroups", "{ }", null, function (t) { var a = ""; try { for (var o = 0; o < t.d[0].length; o++) { var n = t.d[0][o][0], i = t.d[0][o][1], r = t.d[0][o][2], l = t.d[0][o][3], s = t.d[0][o][4], d = t.d[0][o][5]; a += "<div class='group-selection-entry' onclick='openWSE.LoginAsGroup(\"" + n + "\")' title='Click to login' " + ("style=\"background: url('" + s + "'); background-size: cover;\"") + ">", a += "<div class='overlay'></div>", a += "<div class='group-selection-info'>", a += "<img class='group-img' alt='Group Logo' src='" + r + "' />", a += "<div class='group-name-info'>", a += "<span class='group-name'>" + i + "</span><div class='clear-space-five'></div>", a += "<span class='group-info'><b class='pad-right-sml'>Owner:</b>" + l + "</span>", a += "</div><div class='clear'></div>"; for (var p = "<div class='group-selection-applist'>", c = 0; c < d.length; c++)p += "<div class='group-applist-item'>", p += "<img alt='' src='" + GetSiteRoot() + d[c].Icon + "' />", p += "<span>" + d[c].AppName + "</span>", p += "<div class='clear'></div></div>"; a += p += "</div><div class='clear'></div>", a += "</div></div>" } a += "<div class='clear'></div>" } catch (e) { } t.d[2] && (a += '<div class="clear"></div><h3 class="pad-all">You are currently logged into ' + t.d[2] + '</h3><div class="clear"></div>', $("#divGroupLogoff").show()), e.html(a), openWSE.ResizeTopDropDowns() }) } function LoginAsGroup(e) { "" != e ? loadingPopup.Message("Logging into Group") : loadingPopup.Message("Logging out of Group"), CloseTopDropDowns(), openWSE.AjaxCall("WebServices/AcctSettings.asmx/LoginUnderGroup", '{ "id": "' + e + '" }', null, function (t) { "true" == t.d ? location.reload() : -1 !== window.location.href.toLowerCase().indexOf("appremote.aspx") ? window.location.href = "AppRemote.aspx?group=" + e : window.location.href = "Login.aspx?group=" + e }) } function CloseGroupLoginModal() { -1 === window.location.href.toLowerCase().indexOf("appremote.aspx") && $("#group_tab").find("#grouplistdiv").html("") } function HashChange() { var e = location.hash; -1 != e.indexOf("iframecontent") && openWSE.LoadIFrameContentHistory(getUrlParameterByName("iframecontent")), -1 == e.indexOf("help") ? (-1 === e.indexOf("iframecontent") && $("#iframe-container-helper").length > 0 && openWSE.CloseIFrameContent(), "block" == $("#help_main_holder").css("display") && CloseHelpOverlay()) : HelpOverlayHistory() } function getUrlParameterByName(e, t) { e = e.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]"); var a = new RegExp("[\\?&]" + e + "=([^&#]*)"), o = window.location.href.replace("#", ""); t && (o = t.replace("#", "")); var n = a.exec(o); return null == n ? "" : decodeURIComponent(n[1].replace(/\+/g, " ")) } function AddUrlHashQueryPath(e, t) { var a = "", o = ""; isMobileMode && "iframecontent" === e && openWSE.CloseTopDropDowns(), -1 === window.location.href.indexOf(e) ? (a = e + "=" + escape(t), -1 === (o = window.location.href.replace("?" + a, "").replace("&" + a, "")).indexOf("#") && (o += "#"), -1 !== o.indexOf("#?") ? o += "&" + a : -1 === o.indexOf("&") ? o += "?" + a : o += "&" + a, window.location.href = o) : (a = e + "=" + escape(getUrlParameterByName(e)), o = window.location.href.replace("?" + a, "").replace("&" + a, ""), a = e + "=" + escape(t), -1 === o.indexOf("#") && (o += "#"), -1 !== o.indexOf("#?") ? o += "&" + a : -1 === o.indexOf("&") ? o += "?" + a : o += "&" + a, window.location.href = o) } function RemoveUrlHashQueryPath(e) { if (-1 !== window.location.href.indexOf(e)) { var t = e + "=" + getUrlParameterByName(e); -1 === window.location.href.indexOf(t) && (t = e + "=" + escape(getUrlParameterByName(e))), window.location.href = window.location.href.replace("?" + t, "").replace("&" + t, "") } } function loadCSS(e) { var t = openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/" + e; $("link[href='" + t + "']").remove(); var a = document.getElementsByTagName("head")[0]; link = document.createElement("link"), link.type = "text/css", link.rel = "stylesheet", link.href = t, a.appendChild(link) } function unloadCSS(e) { var t = openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/" + e; $("link[href='" + t + "']").remove() } function LoadViewPort() { if (isMobileDevice()) { if (0 == $("#mobileViewport").length) { var e = document.getElementsByTagName("head")[0]; meta = document.createElement("meta"), meta.name = "viewport", meta.id = "mobileViewport", meta.content = "initial-scale=1.0, user-scalable=no", e.appendChild(meta) } $(document).tooltip({ disabled: !0 }) } else $("#mobileViewport").length > 0 && $("#mobileViewport").remove() } function AcceptGroupNotification(e, t) { if (!openWSE_Config.demoMode) { loadingPopup.Message("Accepting. Please Wait..."); var a = $(e).closest("tr"), o = a.attr("id"); openWSE.AjaxCall("WebServices/NotificationRetrieve.asmx/AcceptInviteNotifications", '{ "id": "' + o + '", "groupId": "' + t + '" }', null, function (e) { openWSE.ConvertBitToBoolean(e.d) && a.fadeOut(openWSE_Config.animationSpeed, function () { if (loadingPopup.RemoveMessage(), a.remove(), "1" == $("#lbl_notifications").find("span").html()) ResetNoti(); else { var e = parseInt($("#lbl_notifications").find("span").html()); e -= 1, $("#lbl_notifications").html("<span>" + e + "</span>") } }) }) } } function MobileMode() { isMobileMode = !0, -1 == window.location.href.indexOf("?mobileMode=true#?tab=pnl_IconSelector") ? $("#lnk_BackToWorkspace").attr("href", GetSiteRoot() + "AppRemote.aspx#?id=adminPages&category=pageSelect") : $("#lnk_BackToWorkspace").attr("href", GetSiteRoot() + "AppRemote.aspx#"), $(".my-app-remote-link").remove(), $(".sitemenu-selection").addClass("mobile-mode"), $("#hyp_accountSettings").attr("href", $("#hyp_accountSettings").attr("href") + "?mobileMode=true"), $("#footer-signdate").prepend("<a href='" + GetSiteRoot() + "AppRemote.aspx'>Home</a>"); var e = !1, t = getParameterByName("noHeader"); t && "true" == t && (e = !0), e ? $("#workspace-selector").find("#lnk_BackToWorkspace").hide() : $("#workspace-selector").find("#lnk_BackToWorkspace").attr("onclick", "loadingPopup.Message('Loading...');return true;"), $("#MainContent_pnlLinkBtns").length > 0 && $("#MainContent_pnlLinkBtns").find("a").each(function () { var t = $(this).attr("href"); -1 == t.indexOf("#?") && (-1 == t.indexOf("?") ? t += "?mobileMode=true" : t += "&mobileMode=true", e && (t += "&noHeader=true"), -1 !== window.location.href.toLowerCase().indexOf("appremote.aspx") && (t += "&fromAppRemote=true"), $(this).attr("href", t)) }), $("#user_profile_tab").length > 0 && ($(".close-iframe").length > 0 ? $(".close-iframe").before($("#user_profile_tab")) : $(".iframe-title-top-bar").after($("#user_profile_tab"))), ResizeContainer() } function GetCurrentPage() { $(".app-icon-links").removeClass("active"), $(".app-icon-sub-links").removeClass("active"); var e = null; $(".app-icon-links").each(function () { if ($(this).attr("href")) { var t = $(this).attr("href").toLowerCase(); if (CheckIfOnWorkspace() && -1 != t.indexOf("default.aspx")) $(this).addClass("active"); else if (-1 != window.location.href.toLowerCase().indexOf(t) && ($(this).addClass("active"), $(this).hasClass("has-sub-links") && (e = $(this)), $(this).next().hasClass("app-icon-sub-link-holder"))) { $(this).next().show(), $(this).addClass("expanded-links"); var a = $(this).find(".img-expand-sml"); 1 == a.length && (a.removeClass("img-expand-sml"), a.addClass("img-collapse-sml")) } } }); var t = !1; $(".app-icon-sub-links").each(function () { var e = $(this).attr("href").toLowerCase(), a = window.location.href.toLowerCase(); if (e.indexOf("#?tab=") >= 0 && -1 === a.indexOf("#?tab=") && (a = a.replace("?tab=", "#?tab=")), 3 === a.split("?tab=").length) { var o = a.split("?tab="); a = ""; for (var n = 0; n < o.length; n++)o[n].indexOf("#") !== o[n].length - 1 && (a += o[n], 0 === n && (a += "#?tab=")) } if (-1 != a.indexOf(e)) { $(".app-icon-links").removeClass("active"), $(this).addClass("active"), $(this).parent().show(); var i = $(this).parent().prev().find(".img-expand-sml"); 1 == i.length && (i.removeClass("img-expand-sml"), i.addClass("img-collapse-sml")), t = !0 } }), null != e && e.length > 0 && !t ? e.next().find(".app-icon-sub-links").eq(0).addClass("active") : null != e && e.length > 0 && t && e.addClass("active") } function ResizeContainer() { resizingAppInProgress || $(".app-snap-helper").remove(), 0 === $("#sidebar_container").length && ($("#main_container").css("left", "0"), $("#footer_container").css("left", "0")) } function ExpandAdminLinks(e) { if (CollapseAllAppCategories(), $("#sidebar_container").hasClass("sidebar-minimized")) return !0; var t = $(e).attr("data-subdiv"), a = $(e).find(".expand-collapse-btn"); return $(e).hasClass("expanded-links") ? ($(e).removeClass("expanded-links"), a.closest(".app-icon-links").parent().find("." + t).slideUp(openWSE_Config.animationSpeed)) : (CollapseAllAdminLinks(), $(e).addClass("expanded-links"), a.closest(".app-icon-links").parent().find("." + t).slideDown(openWSE_Config.animationSpeed, function () { $(e).offset().top + a.closest(".app-icon-links").parent().find("." + t).outerHeight() > $("#sidebar_container").outerHeight() && (openWSE.SetLeftSidebarScrollTop(a.closest(".app-icon-links").parent().find("." + t).outerHeight() + 20), openWSE.InitializeSlimScroll()) })), !1 } function CollapseAllAdminLinks() { $(".has-sub-links").each(function () { $(this).removeClass("expanded-links"), $(this).find(".expand-collapse-btn").closest(".app-icon-links").parent().find("." + $(this).attr("data-subdiv")).slideUp(openWSE_Config.animationSpeed) }) } function GetSiteRoot() { var e = ""; return "" != openWSE_Config.siteRootFolder && (e = openWSE_Config.siteRootFolder + "/"), window.location.protocol + "//" + window.location.host + "/" + e } function GetElementClassList(e) { return 1 == $(e).length ? $(e)[0].className.split(/\s+/) : new Array } function ShowHideAccordianSidebar() { $("#main_container").hasClass("sidebar-minimized") ? (ShowSidebar(), openWSE_Config.demoMode ? cookieFunctions.del("sidebar-menu") : (loadingPopup.Message("Updating..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/SetSidebarContainerState", "{ 'state': '' }", null, null, null, function (e) { loadingPopup.RemoveMessage() }))) : (HideSidebar(), openWSE_Config.demoMode ? cookieFunctions.set("sidebar-menu", "hide", 30) : (loadingPopup.Message("Updating..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/SetSidebarContainerState", "{ 'state': 'hide' }", null, null, null, function (e) { loadingPopup.RemoveMessage() }))), $(window).resize() } function ShowSidebar() { $("#sidebar_container").removeClass("sidebar-minimized"), $("#sidebar_container").parent().hasClass("slimScrollDiv") && $("#sidebar_container").parent().removeClass("sidebar-minimized"), $("#main_container, #footer_container, #top_bar").removeClass("sidebar-minimized"), "true" === $("#sidebar_accordian").attr("data-icononly") ? $("#sidebar_accordian").find(".app-icon-links").each(function () { var e = $.trim($(this).find(".app-icon-font").attr("data-pagetitle")); e && $(this).attr("title", e) }) : $("#sidebar_accordian").find(".app-icon-links").each(function () { $(this).attr("title", "") }), $("#updatePnl_AppList").find(".app-icon > img").each(function () { $(this).attr("title", "") }) } function HideSidebar() { $("#sidebar_container").addClass("sidebar-minimized"), $("#sidebar_container").parent().hasClass("slimScrollDiv") && $("#sidebar_container").parent().addClass("sidebar-minimized"), $("#main_container, #footer_container, #top_bar").addClass("sidebar-minimized"), $("#sidebar_accordian").find(".app-icon-links").each(function () { var e = $.trim($(this).find(".app-icon-font").attr("data-pagetitle")); e && $(this).attr("title", e) }), $("#updatePnl_AppList").find(".app-icon > img").each(function () { var e = $.trim($(this).parent().find(".app-icon-font").html()); e && $(this).attr("title", e) }) } function LoadSidebarShowHideCookie() { openWSE_Config.demoMode && $("#sidebar_container").is(":visible") && cookieFunctions.get("sidebar-menu", function (e) { e && "hide" == e && (HideSidebar(), $(window).resize()) }) } function SidebarNavToggleInit() { if (openWSE_Config.allowNavMenuCollapseToggle && $(".sidebar-linkpanels").length > 0) { var e = ""; $("#lbl_UserFullName").length > 0 && (e = "-" + $.trim($("#lbl_UserFullName").html()).toLowerCase()), cookieFunctions.get("sidebar-navtitle-expanded" + e, function (e) { e && (e = e.split("~")), $(".nav-title-toggle-btn").remove(), $(".sidebar-linkpanels").each(function () { $(this).find(".nav-title").each(function () { var t = $(this).text(); $(this).find("a").length > 0 && (t = t.replace($.trim($(this).find("a").html()), "")); t = $.trim(t); var a = !1; if (e) for (var o = 0; o < e.length; o++)if (e[o] === t) { a = !0; break } $(this).prepend('<span title="Toggle menu" class="nav-title-toggle-btn" data-title="' + escape(t) + '"></span>'), $(this).attr("onclick", "return openWSE.SidebarNavToggleClicked(this, true, event);"), $(this).addClass("cursor-pointer"), SidebarNavToggleCollapseIndividual(!1, this), a && openWSE.SidebarNavToggleClicked(this, !1, null) }) }) }) } } function SidebarNavToggleClicked(e, t, a) { if (openWSE_Config.allowNavMenuCollapseToggle && $(".sidebar-linkpanels").length > 0) { if (a && !$(a.target).hasClass("nav-title-toggle-btn") && !$(a.target).hasClass("nav-title")) return !0; var o = $(e).find(".nav-title-toggle-btn").eq(0); if (o.hasClass("expanded")) SidebarNavToggleCollapseIndividual(t, e); else { openWSE_Config.allowNavMenuCollapseToggleOnlyOne && SidebarNavToggleCollapseAll(t, e), $(e).addClass("nav-title-active"), o.addClass("expanded"); var n = o.parent().next("div"); "statusDiv" === n.attr("id") ? t ? (n.slideDown(openWSE_Config.animationSpeed), o.parent().parent().find("#chatuserlist").slideDown(openWSE_Config.animationSpeed)) : (n.show(), o.parent().parent().find("#chatuserlist").show()) : t ? n.slideDown(openWSE_Config.animationSpeed) : n.show() } if (t) { var i = ""; $(".sidebar-linkpanels").each(function () { $(this).find(".nav-title").each(function () { var e = $(this).find(".nav-title-toggle-btn").attr("data-title"); $(this).find(".nav-title-toggle-btn").hasClass("expanded") && e && (i += unescape(e) + "~") }) }); var r = ""; $("#lbl_UserFullName").length > 0 && (r = "-" + $.trim($("#lbl_UserFullName").html()).toLowerCase()), i ? cookieFunctions.set("sidebar-navtitle-expanded" + r, i, 30) : cookieFunctions.del("sidebar-navtitle-expanded" + r) } return !1 } return !0 } function SidebarNavToggleCollapseAll(e) { $(".sidebar-linkpanels").each(function () { $(this).find(".nav-title").each(function () { SidebarNavToggleCollapseIndividual(e, this) }) }) } function SidebarNavToggleCollapseIndividual(e, t) { $(t).removeClass("nav-title-active"); var a = $(t).find(".nav-title-toggle-btn").eq(0); a.removeClass("expanded"); var o = a.parent().next("div"); e ? o.slideUp(openWSE_Config.animationSpeed) : o.hide(), o.addClass("nav-title-toggle-padding") } function ReloadPage() { try { window.parent.location.reload() } catch (e) { window.location.reload() } } function ApplyMobileModeForMenuBar() { if ((location.href.toLowerCase().indexOf("sitetools/") > 0 || location.href.toLowerCase().indexOf("about.aspx") > 0) && (-1 == location.href.toLowerCase().indexOf("appremote.aspx") || location.href.toLowerCase().indexOf("redirect=appremote.aspx") > 0) && $(".sitemenu-selection").length > 0) { $(".sitemenu-selection").removeClass("mobile-mode"); var e = 0, t = 0; $(".sitemenu-selection").find("li").each(function () { e += $(this).outerWidth(), $(this).outerWidth() > t && (t = $(this).outerWidth()) }), e += t, $("#main_container").length > 0 ? $("#main_container").outerWidth() < e && $(".sitemenu-selection").addClass("mobile-mode") : $("body").outerWidth() < e && $(".sitemenu-selection").addClass("mobile-mode") } } function ChangeUserProfileImage() { var e = "<div id='UserProfileImageUpdate-element' class='Modal-element'>"; e += "<div class='Modal-overlay'>", e += "<div class='Modal-element-align'>", e += "<div class='Modal-element-modal' data-setwidth='520px'>", e += "<div class='ModalHeader'><div>", e += "<div class='app-head-button-holder-admin'>", e += "<a href='#' onclick=\"openWSE.LoadModalWindow(false, 'UserProfileImageUpdate-element', ''); setTimeout(function () { $('#UserProfileImageUpdate-element').remove(); }, 100); return false;\" class='ModalExitButton'></a>", e += "</div><span class='Modal-title'></span></div></div>", e += "<div class='ModalScrollContent'>", e += "<div class='ModalPadContent'>", e += "<h3 id='UserProfileImageUpload_loading' class='pad-all'>Loading. Please Wait...</h3>", e += "<iframe id='UserProfileImageUpload_frame' src='" + GetSiteRoot() + "SiteTools/iframes/UserProfileImageUpload.aspx' frameborder='0' style='visibility: hidden;' />", e += "</div></div>", e += "<div class='ModalButtonHolder'><input type='button' class='input-buttons no-margin' value='Close' onclick=\"openWSE.LoadModalWindow(false, 'UserProfileImageUpdate-element', ''); setTimeout(function () { $('#UserProfileImageUpdate-element').remove(); }, 100); return false;\" /></div>", e += "</div></div></div></div>", $("#UserProfileImageUpdate-element").length > 0 && $("#UserProfileImageUpdate-element").remove(), $("body").append(e), $("#UserProfileImageUpload_frame").one("load", function () { $("#UserProfileImageUpdate-element").find("#UserProfileImageUpload_loading").remove(), $("#UserProfileImageUpload_frame").css({ visibility: "visible" }) }), LoadModalWindow(!0, "UserProfileImageUpdate-element", "Update Profile Image"), CloseTopDropDowns() } function GetScriptFunction(e, t) { if (e && 0 == $("head").find("script[src='" + e + "']").length) { var a = document.createElement("script"); a.type = "text/javascript", t && "function" == typeof t && (a.onload = function () { window.setTimeout(function () { t() }, 1) }), a.src = e, document.getElementsByTagName("head")[0].appendChild(a) } else if (t && "function" == typeof t) try { window.setTimeout(function () { try { t() } catch (e) { } }, 500) } catch (t) { openWSE.AlertWindow(t.message, e) } } function InitializeSiteMenuTabs() { var e = !1; "true" === $("#MainContent_pnlLinkBtns").attr("data-overwriteevent") && (e = !0), $(".sitemenu-selection").length > 0 && ($(".pnl-section").length > 0 || e) ? (ValidateSiteTabLinks(), e ? $(".sitemenu-selection").find("li").on("click", function () { loadingPopup.Message("Loading Tab...") }) : (openWSE.LoadSiteMenuTab("" == window.location.href ? "1" : window.location.href), $(".sitemenu-selection").find("li").on("click", function () { if (openWSE.LoadSiteMenuTab($(this).find("a").attr("href")), openWSE.ConvertBitToBoolean($(this).closest(".sitemenu-selection").attr("data-nohrefupdate"))) return !1 }), $(window).hashchange(function () { var e = window.location.href; openWSE.LoadSiteMenuTab("" == e ? "1" : e) }))) : $("#MainContent_pnlLinkBtns").length > 0 ? $("#MainContent_pnlLinkBtns").hide() : $(".sitemenu-selection").length > 0 && $(".sitemenu-selection").hide() } function ValidateSiteTabLinks() { if (1 == $(".pnl-section").length) (0 == $(".sitemenu-selection").length || "MainContent_pnlLinkBtns" == $(".sitemenu-selection").parent().attr("id")) && $("#MainContent_pnlLinkBtns").length > 0 ? $("#MainContent_pnlLinkBtns").hide() : $(".sitemenu-selection").hide(); else { var e = new Array; $(".sitemenu-selection").find("li").each(function (t) { if ($(this).find("a").length > 0) { var a = $(this).find("a").attr("href").replace("#?tab=", ""); -1 == a.toLowerCase().indexOf("appmanager.aspx") && (-1 != a.indexOf("&") && (a = a.replace(a.substring(a.indexOf("&")), "")), a && 0 === $("#" + a).length && e.push(t)) } }); for (var t = e.length - 1; t >= 0; t--)$(".sitemenu-selection").find("li").eq(e[t]).remove() } } function LoadSiteMenuTab(e) { $(".pnl-section").hide(), $(".sitemenu-selection").find("li").removeClass("active"); var t = getUrlParameterByName("tab", e); if (t || (t = getParameterByName("tab")), t.indexOf("?tab=") > 0) (a = t.split("?tab=")).length > 0 && (t = a[a.length - 1]); else if (t.indexOf("&tab=") > 0) { var a; (a = t.split("&tab=")).length > 0 && (t = a[a.length - 1]) } var o = GetPnlSectionIndex(t); o < 0 && (o = 0), CollapseAllAppCategories(), $(".has-sub-links").each(function () { $(this).removeClass("expanded-links"), $(this).find(".expand-collapse-btn").closest(".app-icon-links").parent().find("." + $(this).attr("data-subdiv")).hide() }), $(".pnl-section").eq(o).show(), $(".sitemenu-selection").find("li").eq(o).addClass("active"), GetCurrentPage() } function GetPnlSectionIndex(e) { -1 != e.indexOf("&") && (e = e.replace(e.substring(e.indexOf("&")), "")), 0 == $(".pnl-section[id='" + e + "']").length && (e = "pnl_" + e); for (var t = 0; t < $(".pnl-section").length; t++)if ($(".pnl-section").eq(t).attr("id") === e) return t; return 0 } function ScrollToElement(e, t) { setTimeout(function () { if (-1 == e.indexOf("#") && -1 == e.indexOf(".") && (e = "#" + e), $(e).length > 0) { var a = $("#main_container"); 0 === a.length && (a = $("body")); var o = $(e).offset().top; o > $(e).outerHeight() && (o -= $(e).outerHeight()), t ? a.animate({ scrollTop: o }, openWSE_Config.animationSpeed) : a.scrollTop(o) } }, 100) } var TableFormulas = function () { var e = { sum: function (e) { for (var t = 0, a = 0; a < e.length; a++)t += e[a]; return +t.toFixed(2) }, min: function (e) { return Math.min.apply(null, e) }, max: function (e) { return Math.max.apply(null, e) }, average: function (e) { for (var t = 0, a = 0; a < e.length; a++)t += e[a]; return +(t /= e.length).toFixed(2) } }; function t(e, t, n, i) { var r = !0; if (n.columnName && n.conditions && n.conditions.length > 0) { var l = $(e).find(".data-td[data-columnname='" + n.columnName + "']"); if (t && (l = $(e).find(".headerName[data-columnname='" + n.columnName + "']").parent().find(".data-td")), l.eq(i).length > 0) { var s = l.eq(i).attr("data-type"); if (s) { var d = ""; if (t) { var p = l.eq(i).parent().find(".data-td"); d = $.trim(p.html()), p.find(".td-columnValue-edit").length > 0 ? d = $.trim(p.find(".td-columnValue-edit").html()) : 0 == d.indexOf("<input") && l.eq(i).find("input[type='checkbox']").length > 0 && (d = l.eq(i).find("input[type='checkbox']").is(":checked")) } else d = $.trim(l.eq(i).html()), l.eq(i).find(".td-columnValue-edit").length > 0 ? d = $.trim(l.eq(i).find(".td-columnValue-edit").html()) : 0 == d.indexOf("<input") && l.eq(i).find("input[type='checkbox']").length > 0 && (d = l.eq(i).find("input[type='checkbox']").is(":checked")); d = a(d, s); for (var c = 0; c < n.conditions.length; c++) { var u = a(n.conditions[c].value, s); if (!(r = o(n.conditions[c].condition, u, d)) && "&&" === n.conditions[c].conditionSeperator) break } } } } return r } function a(e, t) { switch (t.toLowerCase()) { case "int32": case "number": case "integer": e = parseInt(e); break; case "float": case "decimal": NaN != parseFloat(e) ? e = parseFloat(e) : NaN != parseInt(e) && (e = parseInt(e)); break; case "boolean": case "bool": case "bit": e = openWSE.ConvertBitToBoolean(e); break; case "money": e = e.replace(/\$/g, "").replace(/,/g, "").replace(/ /g, ""), NaN != parseFloat(e) ? e = parseFloat(e) : NaN != parseInt(e) && (e = parseInt(e)); break; default: isNaN(e) || (-1 != e.indexOf(".") ? (e = e.replace(/\$/g, "").replace(/,/g, "").replace(/ /g, ""), NaN != parseFloat(e) ? e = parseFloat(e) : NaN != parseInt(e) && (e = parseInt(e))) : e = parseInt(e)) }return e } function o(e, t, a) { if (">=" == e) { if (a >= t) return !0 } else if ("<=" == e) { if (a <= t) return !0 } else if ("!=" == e) { if (a != t) return !0 } else if (">" == e) { if (a > t) return !0 } else if ("<" == e) { if (a < t) return !0 } else if (a == t) return !0; return !1 } function n(e) { var t = ""; return -1 != e.indexOf("(") && (t = e.substring(e.indexOf("(") + 1)).lastIndexOf(")") === t.length - 1 && (t = t.substring(0, t.length - 1)), t } function i(e, t) { return e.replace("(" + t + ")", "") } function r(e, t, a) { for (var o = e.split(t), n = 0; n < o.length; n++) { var i = $.trim(o[n]), r = l(i), s = i.split(r); s.length > 0 && a.push({ condition: r, value: $.trim(s[s.length - 1]), conditionSeperator: t }) } return a } function l(e) { var t = "="; return e.indexOf(">=") >= 0 ? t = ">=" : e.indexOf("<=") >= 0 ? t = "<=" : e.indexOf("!=") >= 0 || e.indexOf("<>") >= 0 ? t = "!=" : e.indexOf(">") >= 0 ? t = ">" : e.indexOf("<") >= 0 && (t = "<"), t } function s(e) { return 0 === (e = $.trim(e)).indexOf('"') && (e = e.substring(1)), e.lastIndexOf('"') === e.length - 1 && (e = e.substring(0, e.length - 1)), $.trim(e) } function d(e) { return !(!isMobileDevice() && !$("#pnl_" + e + "_tableView").hasClass("mobile-view")) } return { SetSummaryData: function (a) { if ($("#div_" + a + "_summaryholder").length > 0) { var o = $("#" + a + "-complete-table"), l = d(a); $("#div_" + a + "_summaryholder").find(".custom-table-summary-item").each(function () { var a = $(this).find(".custom-table-summary-value"), d = $(this).attr("data-formulatype"), p = n(d); d = i(d, p).toLowerCase().replace(/if/g, ""), p = function (e) { var t = { columnName: "", conditions: [] }; if (e) { var a = (e = $.trim(unescape(e))).split(","); if (2 === a.length) { var o = new Array, n = s(a[1]); o = n.indexOf("||") > 0 ? r(n, "||", o) : r(n, "&&", o), t = { columnName: s(a[0]), conditions: o } } } return t }(p); var c = function (e, a, o, n) { var i = new Array, r = $(a).find(".data-td[data-columnname='" + e + "']"); if (o && (r = $(a).find(".headerName[data-columnname='" + e + "']").parent().find(".data-td")), r.length > 0) for (var l = 0; l < r.length; l++)if (t(a, o, n, l)) { var s = r.eq(l).attr("data-type"); if (s) { var d = 0; if (o) { var p = r.eq(l).parent().find(".data-td"); d = $.trim(p.html()), p.find(".td-columnValue-edit").length > 0 && (d = $.trim(p.find(".td-columnValue-edit").html())) } else d = $.trim(r.eq(l).html()), r.eq(l).find(".td-columnValue-edit").length > 0 && (d = $.trim(r.eq(l).find(".td-columnValue-edit").html())); if (d) switch (s.toLowerCase()) { case "int32": case "number": case "integer": i.push(parseInt(d)); break; case "float": case "decimal": NaN != parseFloat(d) ? i.push(parseFloat(d)) : NaN != parseInt(d) && i.push(parseInt(d)); break; case "money": d = d.replace(/\$/g, "").replace(/,/g, "").replace(/ /g, ""), NaN != parseFloat(d) ? i.push(parseFloat(d)) : NaN != parseInt(d) && i.push(parseInt(d)); break; default: isNaN(d) || (-1 != d.indexOf(".") ? (d = d.replace(/\$/g, "").replace(/,/g, "").replace(/ /g, ""), NaN != parseFloat(d) ? i.push(parseFloat(d)) : NaN != parseInt(d) && i.push(parseInt(d))) : i.push(parseInt(d))) } } } return i }($(this).attr("data-summarycolumn"), o, l, p); try { var u = e[d](c); a.html(u) } catch (e) { a.html("-") } }) } }, BuildSummaryHolder: function (e) { var t = "", a = unescape($("#hf_" + e + "_summaryData").val()); if (a) { t += "<div id='div_" + e + "_summaryholder' class='customtables-summary-margin'>"; for (var o = $.parseJSON(a), n = 0; n < o.length; n++)t += "<div class='custom-table-summary-item' data-summarycolumn='" + o[n].columnName.replace(/&nbsp;/g, " ") + "' data-formulatype='" + o[n].formulaType.replace(/&nbsp;/g, " ") + "'>", t += "<div class='custom-table-summary-name'>" + o[n].summaryName.replace(/&nbsp;/g, " ") + "</div>", t += "<div class='custom-table-summary-value'></div>", t += "<div class='clear'></div></div>"; t += "<div class='clear'></div></div>" } return t }, IsMobileViewMode: d, GetFormula: n, GetFormulaType: i } }(), GridViewMethods = function () { var pageIndexArray = new Array, pageSortArray = new Array, searchInfoArray = new Array, rowClickEventActive = !1; function InitializeTable(e) { var t = $(".gridview-table[data-tableid='" + e + "']"); t.length > 0 && (StartTableSearch(t), SetSortColumnData(t), MoveInsertRow(t), rowClickEventActive && (t.find("tr.myItemStyle").unbind("click"), t.find("tr.myItemStyle").bind("click", function (e) { e && e.target && ("tr" == e.target.tagName.toLowerCase() || "td" == e.target.tagName.toLowerCase()) ? $(this).hasClass("activeClick") ? $(this).removeClass("activeClick") : (t.find("tr.myItemStyle").removeClass("activeClick"), $(this).addClass("activeClick")) : t.find("tr.myItemStyle").removeClass("activeClick") }))) } function PageSizeChange(e) { var t = $(e).closest(".gridview-table-holder").find(".gridview-table"); t.length > 0 && (UpdatePageSizeCookie(t, t.attr("data-cookiename")), GoToPageNumber_Click(t.attr("data-tableid"))) } function UpdatePageSizeCookie(e, t) { try { var a = e.closest(".gridview-table-holder").find(".table-pagesize-selector > select").val(); openWSE.AjaxCall("WebServices/SaveControls.asmx/SetCookie", "{ 'name': '" + t + "', 'value': '" + a + "'}") } catch (e) { } } function SetPageSize(e) { e.find("tr.myItemStyle:not(.search-hide)").each(function () { $(this).removeClass("hide-table-row") }); var t = e.closest(".gridview-table-holder").find(".table-pagesize-selector > select").val(); "all" === t && (t = e.find("tr.myItemStyle:not(.search-hide)").length), t = parseInt(t); var a = GetPageIndexItem(e); a = a ? parseInt(a) : 0; var o = e.find("tr.myItemStyle:not(.search-hide)").length / t; -1 !== o.toString().indexOf(".") && (o = o.toString().replace(o.toString().substring(o.toString().indexOf(".")), ""), o = parseInt(o) + 1); var n = a * t, i = (n = n >= 0 ? n : 0) + t; e.find("tr.myItemStyle:not(.search-hide)").each(function (e) { (e < n || e >= i) && $(this).addClass("hide-table-row") }); var r = e.attr("data-tableid"), l = '<span class="pg-first-btn GridViewPager-Btns cursor-pointer" onclick="openWSE.GridViewMethods.FirstPage_Click(\'' + r + "');\"></span>", s = '<span class="pg-prev-btn GridViewPager-Btns cursor-pointer" onclick="openWSE.GridViewMethods.PrevPage_Click(\'' + r + "');\"></span>", d = '<span class="pg-next-btn GridViewPager-Btns cursor-pointer" onclick="openWSE.GridViewMethods.NextPage_Click(\'' + r + "');\"></span>", p = '<span class="pg-last-btn GridViewPager-Btns cursor-pointer" onclick="openWSE.GridViewMethods.LastPage_Click(\'' + r + "');\"></span>", c = 1; 0 === o && (c = 0); var u = '<span class="float-right margin-top-sml">of ' + o + '</span><input class="input-buttons float-right no-margin" type="button" value="Go" onclick="openWSE.GridViewMethods.GoToPageNumber_Click(\'' + r + '\');" style="margin-top: -1px!important; margin-right: 5px!important;" /><input type="number" class="textEntry page-index-textbox margin-right-sml float-right" min="' + c + '" max="' + o + '" style="width: 60px;" />'; 0 === o && (a = -1), e.find(".gridview-pager-holder").html(p + d + u + s + l), e.find(".gridview-pager-holder").find(".page-index-textbox").val(a + 1), e.find(".gridview-pager-holder").show(), o <= 1 && e.find(".gridview-pager-holder").hide(); var h = e.find("tr.myItemStyle:not(.search-hide)").get(), f = a * t + 1, g = f + t - 1; g > h.length && (g = h.length), f < 0 && (f = 0), e.find(".table-pagesize-outof").html("View " + f + " - " + g + " of " + h.length) } function SetSortColumnData(e) { var t = GetPageSortItem(e), a = e.find(".myHeaderStyle").find("td[data-columnname='" + t.column + "']"); a.length > 0 ? (e.find(".myHeaderStyle").find("td").each(function () { $(this).removeClass("asc"), $(this).removeClass("desc"), $(this).removeClass("active") }), a.addClass("active"), a.addClass(t.dir.toLowerCase()), SortData(e, t)) : openWSE.ConvertBitToBoolean(e.attr("data-allowpaging")) && SetPageSize(e), MoveInsertRow(e) } function SortData(e, t) { var a = e.find("tr.myItemStyle:not(.search-hide)").get(); a.sort(function (e, a) { var o = $(e).find("td[data-columnname='" + t.column + "']"), n = $(a).find("td[data-columnname='" + t.column + "']"), i = "", r = ""; return o.find("input[type='checkbox']").length > 0 ? i = o.find("input").prop("checked").toString() : o.find(".sort-value-class").length > 0 ? i = o.find(".sort-value-class").attr("data-sortvalue") : o.find("input").length > 0 ? !(i = o.find("input").val()) && o.find("input").attr("data-value") && (i = unescape(o.find("input").attr("data-value"))) : i = o.find("select").length > 0 ? o.find("select").val() : o.text(), n.find("input[type='checkbox']").length > 0 ? r = n.find("input").prop("checked").toString() : n.find(".sort-value-class").length > 0 ? r = n.find(".sort-value-class").attr("data-sortvalue") : n.find("input").length > 0 ? !(r = n.find("input").val()) && n.find("input").attr("data-value") && (r = unescape(n.find("input").attr("data-value"))) : r = n.find("select").length > 0 ? n.find("select").val() : n.text(), i = $.trim(i), r = $.trim(r), isNaN(i) || isNaN(r) ? "Invalid Date" !== new Date(i).toString() && "Invalid Date" !== new Date(r).toString() ? (i = new Date(i), r = new Date(r)) : (i = i.toLowerCase(), r = r.toLowerCase()) : (i = -1 !== i.indexOf(".") ? parseFloat(i) : parseInt(i), r = -1 !== r.indexOf(".") ? parseFloat(r) : parseInt(r)), "desc" == t.dir ? i < r ? -1 : i > r ? 1 : 0 : i > r ? -1 : i < r ? 1 : 0 }), $.each(a, function (t, a) { e.find("tbody > tr.myHeaderStyle").after(a) }); var o = e.attr("data-altrowclass"); o && (e.find("tr.myItemStyle:not(.search-hide)").removeClass("GridNormalRow"), e.find("tr.myItemStyle:not(.search-hide)").removeClass(o)), e.find("tr.myItemStyle:not(.search-hide)").each(function (e) { $(this).find(".GridViewNumRow").length > 0 && $(this).find(".GridViewNumRow").html(e + 1), o && (e % 2 != 0 ? $(this).addClass(o) : $(this).addClass("GridNormalRow")) }), openWSE.ConvertBitToBoolean(e.attr("data-allowpaging")) && SetPageSize(e) } function MoveInsertRow(e) { e.find("tr.addItemRow").length > 0 && ConvertBitToBoolean(e.attr("data-putinsertattop")) && $("tr.myHeaderStyle").after(e.find("tr.addItemRow")) } function FirstPage_Click(e) { var t = $(".gridview-table[data-tableid='" + e + "']"); t.length > 0 && (UpdatePageIndexItem(t, 0), SetPageSize(t)) } function PrevPage_Click(e) { var t = $(".gridview-table[data-tableid='" + e + "']"); if (t.length > 0) { var a = parseInt(GetPageIndexItem(t)); a - 1 >= 0 && (UpdatePageIndexItem(t, a - 1), SetPageSize(t)) } } function NextPage_Click(e) { var t = $(".gridview-table[data-tableid='" + e + "']"); if (t.length > 0) { var a = GetTotalPageCount(t), o = parseInt(GetPageIndexItem(t)); o + 1 < a && (UpdatePageIndexItem(t, o + 1), SetPageSize(t)) } } function LastPage_Click(e) { var t = $(".gridview-table[data-tableid='" + e + "']"); t.length > 0 && (UpdatePageIndexItem(t, GetTotalPageCount(t) - 1), SetPageSize(t)) } function GetPageIndexItem(e) { var t = e.attr("data-tableid"); if (t) for (var a = 0; a < pageIndexArray.length; a++)if (pageIndexArray[a].name === t) return parseInt(pageIndexArray[a].value) > GetTotalPageCount(e) - 1 ? 0 : pageIndexArray[a].value; return 0 } function UpdatePageIndexItem(e, t) { var a = e.attr("data-tableid"); if (a) { for (var o = !1, n = 0; n < pageIndexArray.length; n++)if (pageIndexArray[n].name === a) { pageIndexArray[n].value = t, o = !0; break } o || pageIndexArray.push({ name: a, value: t }) } } function GetPageSortItem(e) { var t = e.attr("data-tableid"); if (t) for (var a = 0; a < pageSortArray.length; a++)if (pageSortArray[a].name === t) return pageSortArray[a]; return { name: e.attr("data-tableid"), column: e.attr("data-initalsortcolumn"), dir: e.attr("data-initalsortdir").toLowerCase() } } function UpdatePageSortItem(e, t, a) { var o = e.attr("data-tableid"); if (o) { for (var n = !1, i = 0; i < pageSortArray.length; i++)if (pageSortArray[i].name === o) { pageSortArray[i].column = t, pageSortArray[i].dir = a, n = !0; break } n || pageSortArray.push({ name: o, column: t, dir: a }) } } function GoToPageNumber_Click(e) { var t = $(".gridview-table[data-tableid='" + e + "']"); if (t.length > 0) { var a = parseInt(t.find(".page-index-textbox").val()) - 1; if (!isNaN(a)) { var o = GetTotalPageCount(t); a < 0 ? a = 0 : a >= o && (a = o - 1), UpdatePageIndexItem(t, a) } SetPageSize(t) } } function SortColumn_Click(e) { var t = $(e), a = t.attr("data-columnname"), o = t.closest(".gridview-table"), n = "asc"; t.hasClass("asc") && (n = "desc"), UpdatePageSortItem(o, a, n), StartTableSearch(o), SetSortColumnData(o) } function GetTotalPageCount(e) { var t = e.closest(".gridview-table-holder").find(".table-pagesize-selector > select").val(); if ("all" !== t) { t = parseInt(t); var a = e.find("tr.myItemStyle:not(.search-hide)").length / t; return -1 !== a.toString().indexOf(".") && (a = a.toString().replace(a.toString().substring(a.toString().indexOf(".")), ""), a = parseInt(a) + 1), a } return 1 } function OnInsertRow(tableId, functionCall) { functionCall = unescape(functionCall).replace(/&nbsp;/g, " "); var functionNames = functionCall.split(";"), $gridview = $(".gridview-table[data-tableid='" + tableId + "']"); $gridview.length > 0 && $gridview.find(".addItemRow").length > 0 && $gridview.find(".addItemRow").find("input").blur(); for (var i = 0; i < functionNames.length; i++) { var functionNamePart = $.trim(functionNames[i]); if (functionNamePart) try { eval(functionNamePart) } catch (e) { try { var functionParts = functionNamePart.split("("); if (functionParts.length > 1) { var functionName = functionParts[0], functionArgs = functionParts[1].substring(0, functionParts[1].length - 1), fn = window[functionName]; "function" == typeof fn && fn(functionArgs) } } catch (e) { openWSE.LogConsoleMessage(e) } } } } function OnInsertRow_KeyPress(e, t, a) { if ((13 == e.which || 13 == e.keyCode) && a) return OnInsertRow(t, a), !1 } function SearchTable(e) { var t = "<div id='SearchTable-element' class='Modal-element' data-tableid='" + e + "' style='display: none;'>"; t += "<div class='Modal-overlay' onclick=\"openWSE.GridViewMethods.SearchOverlayClick(event, '" + e + "');\">", t += "<div class='Modal-element-align'>", t += "<div class='Modal-element-modal' data-setwidth='370'>", t += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>", t += "<a href='#' onclick=\"openWSE.GridViewMethods.CloseSearchTable('" + e + "');return false;\" class='ModalExitButton'></a>", t += "</div><span class='Modal-title'></span></div></div>"; var a = '<div class="input-settings-holder"><span class="font-bold">Filter</span><div class=\'clear-space-two\'></div>'; a += '<select class="search-filter">', a += '<option value="contains">Contains</option>', a += '<option value="startswith">Starts with</option>', a += '<option value="endswith">Ends with</option>', a += '<option value="equals">Equals</option>', a += '<option value="notequals">Does not equal</option>', a += "</select>", a += "</div>", a += '<div class="input-settings-holder"><span class="font-bold">Text</span><div class=\'clear-space-two\'></div><input type="text" class="textEntry search-text" onkeypress="openWSE.GridViewMethods.InitialSearch_KeyPress(event, \'' + e + "');\" />", a += "</div>", a += '<input type="checkbox" id="cb_search-match-case" class="search-match-case" /><label for="cb_search-match-case">Match Case</label>', t += "<div class='ModalPadContent'>" + (a += '<div class="clear"></div>') + "</div>", t += "<div class='ModalButtonHolder'>" + ("<input class='input-buttons modal-ok-btn' type='button' value='Find' onclick=\"openWSE.GridViewMethods.InitialSearch('" + e + "');\" />") + ("<input class='input-buttons modal-ok-btn' type='button' value='Clear' onclick=\"openWSE.GridViewMethods.ClearSearch('" + e + "', true);\" />") + ("<input class='input-buttons modal-cancel-btn' type='button' value='Close' onclick=\"openWSE.GridViewMethods.CloseSearchTable('" + e + "');\" />") + "<div class='clear'></div></div>", t += "</div></div></div></div>", $("body").append(t), LoadModalWindow(!0, "SearchTable-element", "Search Table"), setTimeout(function () { var t = $("#SearchTable-element[data-tableid='" + e + "']"); if (t.length > 0) { var a = GetSearchCriteria(e); t.find(".search-filter").val(a.filter), t.find(".search-text").val(a.text), t.find(".search-match-case").prop("checked", a.matchCase), t.find(".search-text").focus() } }, openWSE_Config.animationSpeed) } function InitialSearch(e) { var t = $("#SearchTable-element[data-tableid='" + e + "']"); if (t.length > 0) { for (var a = t.find(".search-filter").val(), o = $.trim(t.find(".search-text").val()), n = t.find(".search-match-case").is(":checked"), i = !1, r = 0; r < searchInfoArray.length; r++)if (searchInfoArray[r].tableId == e) { searchInfoArray[r].filter = a, searchInfoArray[r].text = o, searchInfoArray[r].matchCase = n, i = !0; break } i || searchInfoArray.push({ tableId: e, filter: a, text: o, matchCase: n }), InitializeTable(e) } } function InitialSearch_KeyPress(e, t) { !e || 13 != e.which && 13 != e.keyCode || (e.preventDefault(), InitialSearch(t)) } function StartTableSearch(e) { if (e.length > 0) { var t = e.attr("data-tableid"), a = GetSearchCriteria(t), o = a.filter, n = a.text, i = a.matchCase; if (n) { e.find("tr.myItemStyle").removeClass("search-hide"), i || (n = n.toLowerCase()); for (var r = 0; r < e.find("tr.myItemStyle").length; r++) { var l = e.find("tr.myItemStyle").eq(r), s = new Array; l.find("td").each(function () { var e = $(this); if (e.attr("data-columnname")) { var t = ""; e.find("input[type='checkbox']").length > 0 ? t = e.find("input").prop("checked").toString() : e.find("input").length > 0 ? !(t = e.find("input").val()) && e.find("input").attr("data-value") && (t = unescape(e.find("input").attr("data-value"))) : t = e.find("select").length > 0 ? e.find("select").val() : e.find(".sort-value-class").length > 0 ? e.find(".sort-value-class").attr("data-sortvalue") : e.text(), t && s.push(t) } }); for (var d = !0, p = 0; p < s.length; p++) { var c = s[p]; if (i || (c = c.toLowerCase()), "startswith" === o) { if (0 === c.indexOf(n)) { d = !1; break } } else if ("endswith" === o) { if (-1 !== c.indexOf(n) && c.indexOf(n) === c.length - n.length) { d = !1; break } } else if ("equals" === o) { if (c === n) { d = !1; break } } else if ("notequals" === o) { if (c !== n) { d = !1; break } } else if (-1 !== c.indexOf(n)) { d = !1; break } } d && l.addClass("search-hide") } e.find(".emptyGridView-search-td").length > 0 && e.find(".emptyGridView-search-td").parent().remove(), e.find(".search-hide").length === e.find("tr.myItemStyle").length && 0 === e.find("tr.addItemRow").length && (e.find(".myHeaderStyle").after('<tr><td class="emptyGridView-search-td" colspan="' + e.attr("data-columnspan") + '"><div class="emptyGridView">No search results found</div></td></tr>'), e.find("tbody").find(".emptyGridView-td").length > 0 && (e.find("tbody").find(".emptyGridView-td").parent().hide(), e.find("tbody").find(".emptyGridView-td").parent().attr("data-hidden", "true"))) } else ClearSearch(t, !1) } } function CloseSearchTable(e) { $("#SearchTable-element[data-tableid='" + e + "']").remove(), $("body").removeClass("modal-fixed-position-body"), $("#site_mainbody").length > 0 && "Boxed" === $("#site_mainbody").attr("data-layoutoption") && ($(".fixed-container-border-left").find(".Modal-overlay").remove(), $(".fixed-container-border-right").find(".Modal-overlay").remove(), $(".fixed-footer-container-left").find(".Modal-overlay").remove(), $(".fixed-footer-container-right").find(".Modal-overlay").remove()) } function SearchOverlayClick(e, t) { e && e.target && "Modal-overlay" == e.target.className && CloseSearchTable(t) } function ClearSearch(e, t) { $("#SearchTable-element[data-tableid='" + e + "']").find(".search-text").val(""), $("#SearchTable-element[data-tableid='" + e + "']").find(".search-match-case").prop("checked", !1); var a = $(".gridview-table[data-tableid='" + e + "']"); if (a.length > 0) { a.find("tbody").find(".emptyGridView-search-td").length > 0 && a.find("tbody").find(".emptyGridView-search-td").parent().remove(), a.find("tbody").find(".emptyGridView-td").length > 0 && "true" == a.find("tbody").find(".emptyGridView-td").parent().attr("data-hidden") && (a.find("tbody").find(".emptyGridView-td").parent().show(), a.find("tbody").find(".emptyGridView-td").parent().attr("data-hidden", "")), a.find("tr.myItemStyle").removeClass("search-hide"); for (var o = 0; o < searchInfoArray.length; o++)if (searchInfoArray[o].tableId == e) { searchInfoArray[o].filter = "contains", searchInfoArray[o].text = "", searchInfoArray[o].matchCase = !1; break } t && InitializeTable(e) } } function GetSearchCriteria(e) { for (var t = 0; t < searchInfoArray.length; t++)if (searchInfoArray[t].tableId == e) return searchInfoArray[t]; return { tableId: e, filter: "contains", text: "", matchCase: !1 } } return { InitializeTable: InitializeTable, PageSizeChange: PageSizeChange, FirstPage_Click: FirstPage_Click, PrevPage_Click: PrevPage_Click, NextPage_Click: NextPage_Click, LastPage_Click: LastPage_Click, GoToPageNumber_Click: GoToPageNumber_Click, SortColumn_Click: SortColumn_Click, OnInsertRow: OnInsertRow, OnInsertRow_KeyPress: OnInsertRow_KeyPress, SearchTable: SearchTable, InitialSearch: InitialSearch, CloseSearchTable: CloseSearchTable, SearchOverlayClick: SearchOverlayClick, InitialSearch_KeyPress: InitialSearch_KeyPress, ClearSearch: ClearSearch } }(); function CreateXMLHttpRequest() { try { return new XMLHttpRequest } catch (e) { } try { return new ActiveXObject("Msxml2.XMLHTTP") } catch (e) { } return null } var newThemeColorOption_Format = "", defaultLightFontColorVal = "", defaultDarkFontColorVal = ""; function SetNewThemeColorOptionFormat(e, t, a) { newThemeColorOption_Format = e, defaultLightFontColorVal = t, defaultDarkFontColorVal = a } function InitializeThemeColorOption(e) { var t = $("#" + e).find(".theme-color-option.selected"); if (t.length > 0) { var a = !1, o = t.attr("data-color"); o || (o = t.find(".color-option-toplogo").css("background-color"), a = !0), 0 !== o.indexOf("rgba(") && 0 !== o.indexOf("rgb(") || (o = openWSE.RgbToHex(o)), o = o.replace("#", "").toUpperCase(), t.parent().find("input[name='cb_usedefaultthemecolor']").prop("checked", !1), t.parent().find(".color-option-picker").find("input").prop("disabled", !1), t.parent().find(".color-option-input").val(CreateFormattedHexColor(o)), t.parent().find(".color-option-input").attr("value", CreateFormattedHexColor(o)), a && (t.parent().find("input[name='cb_usedefaultthemecolor']").prop("checked", !0), t.parent().find(".color-option-picker").find("input").prop("disabled", !0)) } $(".cb_usedefaultthemecolor_class").length > 1 && $(".cb_usedefaultthemecolor_class").each(function (e) { var t = "cb_usedefaultthemecolor" + e.toString(); $(this).attr("id", t), $(this).parent().find("label[for='cb_usedefaultthemecolor']").attr("for", t) }) } function ColorOption_Changed(e) { var t = $(e).closest(".color-option-picker").parent().find(".theme-color-option.selected"); t.length > 0 ? ($("#pnl_ColorOptions").length > 0 && $("#pnl_ColorOptions").find(".theme-color-option.selected").attr("data-color", $.trim($(e).parent().find(".color-option-input").val()).replace("#", "")), $("#div_ColorOptionsHolder").length > 0 && $("#div_ColorOptionsHolder").find(".theme-color-option.selected").attr("data-color", $.trim($(e).parent().find(".color-option-input").val()).replace("#", "")), ThemeColorOption_Clicked(t)) : openWSE.AlertWindow("No color option is selected") } function ThemeColorOption_Clicked(e, t) { if (void 0 !== e && null != e) { var a = $(e).attr("data-option"), o = $(e).attr("data-color"), n = !1; o || (o = $(e).find(".color-option-toplogo").css("background-color"), n = !0), 0 !== o.indexOf("rgba(") && 0 !== o.indexOf("rgb(") || (o = openWSE.RgbToHex(o)), o = o.replace("#", "").toUpperCase(), $(e).parent().find("input[name='cb_usedefaultthemecolor']").prop("checked", !1), $(e).parent().find(".color-option-picker").find("input").prop("disabled", !1), $(e).parent().find(".color-option-input").val(CreateFormattedHexColor(o)), $(e).parent().find(".color-option-input").attr("value", CreateFormattedHexColor(o)), n && (o = "", $(e).parent().find("input[name='cb_usedefaultthemecolor']").prop("checked", !0), $(e).parent().find(".color-option-picker").find("input").prop("disabled", !0)); var i = $(e).parent().attr("id"); i || (i = $(e).parent().parent().attr("id")), "pnl_ColorOptions" !== i ? $("#div_ColorOptionsHolder").find(".theme-color-option").removeClass("selected") : $("#pnl_ColorOptions").find(".theme-color-option").removeClass("selected"), $(e).addClass("selected"), $(e).find(".color-option-toplogo").css("background-color", ""), $(e).find(".color-option-topbar").css("background-color", ""), "" !== o && ($(e).find(".color-option-toplogo").css("background-color", "#" + o), "1" !== a && "3" !== a || $(e).find(".color-option-topbar").css("background-color", "#" + o)), t || ($("body").attr("data-coloroption", a), SetNewThemeColorOption(a, o), "pnl_ColorOptions" !== i ? ($("#pnl_ColorOptions").length > 0 && openWSE.ThemeColorOption_Clicked($("#pnl_ColorOptions").find(".theme-color-option[data-option='" + a + "']")[0], !0), openWSE_Config.demoMode || (loadingPopup.Message("Updating..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/UpdateColorOption", '{ "option": "' + a + '", "color": "' + o + '" }', null, null, null, function (e) { loadingPopup.RemoveMessage() }))) : "pnl_ColorOptions" === i && $("#hf_ColorOptions").length > 0 && (openWSE.ThemeColorOption_Clicked($("#div_ColorOptionsHolder").find(".theme-color-option[data-option='" + a + "']")[0], !0), loadingPopup.Message("Updating..."), $("#hf_ColorOptions").val(a + "~" + o), openWSE.CallDoPostBack("hf_ColorOptions", ""))) } } function ResetColorOption_Clicked(e, t) { if (void 0 !== e && null != e) { var a = $(e).parent().parent().find(".theme-color-option.selected"); if (a.length > 0) if ($(e).prop("checked")) { $(e).parent().parent().find(".color-option-picker").find("input").prop("disabled", !0); var o = a.attr("data-option"); a.attr("data-color", ""), a.find(".color-option-toplogo").css("background-color", ""), a.find(".color-option-topbar").css("background-color", ""); var n = a.find(".color-option-toplogo").css("background-color"); 0 !== n.indexOf("rgba(") && 0 !== n.indexOf("rgb(") || (n = openWSE.RgbToHex(n)), n = n.replace("#", "").toUpperCase(), a.parent().find(".color-option-input").val(CreateFormattedHexColor(n)), a.parent().find(".color-option-input").attr("value", CreateFormattedHexColor(n)); var i = $(e).parent().attr("id"); i || (i = $(e).parent().parent().attr("id")), "pnl_ColorOptions" !== i ? $("#div_ColorOptionsHolder").find(".theme-color-option").removeClass("selected") : $("#pnl_ColorOptions").find(".theme-color-option").removeClass("selected"), a.addClass("selected"), t || ($("body").attr("data-coloroption", o), SetNewThemeColorOption(o, ""), "pnl_ColorOptions" !== i ? ($("#pnl_ColorOptions").length > 0 && ($("#pnl_ColorOptions").find(".cb_usedefaultthemecolor_class").prop("checked", !0), openWSE.ResetColorOption_Clicked($("#pnl_ColorOptions").find(".cb_usedefaultthemecolor_class")[0], !0)), openWSE_Config.demoMode || (loadingPopup.Message("Updating..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/UpdateColorOption", '{ "option": "' + o + '", "color": "" }', null, null, null, function (e) { loadingPopup.RemoveMessage() }))) : "pnl_ColorOptions" === i && $("#hf_ColorOptions").length > 0 && ($("#div_ColorOptionsHolder").find(".cb_usedefaultthemecolor_class").prop("checked", !0), openWSE.ResetColorOption_Clicked($("#div_ColorOptionsHolder").find(".cb_usedefaultthemecolor_class")[0], !0), loadingPopup.Message("Updating..."), $("#hf_ColorOptions").val(o + "~"), openWSE.CallDoPostBack("hf_ColorOptions", ""))) } else ColorOption_Changed($(e).parent().parent().find(".color-option-picker").find("input[type='button']"), t); else openWSE.AlertWindow("No color option is selected") } } function SetNewThemeColorOption(e, t) { var a = $("head"); if (a.length > 0 && (a.find("style[data-id='theme-coloroption-style']").remove(), t)) { 0 !== t.indexOf("#") && (t = "#" + t); var o = openWSE.GetAltColorFromHex(t, 40), n = openWSE.GetAltColorFromHex(t, 70), i = defaultLightFontColorVal, r = "brightness(500%)", l = "brightness(20%)", s = o; if (UseDarkTextColorWithBackground(t) && (i = defaultDarkFontColorVal, r = "brightness(100%)", l = "brightness(100%)", s = "inherit"), newThemeColorOption_Format) { var d = newThemeColorOption_Format; d = (d = (d = (d = (d = (d = (d = (d = (d = (d = d.replace(/\{0\}/g, e)).replace(/\{1\}/g, t)).replace(/\{2\}/g, i)).replace(/\{3\}/g, o)).replace(/\{4\}/g, n)).replace(/\{5\}/g, r)).replace(/\{6\}/g, s)).replace(/\{7\}/g, l)).replace(/{{/g, "{")).replace(/}}/g, "}"), a.append(d) } } } function CreateFormattedHexColor(e) { return 0 !== e.indexOf("#") ? "#" + e : e } function RgbToHex(e) { return (e = e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i)) && 4 === e.length ? "#" + ("0" + parseInt(e[1], 10).toString(16)).slice(-2) + ("0" + parseInt(e[2], 10).toString(16)).slice(-2) + ("0" + parseInt(e[3], 10).toString(16)).slice(-2) : "" } function HexToRgb(e) { e = e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i, function (e, t, a, o) { return t + t + a + a + o + o }); var t = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e); return t ? { r: parseInt(t[1], 16), g: parseInt(t[2], 16), b: parseInt(t[3], 16) } : null } function UseDarkTextColorWithBackground(e) { var t = !0; if ("inherit" !== e && "#inherit" !== e) { var a = HexToRgb(e); a && a.r + a.g + a.b < 475 && (t = !1) } return t } function GetAltColorFromHex(e, t) { var a = openWSE.HexToRgb(e); if (a) try { var o = a.r, n = a.g, i = a.b; o > t ? o -= t : o = 0, n > t ? n -= t : n = 0, i > t ? i -= t : i = 0; var r = openWSE.RgbToHex("rgb(" + o + ", " + n + ", " + i + ")"); return 0 !== r.indexOf("#") && (r = "#" + r), r.toUpperCase() } catch (e) { } return 0 !== e.indexOf("#") && (e = "#" + e), e.toUpperCase() } function CloseWindow() { return "true" === getParameterByName("mobileMode") || -1 !== window.location.href.indexOf("mobileMode=true") ? "true" === getParameterByName("fromAppRemote") || -1 !== window.location.href.indexOf("fromAppRemote=true") ? window.location.href = openWSE.siteRoot() + "AppRemote.aspx#?tab=AdminLinks_tab" : window.location.href = window.location.href.replace("?mobileMode=true", "").replace("&mobileMode=true", "") : -1 !== window.location.href.toLowerCase().indexOf("externalappholder.aspx") ? window.close() : window.location.href = openWSE.siteRoot() + "Default.aspx", !1 } function AnimateToTop() { $("#main_container").find(".go-to-top").hide(), $("#main_container").animate({ scrollTop: 0 }, 3 * openWSE_Config.animationSpeed, function () { $("#main_container").find(".go-to-top").remove() }) } function LogConsoleMessage(e) { "string" == typeof e && (e = (e = unescape(e)).replace(/\+/g, " ")), console.log(e) } function SetupAccordions(e) { var t = !1; openWSE_Config.saveCookiesAsSessions && e && (openWSE_Config.saveCookiesAsSessions = !1, t = !0), $(".custom-accordion").each(function () { var e = $(this); !openWSE.ConvertBitToBoolean(e.attr("data-nocookie")) && e.attr("id") ? cookieFunctions.get("custom-accordion__" + e.attr("id"), function (t) { null == t || "" === t ? t = 0 : (t = parseInt(t), isNaN(t) && (t = 0)), cookieFunctions.del("custom-accordion__" + e.attr("id")), e.accordion({ heightStyle: "content", active: t }) }) : e.accordion({ heightStyle: "content", active: 0 }) }), t && (openWSE_Config.saveCookiesAsSessions = !0) } function SaveAccordionState(e) { var t = !1; openWSE_Config.saveCookiesAsSessions && e && (openWSE_Config.saveCookiesAsSessions = !1, t = !0), $(".custom-accordion").each(function () { var e = $(this); !openWSE.ConvertBitToBoolean(e.attr("data-nocookie")) && e.attr("id") && cookieFunctions.set("custom-accordion__" + e.attr("id"), e.accordion("option", "active"), 30) }), t && (openWSE_Config.saveCookiesAsSessions = !0) } $(document.body).on("change", "#rb_BoxedLayout", function () { $("#site_mainbody").attr("data-layoutoption", "Boxed"), openWSE.SetLeftSidebarScrollTop(), $(window).resize(), $("#rb_BoxedLayout_acctOptions").length > 0 && $("#rb_WideLayout_acctOptions").length > 0 && ($("#rb_BoxedLayout_acctOptions").prop("checked", !0), $("#rb_WideLayout_acctOptions").prop("checked", !1)), openWSE_Config.demoMode || (loadingPopup.Message("Updating..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/UpdateLayoutOption", '{ "option": "Boxed" }', null, null, null, function (e) { loadingPopup.RemoveMessage() })) }), $(document.body).on("change", "#rb_WideLayout", function () { $("#site_mainbody").attr("data-layoutoption", "Wide"), openWSE.SetLeftSidebarScrollTop(), $(window).resize(), $("#rb_BoxedLayout_acctOptions").length > 0 && $("#rb_WideLayout_acctOptions").length > 0 && ($("#rb_BoxedLayout_acctOptions").prop("checked", !1), $("#rb_WideLayout_acctOptions").prop("checked", !0)), openWSE_Config.demoMode || (loadingPopup.Message("Updating..."), openWSE.AjaxCall("WebServices/AcctSettings.asmx/UpdateLayoutOption", '{ "option": "Wide" }', null, null, null, function (e) { loadingPopup.RemoveMessage() })) }); var CalendarViewApps = function () { var e, t = new Array(12); t[0] = "January", t[1] = "February", t[2] = "March", t[3] = "April", t[4] = "May", t[5] = "June", t[6] = "July", t[7] = "August", t[8] = "September", t[9] = "October", t[10] = "November", t[11] = "December"; var a = {}; function o(e, o, i) { if (!a[e].reloading) { a[e].reloading = !0, loadingPopup.Message("Loading...", p(e)), a[e].selectedMonth = o, a[e].selectedYear = i, a[e].dataObj = new Date(i, o, 1, (new Date).getHours(), (new Date).getMinutes(), (new Date).getSeconds(), (new Date).getMilliseconds()); var r = function (e) { var o = "<div class='calendarView-toolbar'>"; o += "<a class='calendarView-menubtn' onclick=\"openWSE.CalendarViewApps.ToolbarMenu_Click('" + e + "'); return false;\"></a>"; for (var n = "<select class='dd_monthSelect' onchange=\"openWSE.CalendarViewApps.onMonthYear_Change('" + e + "');\">", i = 0; i < t.length; i++) { var r = ""; a[e].dataObj.getMonth() == i && (r = " selected='selected'"), n += "<option value='" + i + "' " + r + ">" + t[i] + "</option>" } n += "</select>"; for (var l = "<select class='dd_yearSelect' onchange=\"openWSE.CalendarViewApps.onMonthYear_Change('" + e + "');\">", i = 2010; i < 2025; i++) { var r = ""; a[e].dataObj.getFullYear() == i && (r = " selected='selected'"), l += "<option value='" + i + "' " + r + ">" + i + "</option>" } return o += "<div class='dateSelector'><a onclick=\"openWSE.CalendarViewApps.onNextMonth_Click('" + e + "');return false;\" class='nextMonthBtn' title='Next Month'></a><a onclick=\"openWSE.CalendarViewApps.onPrevMonth_Click('" + e + "');return false;\" class='prevMonthBtn' title='Previous Month'></a>" + (l += "</select>") + n + "</div>", o += "</div>", o += function (e) { var t = ""; a[e].sidebarActive && (t = " active"); var o = "<div class='calendarView-sidebar" + t + "'><div class='pad-all'>"; return o += "<div class='img-close-dark app-menu-btn' onclick=\"openWSE.CalendarViewApps.ToolbarMenu_Click('" + e + "');\" title='Close Menu'></div>", o += "<a href='#' class='float-right img-refresh' onclick=\"openWSE.CalendarViewApps.RefreshCalendar('" + e + "');return false;\" title='Refresh Calendar'></a>", o += "<div class='clear-space'></div>", o += "<div class='searchwrapper'>", o += "<div class='searchboxholder'><input type='text' class='searchbox' placeholder='Search current month...' value=\"" + a[e].searchVal + '" onkeypress="openWSE.CalendarViewApps.SearchCalendar_KeyPress(\'' + e + "', this, event)\" /></div>", o += "<a class='searchbox_submit' onclick=\"openWSE.CalendarViewApps.SearchCalendar('" + e + "', this); return false;\"></a><a onclick=\"openWSE.CalendarViewApps.ClearSearch('" + e + "', this); return false;\" class='searchbox_clear'></a>", o += "</div>", o += "<div class='clear'></div>", o += "<ul>", o += "<li><div class='section-pad'>", null !== a[e].AddNewCalendarFunction && "function" == typeof a[e].AddNewCalendarFunction && (o += '<a class="sidebar-menu-buttons" onclick="openWSE.CalendarViewApps.onDay_Click(\'' + e + "', null); return false;\"><span class='td-add-btn sidebar-menu-img'></span>Add Event</a>"), o += a[e].sidebarLinkHtml, o += "</div></li>", o += "<li><div class='section-pad'><h3 class='section-pad-title' style='padding-top: 3px!important;'>View Mode</h3>", o += "<select class='calendarView-select' onchange=\"openWSE.CalendarViewApps.ChangeViewMode_Change('" + e + "', this);\">", o += "<option value='0'>Week</option>", o += "<option value='1'>Work Week</option>", o += "<option value='2'>List</option>", o += "</select><div class='clear'></div>", o += "</div></li>", o += "<li class='upcomingEvents-li' style='border-bottom: none!important;'><div class='section-pad'><h3 class='section-pad-title' style='padding-top: 3px!important;'>Upcoming Events</h3><div class='clear-space'></div>", o += "<div class='calendarEvents-upcoming'></div>", o += "</div></li>", o += "</ul>", o += "</div></div>" }(e) }(e), l = ""; "0" !== a[e].viewMode && "1" !== a[e].viewMode || (l = function (e) { for (var o = (p = a[e].dataObj.getMonth(), c = a[e].dataObj.getFullYear(), new Date(c, p + 1, 0).getDate() + 1), n = 1, i = "<table><tbody><tr class='days-of-week'><td data-dayofweek='0'>Sunday</td><td data-dayofweek='1'>Monday</td><td data-dayofweek='2'>Tuesday</td><td data-dayofweek='3'>Wednesday</td><td data-dayofweek='4'>Thursday</td><td data-dayofweek='5'>Friday</td><td data-dayofweek='6'>Saturday</td></tr>", r = 0; r < 6; r++) { i += "<tr class='table-Days'>"; for (var l = 0; l < 7; l++)n == o ? i += "<td class='not-apart-of-month' data-dayofweek='" + l + "'></td>" : 1 == n ? l == (s = e, void 0, new Date(t[a[s].dataObj.getMonth()] + "1, " + a[s].dataObj.getFullYear()).getDay()) ? (i += d(e, n, l), n++) : i += "<td class='not-apart-of-month' data-dayofweek='" + l + "'></td>" : (i += d(e, n, l), n++); i += "</tr>" } var s; var p, c; return i += "</tbody></table>" }(e)), a[e].container.addClass("calendarView"), a[e].container.attr("data-calendarid", e), a[e].container.html(r + "<div class='calendarViewHolder' data-viewmode='" + a[e].viewMode + "' onclick=\"openWSE.CalendarViewApps.CalendarViewHolder_Click('" + e + "');\">" + l + "</div>"), a[e].sidebarActive && a[e].container.append("<div class='calendarView-sidebar-open-overlay' onclick=\"openWSE.CalendarViewApps.CalendarViewHolder_Click('" + e + "');\"></div>"), a[e].container.find(".calendarViewHolder").css("height", n(e) + "px"), a[e].container.find(".calendarView-select").val(a[e].viewMode), "0" !== a[e].viewMode && "1" !== a[e].viewMode || a[s = e].container.find("tr.table-Days").each(function () { if ("0" === a[s].viewMode) { var e = $(this).find("td").length, t = $(this).find("td.not-apart-of-month").length; e === t && $(this).remove() } else if ("1" === a[s].viewMode) { var e = 5, t = 0; $(this).find("td").each(function () { "0" !== $(this).attr("data-dayofweek") && "6" !== $(this).attr("data-dayofweek") && $(this).hasClass("not-apart-of-month") && t++ }), e === t && $(this).remove() } }), null !== a[e].GetMonthInfoFunction && "function" == typeof a[e].GetMonthInfoFunction ? a[e].GetMonthInfoFunction(e, a[e].selectedMonth, a[e].selectedYear, a[e].searchVal) : (loadingPopup.RemoveMessage(p(e)), a[e].reloading = !1) } var s } function n(e) { return a[e].container.parent().outerHeight() - (a[e].container.find(".calendarView-toolbar").outerHeight() + 1) } function i(e, t) { var o, n, i = a[e].eventList; if (null !== i) if (2 === i.length ? (t || a[e].container.find(".calendarView-sidebar").find(".calendarEvents-upcoming").html(i[1]), i = i[0]) : a[e].container.find(".calendarView-sidebar").find(".upcomingEvents-li").hide(), "0" === a[e].viewMode || "1" === a[e].viewMode) { for (var d = 0; d < i.length; d++)if (6 == i[d].length) { var p = s(i[d][2]), c = i[d][3]; if ("1" === a[e].viewMode && c > 1) "0" === a[e].container.find("td.calendary-td[data-id='" + p + "']").attr("data-dayofweek") && (p = a[e].container.find("td.calendary-td[data-id='" + p + "']").next().attr("data-id"), c -= c > 6 ? 2 : 1); var u = a[e].container.find("td.calendary-td[data-id='" + p + "']").width(), h = c; if (c > 1) { for (var f = a[e].container.find("td.calendary-td[data-id='" + p + "']").next("td"), g = 0; g < c - 1; g++)f.length > 0 && (f.hasClass("not-apart-of-month") ? h-- : ("0" === a[e].viewMode || "1" === a[e].viewMode && "6" !== f.attr("data-dayofweek")) && (u += f.width(), f = f.next("td"))); u += h } r(e, i[d][0], i[d][1], u, i[d][4], i[d][5], c, p) } o = 0, n = 0, a[e].container.find(".table-Days").each(function (e) { var t = 2, a = 2, i = 0, r = 0; $(this).find("td").each(function (e) { t = i > r ? 2 : a, o = $(this).width(), $(this).find(".calendar-event").each(function (l) { $(this).css("margin-top", t + "px"); var s = $(this).width(), d = $(this).height(), p = Math.round(s / o); t += d + 1, p > 1 && n >= l ? (n = p, r = p + e, 1 == i && 2 == n ? a = 2 : a += d) : (i >= n && (a = 2), i++) }) }) }), a[e].container.find(".table-Days").each(function (e) { var t = $(this).find(".calendar-event"); if (t.length > 0) { var a = 0, o = new Array; t.each(function (e) { var n = parseInt(t.eq(e).css("margin-top").replace("px", "")); (function (e, t) { for (var a = 0; a < e.length; a++)if (e[a] == t) return !0; return !1 })(o, n) || (o.push(n), a += t[e].clientHeight) }), a += 40, $(this).css("min-height", a + "px") } }) } else if (!t) { a[e].container.find(".calendarViewHolder").html(""); for (d = 0; d < i.length; d++)6 == i[d].length && l(e, i[d][0], i[d][1], i[d][4], i[d][5]) } } function r(e, t, o, n, i, r, l, s) { var d = a[e].container.find("td.calendary-td[data-id='" + s + "']"); if (function (e, t, a) { if (a > 0 && 0 === t.find("." + e).length) return !0; return !1 }(t, d, l)) { var p = "<div class='calendar-event " + t + "' style='background: " + o + "; width: " + n + "px;' onmouseenter=\"openWSE.CalendarViewApps.CalendarEvent_MouseEnter('" + e + "', this);\" onmouseleave=\"openWSE.CalendarViewApps.CalendarEvent_MouseLeave('" + e + "');\" onclick=\"openWSE.CalendarViewApps.ViewEvent_Click('" + e + "', '" + t + "');\" title='" + i.replace("/n", " ") + "'>", c = i.replace("/n", " - "); 1 == l && (c = i.replace("/n", "<br />")), p += "<div class='calendar-event-font inline-block'>" + c + "</div></div>", d.append(p) } else a[e].container.find("." + t).length > 0 && d.find("." + t).css("width", n + "px") } function l(e, t, o, n, i) { var r = "<div class='calendar-event-list-view " + t + "' onclick=\"openWSE.CalendarViewApps.ViewEvent_Click('" + e + "', '" + t + "');\">"; r += "<span class='sch_ColorCode rounded-corners-15' style='background: " + o + ";'></span>", r += "<span class='calendarEvent-reason'>" + n.replace("/n", " ") + "</span><span class='calendarEvent-daterange'>" + i + "</span>", r += "</div>", a[e].container.find(".calendarViewHolder").append(r) } function s(e) { var t = e.split("_"); if (3 === t.length) { var a = parseInt(t[0]) + 1; 1 === a.toString().length && (a = "0" + a.toString()); var o = t[1]; 1 === o.toString().length && (o = "0" + o.toString()), e = a + "/" + o + "/" + t[2] } return e } function d(e, t, o) { var n = new Date, i = ""; n.getMonth() == a[e].dataObj.getMonth() && n.getDate() == t && n.getFullYear() == a[e].dataObj.getFullYear() && (i = " current-day"); var r = a[e].dataObj.getMonth() + 1; 1 === r.toString().length && (r = "0" + r.toString()); var l = t; return 1 === l.toString().length && (l = "0" + l.toString()), "<td data-id='" + r + "/" + l + "/" + a[e].dataObj.getFullYear() + "' class='calendary-td' data-dayofweek='" + o + "'><span class='calendar-td-day" + i + "' onclick=\"openWSE.CalendarViewApps.onDay_Click('" + e + "', this);\" title='Click to add event'>" + t + "</span></td>" } function p(e) { return e && 0 === (e = e.replace("#", "")).indexOf("app-") ? "#" + e.substring(4) + "-load" : null } return { InitializeCalendar: function (e, t) { if (null === a[e] || void 0 === a[e] ? a[e] = { dataObj: null, container: $(t.container), selectedMonth: null, selectedYear: null, AddNewCalendarFunction: t.AddNewCalendarFunction, GetMonthInfoFunction: t.GetMonthInfoFunction, ViewEventFunction: t.ViewEventFunction, searchVal: "", reloading: !1, eventList: null, viewMode: "0", sidebarActive: !1, sidebarLinkHtml: "" } : (a[e].container = $(t.container), a[e].AddNewCalendarFunction = t.AddNewCalendarFunction, a[e].GetMonthInfoFunction = t.GetMonthInfoFunction, a[e].ViewEventFunction = t.ViewEventFunction, a[e].reloading = "", a[e].eventList = null), null === a[e].selectedMonth && null === a[e].selectedYear) { var n = new Date; o(e, n.getMonth(), n.getFullYear()) } else o(e, a[e].selectedMonth, a[e].selectedYear) }, ResizeCalendars: function () { $(".calendarView").each(function () { var e = $(this).attr("data-calendarid"); a[e].container.find(".calendarViewHolder").css("height", n(e) + "px"), i(e, !0) }) }, BuildMonthEvents: function (e, t) { t.length > 0 && (a[e].eventList = t, i(e, !1)), a[e].reloading = !1, loadingPopup.RemoveMessage(p(e)) }, SearchCalendar: function (e, t) { a[e].searchVal = $.trim($(t.parentNode).find(".searchbox").val()), o(e, a[e].selectedMonth, a[e].selectedYear) }, SearchCalendar_KeyPress: function (e, t, n) { 13 != n.which && 13 != n.keyCode || (a[e].searchVal = $.trim($(t).val()), o(e, a[e].selectedMonth, a[e].selectedYear)) }, ClearSearch: function (e, t) { a[e].searchVal = "", $(t.parentNode).find(".searchbox").val(""), o(e, a[e].selectedMonth, a[e].selectedYear) }, onPrevMonth_Click: function (e) { var t = parseInt(a[e].container.find(".dd_monthSelect").val()), n = parseInt(a[e].container.find(".dd_yearSelect").val()); 0 == t ? (n -= 1, t = 11) : t -= 1, o(e, t, n) }, onNextMonth_Click: function (e) { var t = parseInt(a[e].container.find(".dd_monthSelect").val()), n = parseInt(a[e].container.find(".dd_yearSelect").val()); 11 == t ? (n += 1, t = 0) : t += 1, o(e, t, n) }, onMonthYear_Change: function (e) { o(e, parseInt(a[e].container.find(".dd_monthSelect").val()), parseInt(a[e].container.find(".dd_yearSelect").val())) }, onDay_Click: function (e, t) { if (null !== a[e].AddNewCalendarFunction && "function" == typeof a[e].AddNewCalendarFunction) if (null == t) { var o = new Date, n = o.getMonth() + 1; 1 === n.toString().length && (n = "0" + n.toString()); var i = o.getDate(); 1 === i.toString().length && (i = "0" + i.toString()); var r = o.getFullYear(); a[e].AddNewCalendarFunction(n + "/" + i + "/" + r, !1) } else a[e].AddNewCalendarFunction(t.parentNode.getAttribute("data-id"), !1) }, ViewEvent_Click: function (e, t) { null !== a[e].ViewEventFunction && "function" == typeof a[e].ViewEventFunction && a[e].ViewEventFunction(t) }, CalendarEvent_MouseEnter: function (t, o) { for (var n = openWSE.GetElementClassList(o), i = 0; i < n.length; i++)if ("calendar-event" != n[i] && "calendar-event-hover" != n[i]) { e = n[i]; break } a[t].container.find("." + e).hasClass("calendar-event-hover") || a[t].container.find("." + e).addClass("calendar-event-hover") }, CalendarEvent_MouseLeave: function (t) { e && a[t].container.find("." + e).removeClass("calendar-event-hover") }, ChangeViewMode_Change: function (e, t) { a[e].viewMode = t.value, o(e, a[e].selectedMonth, a[e].selectedYear) }, ToolbarMenu_Click: function (e) { var t = a[e].container.find(".calendarView-sidebar"); t.hasClass("active") ? (t.removeClass("active"), a[e].container.find(".calendarView-sidebar-open-overlay").remove(), a[e].sidebarActive = !1) : (t.addClass("active"), a[e].container.append("<div class='calendarView-sidebar-open-overlay' onclick=\"openWSE.CalendarViewApps.CalendarViewHolder_Click('" + e + "');\"></div>"), a[e].sidebarActive = !0) }, CalendarViewHolder_Click: function (e) { var t = a[e].container.find(".calendarView-sidebar"); t.hasClass("active") && (t.removeClass("active"), a[e].container.find(".calendarView-sidebar-open-overlay").remove(), a[e].sidebarActive = !1) }, RefreshCalendar: function (e) { o(e, a[e].selectedMonth, a[e].selectedYear) } } }(); function isCanvasSupported() { var e = document.createElement("canvas"); return !(!e.getContext || !e.getContext("2d")) } function noAnimationForSortableRows(e) { e ? $(".ui-sortable").find("tr.myItemStyle").each(function () { $(this).addClass("no-animation-hover") }) : $(".ui-sortable").find("tr.myItemStyle").each(function () { $(this).removeClass("no-animation-hover") }) } function AjaxCall(e, t, a, o, n, i) { if (e) { -1 === e.indexOf("http") && -1 === e.indexOf("www.") && -1 === e.indexOf("//") && (e = openWSE.siteRoot() + e); var r = { url: e }; t && (r.data = t), a || (a = { dataType: "json", type: "POST", contentType: "application/json; charset=utf-8" }), r.dataType = a.dataType ? a.dataType : "json", r.type = a.type ? a.type : "POST", r.contentType = a.contentType ? a.contentType : "application/json; charset=utf-8", null !== a.dataFilter && void 0 !== a.dataFilter && (r.dataFilter = a.dataFilter), null !== a.cache && void 0 !== a.cache && (r.cache = a.cache), null !== a.processData && void 0 !== a.processData && (r.processData = a.processData), o && "function" == typeof o && (r.success = o), r.error = n && "function" == typeof n ? n : function (e) { loadingPopup.RemoveMessage(), e && e.statusText && "OK" !== e.statusText && openWSE.AlertWindow(e) }, i && "function" == typeof i && (r.complete = i), a.promise && "function" == typeof a.promise ? $.ajax(r).done(a.promise) : $.ajax(r) } } function CallDoPostBack(e, t) { e || (e = ""), t || (t = ""), setTimeout(function () { __doPostBack(e, t) }, 1) } function UpdateLogoSizeOnLoad(e) { if (e && e.find(".title-logo").length > 0) { var t = e.find(".title-logo").css("background-image"); t && (-1 === (t = (t = t.substring(4)).substring(0, t.length - 1)).indexOf("'") && -1 === t.indexOf('"') && (t = "'" + t + "'"), $("body").append("<img id='tempTitleLogoEle' alt='' src=" + t + " style='visibility: hidden; position: fixed; z-index: -1; top: 0; left: 0;' />"), document.getElementById("tempTitleLogoEle").onload = function () { var t = $("#tempTitleLogoEle").outerWidth(); $("#tempTitleLogoEle").outerHeight() < t && (e.find(".title-text").addClass("large-img"), e.find(".title-logo").addClass("large-img"), $(".iframe-top-bar").length > 0 && $(".iframe-top-bar").find(".iframe-title-logo").addClass("large-img"), $("#tempTitleLogoEle").remove()) }, document.getElementById("tempTitleLogoEle").onerror = function () { $("#tempTitleLogoEle").remove() }) } } return { siteRoot: GetSiteRoot, topBarHt: topBarHt, AdjustTableSettingsBox: AdjustTableSettingsBox, IsComplexWorkspaceMode: IsComplexWorkspaceMode, PagedWorkspace: PagedWorkspace, SetContainerTopPos: SetContainerTopPos, AdjustModalWindowView: AdjustModalWindowView, ConvertBitToBoolean: ConvertBitToBoolean, OpenMobileWorkspace: OpenMobileWorkspace, init: init, InitializeSlimScroll: InitializeSlimScroll, SetLeftSidebarScrollTop: SetLeftSidebarScrollTop, UpdateAppSelector: UpdateAppSelector, SetDuplicateAppIcons: SetDuplicateAppIcons, NextSiteTip: NextSiteTip, PreviousSiteTip: PreviousSiteTip, CloseSiteTip: CloseSiteTip, CheckIfOverlaysExistsOnNonComplex: CheckIfOverlaysExistsOnNonComplex, DisableOverlaysOnPagedWorkspace: DisableOverlaysOnPagedWorkspace, CloseLoginModalWindow: CloseLoginModalWindow, OnError: OnError, autoupdate: autoupdate, SiteStatusAdmin_Clicked: SiteStatusAdmin_Clicked, CloseAdminOnlineInformationWindow: CloseAdminOnlineInformationWindow, AlertWindow: AlertWindow, CloseAlertWindow: CloseAlertWindow, ReportAlert: ReportAlert, ConfirmWindow: ConfirmWindow, ConfirmWindowAltBtns: ConfirmWindowAltBtns, CloseConfirmWindow: CloseConfirmWindow, OnBrowserClose: OnBrowserClose, SaveAccordionState: SaveAccordionState, CheckIfWorkspaceLinkAvailable: CheckIfWorkspaceLinkAvailable, RadioButtonStyle: RadioButtonStyle, RatingStyleInit: RatingStyleInit, UpdateAppRating: UpdateAppRating, ResetRating: ResetRating, OpenAppNoti: OpenAppNoti, SearchSite: SearchSite, SearchExternalSite: SearchExternalSite, LoadModalWindow: LoadModalWindow, SaveInnerModalContent: SaveInnerModalContent, LoadSavedInnerModalContent: LoadSavedInnerModalContent, ExpandAdminLinks: ExpandAdminLinks, HelpOverlay: HelpOverlay, HelpMenuPageLoad: HelpMenuPageLoad, NewUserPageLoad: NewUserPageLoad, NewUserfinsh: NewUserfinsh, HelpMenuPageLoadWorkspace: HelpMenuPageLoadWorkspace, HelpIntroRestart: HelpIntroRestart, HelpIntroNext: HelpIntroNext, HelpIntroBack: HelpIntroBack, OnEmailUpdate_KeyPress: OnEmailUpdate_KeyPress, OnPasswordUpdate_KeyPress: OnPasswordUpdate_KeyPress, UpdateEmail: UpdateEmail, UpdateAdminPassword: UpdateAdminPassword, ShowUpdatesPopup: ShowUpdatesPopup, ShowActivationPopup: ShowActivationPopup, CloseUpdatesPopup: CloseUpdatesPopup, OverlayDisable: OverlayDisable, TryAddLoadOverlay: TryAddLoadOverlay, TryRemoveLoadOverlay: TryRemoveLoadOverlay, CallOverlayList: CallOverlayList, AddRemoveOverlayClick: AddRemoveOverlayClick, UpdateOverlayTable: UpdateOverlayTable, GetUserNotifications: GetUserNotifications, NotiActionsHideInd: NotiActionsHideInd, UpdateNotificationCount: UpdateNotificationCount, CloseNoti: CloseNoti, LoadCreateAccountHolder: LoadCreateAccountHolder, LoadRecoveryPassword: LoadRecoveryPassword, LoadIFrameContent: LoadIFrameContent, LoadIFrameContentHistory: LoadIFrameContentHistory, CloseIFrameContent: CloseIFrameContent, BackgroundSelector: BackgroundSelector, ClearBackground: ClearBackground, updateBackgroundURL: updateBackgroundURL, updateBackgroundColor: updateBackgroundColor, BackgroundImageSelect_Clicked: BackgroundImageSelect_Clicked, BackgroundImageDelete_Clicked: BackgroundImageDelete_Clicked, BackgroundImageAddRemove_Clicked: BackgroundImageAddRemove_Clicked, SetBackgroundForWorkspaceDropdown: SetBackgroundForWorkspaceDropdown, HideTasks: HideTasks, ShowTasks: ShowTasks, LoadCurrentWorkspace: LoadCurrentWorkspace, Getworkspace: Getworkspace, HoverWorkspacePreview: HoverWorkspacePreview, SetWorkspaceNumber: SetWorkspaceNumber, AutoRotateWorkspace: AutoRotateWorkspace, AutoUpdateOnRotate: AutoUpdateOnRotate, ToggleMinimizedAppBar: ToggleMinimizedAppBar, AppsSortUnlocked: AppsSortUnlocked, CreateSOApp: CreateSOApp, BuildAppMinIcon: BuildAppMinIcon, LoadApp: LoadApp, LoadAppFromSiteTools: LoadAppFromSiteTools, DetermineNeedPostBack: DetermineNeedPostBack, WatchForLoad: WatchForLoad, LoadUserControl: LoadUserControl, MoveOutsideModalWindows: MoveOutsideModalWindows, ResizeAllAppBody: ResizeAllAppBody, ResizeAppBody: ResizeAppBody, ApplyOverlayFix: ApplyOverlayFix, RemoveOverlayFix: RemoveOverlayFix, MoveOffScreen: MoveOffScreen, MoveOnScreen_WorkspaceOnly: MoveOnScreen_WorkspaceOnly, MoveToCurrworkspace: MoveToCurrworkspace, SetAppMaxToMin: SetAppMaxToMin, SetAppMinToMax: SetAppMinToMax, HoverOverAppMin: HoverOverAppMin, HoverOutAppMin: HoverOutAppMin, NotiActionsClearAll: NotiActionsClearAll, CheckIfCanAddMore: CheckIfCanAddMore, SetActiveApp: SetActiveApp, SetDeactiveApps: SetDeactiveApps, SetDeactiveAll: SetDeactiveAll, LoadActiveAppCookie: LoadActiveAppCookie, MaximizeApp: MaximizeApp, StartRemoteLoad: StartRemoteLoad, LoadRemotely: LoadRemotely, SetRemoteLoadingOptions: SetRemoteLoadingOptions, SetAppIconActive: SetAppIconActive, AddworkspaceAppNum: AddworkspaceAppNum, RemoveworkspaceAppNum: RemoveworkspaceAppNum, RemoveAppIconActive: RemoveAppIconActive, CategoryClick: CategoryClick, LoadCategorySections: LoadCategorySections, LoadCategoryCookies: LoadCategoryCookies, ApplyAppDragResize: ApplyAppDragResize, ReloadApp: ReloadApp, AboutApp: AboutApp, AboutApp_PagedVersion: AboutApp_PagedVersion, UninstallApp: UninstallApp, PopOutFrame: PopOutFrame, PopOutFrameFromSiteTools: PopOutFrameFromSiteTools, PopOutTool: PopOutTool, MoveAppToworkspace: MoveAppToworkspace, GroupLoginModal: GroupLoginModal, GetandBuildGroupList: GetandBuildGroupList, LoginAsGroup: LoginAsGroup, HashChange: HashChange, AcceptGroupNotification: AcceptGroupNotification, MobileMode: MobileMode, ResizeContainer: ResizeContainer, GetElementClassList: GetElementClassList, ShowHideAccordianSidebar: ShowHideAccordianSidebar, ReloadPage: ReloadPage, ApplyMobileModeForMenuBar: ApplyMobileModeForMenuBar, BackgroundLoop: BackgroundLoop, ChangeImageFolder: ChangeImageFolder, UpdateBackgroundSetting: UpdateBackgroundSetting, ChangeUserProfileImage: ChangeUserProfileImage, CloseTopDropDowns: CloseTopDropDowns, ResizeTopDropDowns: ResizeTopDropDowns, RgbToHex: RgbToHex, HexToRgb: HexToRgb, UseDarkTextColorWithBackground: UseDarkTextColorWithBackground, GetAltColorFromHex: GetAltColorFromHex, GetScriptFunction: GetScriptFunction, SetCurrentWorkspaceBackground: SetCurrentWorkspaceBackground, LoadCSSFilesInApp: LoadCSSFilesInApp, InitializeSiteMenuTabs: InitializeSiteMenuTabs, LoadSiteMenuTab: LoadSiteMenuTab, ScrollToElement: ScrollToElement, TableFormulas: TableFormulas, GridViewMethods: GridViewMethods, CreateXMLHttpRequest: CreateXMLHttpRequest, InitializeThemeColorOption: InitializeThemeColorOption, ThemeColorOption_Clicked: ThemeColorOption_Clicked, ColorOption_Changed: ColorOption_Changed, ResetColorOption_Clicked: ResetColorOption_Clicked, SetNewThemeColorOptionFormat: SetNewThemeColorOptionFormat, HideSidebar: HideSidebar, CloseWindow: CloseWindow, AnimateToTop: AnimateToTop, SidebarNavToggleClicked: SidebarNavToggleClicked, LogConsoleMessage: LogConsoleMessage, CalendarViewApps: CalendarViewApps, noAnimationForSortableRows: noAnimationForSortableRows, AjaxCall: AjaxCall, CallDoPostBack: CallDoPostBack, UpdateLogoSizeOnLoad: UpdateLogoSizeOnLoad } }(); $(window).resize(function () { openWSE.SetContainerTopPos(!0), openWSE.ResizeContainer(); var e = openWSE.Getworkspace(); $("#MainContent_" + e).length > 0 ? openWSE.ResizeAllAppBody($("#MainContent_" + e)) : openWSE.ResizeAllAppBody($("body")), openWSE.ApplyMobileModeForMenuBar(), openWSE.AdjustModalWindowView(), openWSE.InitializeSlimScroll(), openWSE.ResizeTopDropDowns(), openWSE.CalendarViewApps.ResizeCalendars() }), $(document).ready(function () { openWSE.init(), openWSE.SetContainerTopPos(!1), openWSE.LoadCategoryCookies(), openWSE.GetUserNotifications(), openWSE.HashChange(), openWSE.ResizeContainer(), openWSE.SetDuplicateAppIcons(); var e = openWSE.Getworkspace(); openWSE.ResizeAllAppBody($("#MainContent_" + e)), $(".searchwrapper-tools-search").find("input[type='text']").length > 0 && ($.widget("custom.catcomplete", $.ui.autocomplete, { _create: function () { this._super(), this.widget().menu("option", "items", "> :not(.ui-autocomplete-category)") }, _renderMenu: function (e, t) { var a = this, o = ""; $.each(t, function (t, n) { var i; n.category != o && (e.append("<li class='ui-autocomplete-category'>" + n.category + "</li>"), o = n.category), i = a._renderItemData(e, n), n.category && (i.attr("aria-label", n.value), i.html(n.label)) }) } }), $(".searchwrapper-tools-search").find("input[type='text']").catcomplete({ minLength: 1, autoFocus: !0, open: function (e, t) { $(this).catcomplete("widget").css({ width: "auto", minWidth: "235px", maxWidth: "500px" }) }, source: function (e, t) { openWSE.AjaxCall("WebServices/AutoComplete.asmx/GetAppSearchList", "{ 'prefixText': '" + e.term + "', 'count': '10' }", { dataFilter: function (e) { return e } }, function (e) { t($.map(e.d, function (e) { return { label: e[1], value: e[0], category: e[2] } })) }) }, select: function (e, t) { setTimeout(function () { openWSE.SearchSite() }, 1) } }).focus(function () { $(this).catcomplete("search", "") })), openWSE_Config.hideSearchBarInTopBar && $(".searchwrapper-tools-search").addClass("hide-searchwarapper-tools-search"), openWSE.CheckIfOverlaysExistsOnNonComplex() }), $(function () { $(window).hashchange(function () { openWSE.HashChange() }), openWSE_Config.displayLoadingOnRedirect && ($("#lnk_BackToWorkspace, .app-icon-links, .app-icon-sub-links, .account-link-style").click("click", function (e) { if ("img-expand-sml" != e.target.className && "img-collapse-sml" != e.target.className) { var t = !1; try { var a = $(this).attr("href").substring($(this).attr("href").lastIndexOf("/") + 1).toLowerCase(), o = window.location.href.substring(window.location.href.lastIndexOf("/") + 1).toLowerCase(); a = a.split("?")[0], o = o.split("?")[0], -1 == a.indexOf(o) && -1 == o.indexOf(a) || (t = !0) } catch (e) { } "_blank" == $(this).attr("target") || t || $(this).attr("onclick") || loadingPopup.Message("Loading...") } }), openWSE.IsComplexWorkspaceMode() || $(".app-icon").click("click", function (e) { "app-options" != e.target.className && "_blank" != $(this).attr("target") && loadingPopup.Message("Loading...") })) }), window.onerror = function (e, t) { loadingPopup.RemoveMessage(), (-1 == (t = window.location.href).toLowerCase().indexOf("analytics.aspx") || "Uncaught TypeError: boolean is not a function" != e && "Script error." != e) && "error" !== e && "Script error." !== e && "Internal Server Error" !== e && (openWSE_Config.reportAlert ? openWSE_Config.reportOnError && openWSE.AlertWindow(e, t) : openWSE.OnError(e, t), openWSE.LogConsoleMessage(e)) }, window.onload = function () { openWSE.ApplyAppDragResize(); var e = openWSE.Getworkspace(); openWSE.ResizeAllAppBody($("#MainContent_" + e)), openWSE.LoadActiveAppCookie(), openWSE_Config.taskBarShowAll || ($(".app-min-bar").hide(), $("#MainContent_" + e).find(".app-main-holder").each(function (e) { var t = $(this).attr("data-appid"); 0 != $("#minimized_app_bar_holder").find(".app-min-bar[data-appid='" + t + "']").length && "none" == $("#minimized_app_bar_holder").find(".app-min-bar[data-appid='" + t + "']").css("display") && $("#minimized_app_bar_holder").find(".app-min-bar[data-appid='" + t + "']").show() })), openWSE.ToggleMinimizedAppBar(), openWSE.MoveOutsideModalWindows(), openWSE.ApplyMobileModeForMenuBar(), openWSE.SetCurrentWorkspaceBackground() }, function (e) { e.fn.extend({ slimScroll: function (a) { var o = e.extend({ width: "auto", height: "250px", size: "7px", color: "#000", position: "right", distance: "1px", start: "top", opacity: .4, alwaysVisible: !1, disableFadeOut: !1, railVisible: !1, railColor: "#333", railOpacity: .2, railDraggable: !0, railClass: "slimScrollRail", barClass: "slimScrollBar", wrapperClass: "slimScrollDiv", allowPageScroll: !1, wheelStep: 20, touchScrollStep: 200, borderRadius: "7px", railBorderRadius: "7px" }, a); return this.each(function () { function n(t) { if (d) { var a = 0; (t = t || window.event).wheelDelta && (a = -t.wheelDelta / 120), t.detail && (a = t.detail / 3), e(t.target || t.srcTarget || t.srcElement).closest("." + o.wrapperClass).is(b.parent()) && i(a, !0), t.preventDefault && !v && t.preventDefault(), v || (t.returnValue = !1) } } function i(e, t, a) { v = !1; var n = b.outerHeight() - S.outerHeight(); t && (t = parseInt(S.css("top")) + e * parseInt(o.wheelStep) / 100 * S.outerHeight(), t = Math.min(Math.max(t, 0), n), t = 0 < e ? Math.ceil(t) : Math.floor(t), S.css({ top: t + "px" })), t = (g = parseInt(S.css("top")) / (b.outerHeight() - S.outerHeight())) * (b[0].scrollHeight - b.outerHeight()), a && (e = (t = e) / b[0].scrollHeight * b.outerHeight(), e = Math.min(Math.max(e, 0), n), S.css({ top: e + "px" })), b.scrollTop(t), b.trigger("slimscrolling", ~~t), l(), s() } function r() { f = Math.max(b.outerHeight() / b[0].scrollHeight * b.outerHeight(), 30), S.css({ height: f + "px" }); var e = f == b.outerHeight() ? "none" : "block"; S.css({ display: e }) } function l() { r(), clearTimeout(u), g == ~~g ? (v = o.allowPageScroll, m != g && b.trigger("slimscroll", 0 == ~~g ? "top" : "bottom")) : v = !1, m = g, f >= b.outerHeight() ? v = !0 : (S.stop(!0, !0).fadeIn("fast"), o.railVisible && $.stop(!0, !0).fadeIn("fast")) } function s() { o.alwaysVisible || (u = setTimeout(function () { o.disableFadeOut && d || p || c || (S.fadeOut("slow"), $.fadeOut("slow")) }, 1e3)) } var d, p, c, u, h, f, g, m, v = !1, b = e(this); if (b.parent().hasClass(o.wrapperClass)) { var C = b.scrollTop(), S = b.siblings("." + o.barClass), $ = b.siblings("." + o.railClass); if (r(), e.isPlainObject(a)) { if ("height" in a && "auto" == a.height) { b.parent().css("height", "auto"), b.css("height", "auto"); var w = b.parent().parent().height(); b.parent().css("height", w), b.css("height", w) } else "height" in a && (w = a.height, b.parent().css("height", w), b.css("height", w)); if ("scrollTo" in a) C = parseInt(o.scrollTo); else if ("scrollBy" in a) C += parseInt(o.scrollBy); else if ("destroy" in a) return S.remove(), $.remove(), void b.unwrap(); i(C, !1, !0) } } else if (!(e.isPlainObject(a) && "destroy" in a)) { o.height = "auto" == o.height ? b.parent().height() : o.height, C = e("<div></div>").addClass(o.wrapperClass).css({ position: "relative", overflow: "hidden", width: o.width, height: o.height }), b.css({ overflow: "hidden", width: o.width, height: o.height }); $ = e("<div></div>").addClass(o.railClass).css({ width: o.size, height: "100%", position: "absolute", top: 0, display: o.alwaysVisible && o.railVisible ? "block" : "none", "border-radius": o.railBorderRadius, background: o.railColor, opacity: o.railOpacity, zIndex: 90 }), S = e("<div></div>").addClass(o.barClass).css({ background: o.color, width: o.size, position: "absolute", top: 0, opacity: o.opacity, display: o.alwaysVisible ? "block" : "none", "border-radius": o.borderRadius, BorderRadius: o.borderRadius, MozBorderRadius: o.borderRadius, WebkitBorderRadius: o.borderRadius, zIndex: 99 }), w = "right" == o.position ? { right: o.distance } : { left: o.distance }; $.css(w), S.css(w), b.wrap(C), b.parent().append(S), b.parent().append($), o.railDraggable && S.bind("mousedown", function (a) { var o = e(document); return c = !0, t = parseFloat(S.css("top")), pageY = a.pageY, o.bind("mousemove.slimscroll", function (e) { currTop = t + e.pageY - pageY, S.css("top", currTop), i(0, S.position().top, !1) }), o.bind("mouseup.slimscroll", function (e) { c = !1, s(), o.unbind(".slimscroll") }), !1 }).bind("selectstart.slimscroll", function (e) { return e.stopPropagation(), e.preventDefault(), !1 }), $.hover(function () { l() }, function () { s() }), S.hover(function () { p = !0 }, function () { p = !1 }), b.hover(function () { d = !0, l(), s() }, function () { d = !1, s() }), b.bind("touchstart", function (e, t) { e.originalEvent.touches.length && (h = e.originalEvent.touches[0].pageY) }), b.bind("touchmove", function (e) { v || e.originalEvent.preventDefault(), e.originalEvent.touches.length && (i((h - e.originalEvent.touches[0].pageY) / o.touchScrollStep, !0), h = e.originalEvent.touches[0].pageY) }), r(), "bottom" === o.start ? (S.css({ top: b.outerHeight() - S.outerHeight() }), i(0, !0)) : "top" !== o.start && (i(e(o.start).position().top, null, !0), o.alwaysVisible || S.hide()), window.addEventListener ? (this.addEventListener("DOMMouseScroll", n, !1), this.addEventListener("mousewheel", n, !1)) : document.attachEvent("onmousewheel", n) } }), this } }), e.fn.extend({ slimscroll: e.fn.slimScroll }) }(jQuery);
