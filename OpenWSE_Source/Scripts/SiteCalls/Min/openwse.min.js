// -----------------------------------------------------------------------------------
//
//	openWSE v3.6
//	by John Donnelly
//	Last Modification: 2/19/2015
//
//	Licensed under the Creative Commons Attribution 2.5 License - http://creativecommons.org/licenses/by/2.5/
//  	- Free for use in both personal and commercial projects
//		- Attribution requires leaving author name, author link, and the license info intact.
//
//  Requirements:
//      jquery v1.11.1 - http://code.jquery.com/jquery-1.11.1.min.js
//      migrate.jquery.min.js - http://code.jquery.com/jquery-migrate-1.2.1.min.js
//
// -----------------------------------------------------------------------------------
var openWSE_Config = { siteName: "", demoMode: !1, siteTheme: "Standard", animationSpeed: 200, hoverPreviewWorkspace: !1, taskBarShowAll: !0, ShowWorkspaceNumApp: !0, desktopCSS: "site_desktop.css", mobileCSS: "site_mobile.css", winMinWidth: 800, minPasswordLength: 6, workspaceMode: "", overlayPanelId: "pnl_OverlaysAll", reportAlert: !0, siteRootFolder: "", displayLoadingOnRedirect: !0 }, openWSE = function () {
    function e() { console.log(openWSE_Config), so = openWSE.siteRoot() + "WebServices/SaveControls.asmx", It(), jt(), $("#accordian-sidebar").AccordianTab({ allowCloseAll: !0, oneOpen: !0, startCollapsed: !0, animationSpeed: openWSE_Config.animationSpeed, createCookie: !0 }), $("#user_profile_tab").length > 0 && $("#user_profile_tab").find(".b").css("min-width", $(".top-options").outerWidth()), openWSE_Config.demoMode && $(".bgchange-icon").remove(), openWSE.CheckIfWorkspaceLinkAvailable() || $("#lnk_BackToWorkspace").length > 0 && $("#lnk_BackToWorkspace").remove() } function a(e, a) { var t = openWSE.siteRoot() + "WebServices/AppLog_Errors.asmx/AddError"; $.ajax({ url: t, type: "POST", data: '{ "message": "' + escape(e) + '","url": "' + escape(a) + '" }', contentType: "application/json; charset=utf-8" }) } function t() { if ($("#container_logo").length > 0) { var e = $("#container_logo").height(), a = $("#container_logo").width(), t = -(e / 2), o = -(a / 2); $("#container_logo").css({ marginLeft: o, marginTop: t }) } } function o(e) { wo = $("#always-visible").outerHeight(), Co = $("#container-footer").outerHeight(), "none" == $("#always-visible").css("display") && (wo = 0), "none" == $("#container-footer").css("display") && (Co = 0), $("#container, #iframe-container-helper").css("top", wo), $("#container, #iframe-container-helper, .administrator-workspace-note").css("bottom", Co), t(), e && ($("#iframe-content-src").length > 0 && ($("#iframe-content-src").css("height", $(window).height() - ($("#always-visible").height() + $("#container-footer").height())), $("#iframe-content-src").css("width", $(window).width())), openWSE.SetNoticiationsMaxHeight(), openWSE.SetDropDownMaxHeight()) } function i(e) { if (Ra("1"), "" != e && 0 != $(".app-icon[data-appid='" + e + "']").length) { ko = !0; var a = $($(".app-icon[data-appid='" + e + "']")[0]); $(".app-main-holder[data-appid='" + e + "']").addClass("auto-full-page"), $(".app-main-holder[data-appid='" + e + "']").find(".app-head, .app-head-button-holder").hide(), a.trigger("click") } } function n() { $("#" + openWSE_Config.overlayPanelId).append($(".addOverlay-bg")), $("#" + openWSE_Config.overlayPanelId).append($("#overlayEdit-element")), $(".addOverlay-bg").css({ bottom: $("#container-footer").outerHeight(), left: $("#sidebar_menulinks").outerWidth() }) } function s() { return "complex" == openWSE_Config.workspaceMode.toLowerCase() || "" == openWSE_Config.workspaceMode ? !0 : !1 } function l(e) { if (null != e && void 0 != e) { var a = $.trim(e.toString().toLowerCase()); if ("true" != a && "false" != a && "0" != a && "1" != a && "" != a) return !0; if ("1" == a || "true" == a || "" == a) return !0; if ("0" == a || "false" == a) return !1 } return !1 } function d() { return window.open(openWSE.siteRoot() + "AppRemote.aspx", "_blank", "toolbar=no, scrollbars=yes, resizable=yes, width=340, height=550"), !1 } function r(e) { var a = "<div class='trial-version-text'><span>Trial Version</span><span class='float-right'>Expires in " + e + "</span></div>"; $("#maincontent_overflow").prepend(a) } function c(e, a, t) { "" == Gt && "" != e && (Gt = e), "" == qt && "" != a && (qt = a), "" == Vt && "" != t && (Vt = t), "" != Gt && "" != qt && "" != Vt && 0 == Kt && ($.ajax({ url: a, data: '{ "_appId": "' + escape(Vt) + '" }', contentType: "application/json; charset=utf-8", dataType: "json", type: "POST", success: function (e) { var a = e.d[0]; if ("TURNOFF" == a) return void (Kt = 1); if ("refresh" == a) Kt = 0, document.getElementById(Gt).value = "refresh", __doPostBack(Gt, ""); else if ("false" != a && "" != a) try { openWSE.ConvertBitToBoolean(e.d[1]) ? (Kt = 0, f("Receiving Request..."), ft(a, Gt, qt, Vt)) : (Kt = 0, document.getElementById(Gt).value = a, __doPostBack(Gt, "")) } catch (t) { Kt = 0, c(Gt, qt, Vt) } else Kt = 0, c(Gt, qt, Vt) }, error: function () { Kt = 0, c(Gt, qt, Vt) } }), Kt = 1) } function h() { 0 == $(".pnl-section").length && $(".table-settings-box").length > 0 ? $(".table-settings-box").eq($(".table-settings-box").length - 1).addClass("no-border") : $(".pnl-section").length > 0 && $(".table-settings-box").length > 0 && $(".pnl-section").each(function () { var e = $(this).find(".table-settings-box").length; $(this).find(".table-settings-box").eq(e - 1).addClass("no-border") }) } function f(e) { u(), -1 != e.indexOf("...") && (e = e.replace("...", "")), e += "<span class='progress inline-block'></span>"; var a = "<div id='update-element'><div class='update-element-overlay'><div class='update-element-align'>"; a += "<div class='update-element-modal'>" + Qt + "<h3 class='inline-block'>" + e + "</h3></div></div></div></div>", $("body").append(a), m($("#update-element").find(".progress")[0]), $("#update-element").show(); var t = $("#update-element").find(".update-element-modal"), o = -(t.outerWidth() / 2), i = -(t.outerHeight() / 2); t.css({ marginLeft: o, marginTop: i }) } function m(e) { Wo = setInterval(function () { var a = ""; switch (xo) { case 0: a = ".", xo++; break; case 1: a = "..", xo++; break; case 2: a = "...", xo++; break; default: a = "", xo = 0 } $(e).html(a) }, 500) } function u() { null != Wo && clearInterval(Wo), $("#update-element").remove() } function v(e, a) { ("" == e || null == e) && (e = "An error has occured that was not specified."); var t = "<div id='AlertWindow-element' class='Modal-element' style='display: none;'>"; t += "<div class='Modal-overlay'>", t += "<div class='Modal-element-align'>", t += "<div class='Modal-element-modal'>", t += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>", t += "<a href='#' onclick=\"openWSE.CloseAlertWindow();return false;\" class='ModalExitButton'></a>", t += "</div><span class='Modal-title'></span></div></div>"; var o = "<input class='input-buttons confirm-ok-button' type='button' value='Ok' onclick=\"openWSE.CloseAlertWindow();\" style='width: 50px;' />", i = ""; openWSE_Config.reportAlert && (i = "<input class='input-buttons no-margin confirm-report-button' type='button' value='Report' onclick=\"openWSE.ReportAlert('" + escape(e) + "','" + escape(a) + "');\" style='margin-left: 16px!important;' />"), "" == openWSE_Config.siteTheme && (openWSE_Config.siteTheme = "Standard"); var n = "<img alt='confirm' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Icons/alert.png' />"; t += "<div class='ModalPadContent'><div class='message-text'>" + n + e + "</div><div class='button-holder'>" + o + i + "</div></div>", t += "</div></div></div></div>", $("body").append(t), R(!0, "AlertWindow-element", "Message"), setTimeout(function () { $("#AlertWindow-element").find(".confirm-ok-button").focus() }, 250) } function g() { $("#AlertWindow-element").length > 0 && ($("#AlertWindow-element").hide(), $("#AlertWindow-element").remove()) } function b(e, t) { ("" == t || null == t) && (t = window.location.href), a(unescape(e), unescape(t)), g() } function y(e, a, t) { ("" == e || null == e) && (e = "Are you sure you want to continue?"); var o = "<div id='ConfirmWindow-element' class='Modal-element' style='display: none;'>"; o += "<div class='Modal-overlay'>", o += "<div class='Modal-element-align'>", o += "<div class='Modal-element-modal'>", o += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>", o += "<a href='#' onclick=\"openWSE.CloseConfirmWindow();return false;\" class='ModalExitButton confirm-cancel-button-header'></a>", o += "</div><span class='Modal-title'></span></div></div>"; var i = "<input class='input-buttons confirm-ok-button' type='button' value='Ok' style='width: 60px;' />", n = "<input class='input-buttons confirm-cancel-button' type='button' value='Cancel' />"; "" == openWSE_Config.siteTheme && (openWSE_Config.siteTheme = "Standard"); var s = "<img alt='confirm' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Icons/confirm.png' />"; o += "<div class='ModalPadContent'><div class='message-text'>" + s + e + "</div><div class='button-holder'>" + i + n + "</div></div></div>", o += "</div></div></div></div>", $("body").append(o), $("#ConfirmWindow-element").find(".confirm-ok-button").one("click", function () { openWSE.CloseConfirmWindow(), null != a && a() }), $("#ConfirmWindow-element").find(".confirm-cancel-button, .confirm-cancel-button-header").one("click", function () { openWSE.CloseConfirmWindow(), null != t && t() }), R(!0, "ConfirmWindow-element", "Confirmation"), setTimeout(function () { $("#ConfirmWindow-element").find(".confirm-ok-button").focus() }, 250) } function w() { $("#ConfirmWindow-element").length > 0 && ($("#ConfirmWindow-element").hide(), $("#ConfirmWindow-element").remove()) } function C() { $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/OnBrowserClose", data: "", dataType: "json", type: "POST", contentType: "application/json; charset=utf-8", dataFilter: function (e) { return e } }) } function S() { var e = !1; return $("#pnl_settingLinks").find(".app-icon-links").each(function () { var a = $(this).find(".app-icon-font"); "workspace" == a.html().toLowerCase() && (e = !0) }), e } function k() { $(".switch").each(function () { var e = $(this); if (0 == e.find(".RadioButton-Toggle-Overlay").length) { var a = $(this).find(".cb-enable"), t = $(this).find(".cb-disable"); if (0 == e.find(".switch-slider").length) { e.append("<div class='switch-slider'><table class='switch-slider-table' cellpadding='0' cellspacing='0'><tbody><tr><td class='td-enable'></td><td class='td-switch' title='Click or Drag'></td><td class='td-disable'></td></tr></tbody></table></div>"), e.find(".td-enable").append(a), e.find(".td-switch").html("<span class='RadioButton-Toggle-Overlay'></span>"), e.find(".td-disable").append(t), a.removeClass("RandomActionBtns"), t.removeClass("RandomActionBtns"); var o = e.find(".cb-enable").outerWidth(); 0 == o && (o = e.find(".cb-enable").find("label").outerWidth()); var i = o + e.find(".RadioButton-Toggle-Overlay").outerWidth(); e.width(i - 2); var n = e.outerWidth() - e.find(".RadioButton-Toggle-Overlay").outerWidth() + 2, s = a.find("input"), l = t.find("input"); _(s) && s.prop("checked") || a.hasClass("selected") ? (a.addClass("selected"), t.removeClass("selected"), s.prop("checked", !0), l.prop("checked", !1), e.find(".switch-slider").css("left", 0)) : (t.addClass("selected"), a.removeClass("selected"), l.prop("checked", !0), s.prop("checked", !1), e.find(".switch-slider").css("left", -n)) } else e.find(".td-switch").html("<span class='RadioButton-Toggle-Overlay'></span>"); e.find(".switch-slider").draggable({ cancel: ".cb-enable, .cb-disable", axis: "x", drag: function (e, a) { var t = $(this).parent().outerWidth() - $(this).find(".RadioButton-Toggle-Overlay").outerWidth() + 2; return a.position.left < -t ? ($(this).css("left", -t), !1) : a.position.left >= 0 ? ($(this).css("left", 0), !1) : void 0 }, stop: function (a, t) { var o = $(this).parent().outerWidth() - $(this).find(".RadioButton-Toggle-Overlay").outerWidth() + 2, i = o / 2, n = !1, s = !0; e.find(".cb-disable").each(function () { { var e = $(this).find("input"); e.attr("checked") } $(this).hasClass("selected") && (s = !1) }), t.position.left > -i ? (n = !0, $(this).animate({ left: 0 }, openWSE_Config.animationSpeed)) : $(this).animate({ left: -(2 * i) }, openWSE_Config.animationSpeed), s && !n ? (Eo = !0, e.find(".cb-disable").find("input").trigger("click")) : !s && n && (Eo = !0, e.find(".cb-enable").find("input").trigger("click")) } }) } }) } function _(e) { var a = $(e)[0].attributes.checked; return "undefined" != typeof a && a !== !1 ? !0 : !1 } function W(e, a, t, o, i) { try { var n = !1; t && (n = !0); var s = openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme; $(e).attr("data-average", a), $(e).attr("data-id", "1"); var l = "big"; i || (l = "small"), $(e).jRating({ step: !0, type: l, showRateInfo: !1, canRateAgain: !0, nbRates: 100, bigStarsPath: s + "/Icons/star-rating-lrg.png", smallStarsPath: s + "/Icons/star-rating-sml.png", isDisabled: n, decimalLength: 2, length: 4, rateMax: 4, rateMin: 0, phpPath: "", sendRequest: !0, onClick: function (n, s) { $("#AppRating-element").remove(); var l = "<div id='AppRating-element' class='Modal-element'><div class='Modal-overlay'><div class='Modal-element-align'><div class='Modal-element-modal' style='min-width: 350px;'>"; l += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'></div><span class='Modal-title'></span></div></div>", l += "<div class='ModalPadContent'></div></div></div></div></div>", $("#aboutApp-element").find(".ModalPadContent").append(l); var p = "<div class='pad-bottom'>Add a comment to your rating or just press Submit.</div>"; p += "<textarea id='app-rating-comment' rows='4' cols='40' style='width: 96%; font-family: arial; font-size: 14px; padding: 5px; border: 1px solid #DDD;'></textarea>", p += "<div class='clear-space'></div>", p += "<input class='float-left no-margin input-buttons' type='button' value='Cancel' onclick='openWSE.ResetRating(\"" + e + '", "' + a + '", ' + t + ', "' + o + '", ' + i + ');$("#AppRating-element").remove();\' />', p += "<input class='float-right no-margin input-buttons' type='button' value='Submit' onclick='openWSE.UpdateAppRating(\"" + e + '", "' + s + '", ' + t + ', "' + o + '", ' + i + ");' />", p += "<div class='clear-space-five'></div>", $("#AppRating-element").find(".ModalPadContent").html(p), R(!0, "AppRating-element", "Rating Comment") } }), i || $(e).find(".jStar").addClass("jStar-Small") } catch (p) { } } function x(e, a, t, o, i) { f("Updating rating..."), $.ajax({ url: openWSE.siteRoot() + "WebServices/SaveControls.asmx/UpdateAppRating", type: "POST", data: '{ "rating": "' + a + '","appId": "' + o + '","description": "' + $("#app-rating-comment").val() + '" }', contentType: "application/json; charset=utf-8", success: function () { $("#AppRating-element").remove(), openWSE.RemoveUpdateModal(), openWSE.ResetRating(e, a, t, o, i) } }) } function E(e, a, t, o, i) { $(e).html(""), W(e, a, t, o, i) } function M(e) { if ($(".top-options li.a").removeClass("active"), $(".top-options li.b").hide(), openWSE.IsComplexWorkspaceMode()) if ($("#workspace_holder").length > 0) { if ("none" == $("#" + e).css("display")) { ro = 1; var a = Ba(); Da($(".app-main-holder[data-appid='" + e + "']"), a) } } else P($(".app-icon[data-appid='" + e + "']")); else window.location.href = openWSE.siteRoot() + "Workspace.aspx?AppPage=" + _id } function A() { var e = $.trim($("#searchbox-app-search").val()); "" != e && (f("Searching. Please Wait..."), document.getElementById("hf_SearchSite").value = e, $("#searchbox-app-search").val(""), __doPostBack("hf_SearchSite", "")) } function T() { $("#searchbox-app-search").val("workspace-selector" == $("#searchbox-app-search").parent().parent().attr("id") ? "Search" : "") } function O(e) { $(".top-options li.a").removeClass("active"), $(".top-options li.b").hide(), window.open("http://google.com/search?q=" + e) } function P(e) { var a = $(e), t = "<div id='ConfirmApp-element' class='Modal-element' style='display: none;'>"; t += "<div class='Modal-overlay'>", t += "<div class='Modal-element-align'>", t += "<div class='Modal-element-modal' style='width: 400px; min-width: 400px;'>", t += "<div class='ModalHeader'><div><span class='Modal-title'></span></div></div>"; var o = a.find(".app-icon-font").text(); "" == o && (o = a.find(".app-title").text(), "" == o && (o = a.find("span").text())); var i = a.attr("data-appid"), n = ""; if ("" != a.attr("popoutloc") && void 0 != a.attr("popoutloc") && null != a.attr("popoutloc")) { var s = a.attr("popoutloc"); n = "<a href='#' class='float-right' onclick='openWSE.PopOutFrameFromSiteTools(\"" + o + '", "' + s + "\");return false;'>Open in new window</a>" } var l = "1"; "" != a.attr("currentworkspace") && void 0 != a.attr("currentworkspace") && null != a.attr("currentworkspace") && (l = a.attr("currentworkspace")); var p = "<input type='button' class='input-buttons' value='Yes' style='width: 50px;' onclick='openWSE.LoadAppFromSiteTools(\"" + i + '", "' + o + '", "workspace_' + l + "\");' />", d = "<input type='button' class='input-buttons no-margin' value='No' style='width: 50px; margin-left: 10px!important;' onclick=\"$('#ConfirmApp-element').remove();return false;\" />", r = "You must be on the workspace to load this app. Would you like to go back to your workspace?"; if (!openWSE.CheckIfWorkspaceLinkAvailable()) { p = ""; var d = "<input type='button' class='input-buttons no-margin' value='Close' onclick=\"$('#ConfirmApp-element').remove();return false;\" />"; r = "You are not authorized to use the workspace. ", "" != n && (r += "However, you can open this app in a seperate window.") } t += "<div class='ModalPadContent'>", t += r + "<div class='clear' style='height: 20px;'></div>" + p + d + n, t += "<div class='clear-space'></div></div>", t += "</div></div></div></div>", $("body").append(t), openWSE.LoadModalWindow(!0, "ConfirmApp-element", "Open " + o) } function R(e, a, t) { 0 != a.indexOf("#") && (a = "#" + a); var o = $(a); if (e) { o.show(); var i = o.find(".Modal-element-modal"); i.outerWidth() > $(window).width() && (i.css({ minWidth: 50, width: $(window).width() }), i.find(".ModalPadContent").css("overflow", "auto")), o.find(".Modal-element-align").css({ marginTop: -(o.find(".Modal-element-modal").height() / 2), marginLeft: -(o.find(".Modal-element-modal").width() / 2) }); var n = "#container"; (0 == $("#container").length || o.hasClass("outside-main-app-div") && $(".workspace-holder").length > 0) && (n = $("#maincontent_overflow").length > 0 ? "#maincontent_overflow" : "body"), i.draggable({ containment: n, cancel: ".ModalPadContent, .ModalExitButton, #MainContent_pwreset_overlay", drag: function () { var e = $(this); if (e.css("opacity", "0.6"), e.css("filter", "alpha(opacity=60)"), e.find("iframe").length > 0) { var a = e.find(".ModalPadContent"); $wo = a.find(".app-overlay-fix"), 0 == $wo.length && 1 == a.length && a.append("<div class='app-overlay-fix'></div>") } }, stop: function () { var e = $(this); e.css("opacity", "1.0"), e.css("filter", "alpha(opacity=100)"), $wo = $(this).find(".app-overlay-fix"), 1 == $wo.length && $wo.remove() } }), "" != t && o.find(".Modal-title").html(t), o.css("visibility", "visible") } else o.hide(), o.css("visibility", "hidden"), o.find(".Modal-title").html(""), o.find(".Modal-element-modal").find(".ModalPadContent").css("overflow", ""), setTimeout(function () { if (o.hasClass("outside-main-app-div")) for (var e = Dt(o[0]), a = 0; a < e.length; a++) if (e[a].indexOf(_o) > 0) { var t = e[a].replace(_o, ""); pt($(".app-main-holder[data-appid='" + t + "']")); break } }, 25) } function B(e) { try { var a = e.get_postBackElement(); null != a && ("hf_UpdateAll" == a.id || "MainContent_hf_UpdateAll" == a.id) && 0 == ao.length && (ao = new Array, $(".Modal-element").each(function () { var e = $(this); if ("block" == e.css("display") && 0 == e.find("iframe").length) { var a = escape($.trim(e.find(".ModalPadContent").html())); if ("" != a && "undefined" != a && null != a) { var t = new Array; "" != e.attr("id") && (t[0] = e.attr("id"), t[1] = a, ao.push(t)) } } })) } catch (t) { } if ("none" != $(".Modal-element").css("display")) { var o = $(".Modal-element").find(".modal-inner-scroll"); o.length > 0 && (Jt = o.scrollTop()) } } function I() { if (ao.length > 0 && ($(".Modal-element").each(function () { var e = $(this); if ("block" == e.css("display") && 0 == e.find("iframe").length) for (var a = 0; a < ao.length; a++) if (ao[a][0] == e.attr("id")) { var t = unescape(ao[a][1]); e.find(".ModalPadContent").html(t); break } }), ao = new Array), "block" == $(".Modal-element").css("display")) { var e = $(".Modal-element").find(".modal-inner-scroll"); e.length > 0 && (e.scrollTop(Jt), Jt = 0) } } function L() { var e = cookie.get("top_menu"); "" != e && null != e && void 0 != e && $(".top-options li.b").each(function (a) { if (a == e) { $(this).show(); var t = $(this).prev(); 1 == t.length && t.addClass("active"), z() } }) } function z() { $(".top-options li.b").each(function () { if ($(this).is(":visible")) { var e = $(window).height() - 98; $(this).find(".li-pnl-tab").css("max-height", e) } }) } function N(e) { "none" == $("#help_main_holder").css("display") ? ($("#iframe-container-helper").length > 0 && ka(), To = e, setTimeout(function () { var e = "", a = window.location.hash; e = -1 == a.indexOf("#") && "#" != window.location.href.charAt(window.location.href.length - 1) ? "#?" : "" != a ? "&" : "?", e += "help", window.location += e }, openWSE_Config.animationSpeed)) : Q() } function j() { var e = so + "/GetTotalHelpPages"; $.ajax({ url: e, type: "POST", data: '{ "currentPage": "' + document.location.href + '" }', contentType: "application/json; charset=utf-8", success: function (e) { var a = parseInt(e.d); a > 0 ? (oo = a, H(0, To), $("#help_main_holder").fadeIn(openWSE_Config.animationSpeed)) : To ? (F(), $("#help_main_holder").fadeIn(openWSE_Config.animationSpeed)) : (openWSE.AlertWindow("There are no help pages available for this webpage."), Q()) }, error: function () { To ? (F(), $("#help_main_holder").fadeIn(openWSE_Config.animationSpeed)) : (openWSE.AlertWindow("There was an error retrieving the help pages. Please try again."), Q()) } }) } function H(e, a) { var t = "<span class='pad-left'>Welecome to " + openWSE_Config.siteName + "</span>"; a || (t = "<span class='pad-left'>" + openWSE_Config.siteName + " Help Pages</span>"); var o = ""; a || (o += "<input type='button' class='input-buttons float-left' onclick='openWSE.HelpOverlay(false, " + Po + ")' value='Close' />"), oo > e + 1 ? o += "<input type='button' class='input-buttons float-right' onclick='openWSE.HelpMenuPageLoad(" + (e + 1).toString() + "," + a + ")' value='Next' />" : e + 1 == oo && a && (o += "<input type='button' class='input-buttons float-right' onclick='openWSE.NewUserPageLoad()' value='Next' />"), e > 0 && (o += "<input type='button' class='input-buttons float-right' onclick='openWSE.HelpMenuPageLoad(" + (e - 1).toString() + "," + a + ")' value='Back' />"), $("#helpmenu_title").html("<div class='help-Title-Top'>" + t + o + "</div>"), e += 1; var i = document.location.href; i = i.substring(i.lastIndexOf("/") + 1), i = i.replace(i.substring(i.indexOf(".")), ""), f("Loading..."), $("#helpdiv_pageholder").load(openWSE.siteRoot() + "HelpPages/" + i + "/HelpPage" + e + ".html", function () { u(), $(".help-images-workspace-img").each(function () { if (!$(this).hasClass("ignoreSrc")) { var e = $(this).attr("src"); $(this).attr("src", openWSE.siteRoot() + "HelpPages/" + i + "/images/" + e) } }) }) } function F() { var e = "<span class='pad-left'>Welecome to " + openWSE_Config.siteName + "</span>", a = ""; a += "<input id='btnFinish' type='button' class='input-buttons float-right display-none' onclick='openWSE.NewUserfinsh()' value='Finish' />", oo > 0 && (a += "<input type='button' class='input-buttons float-right' onclick='openWSE.HelpMenuPageLoad(" + (oo - 1).toString() + ",true)' value='Back' />"), $("#helpmenu_title").html("<div class='help-Title-Top'>" + e + a + "</div>"), $("#helpdiv_pageholder").html("<div style='position: absolute; top: 50%; left: 50%; margin-left: -95px; margin-top: -45px; padding: 20px;'><div class='loading-icon-lrg margin-top-sml'></div><h3 style='color: #FFF; float: left; font-weight: bold;'>Loading Step....</h3></div>"), f("Loading..."), $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/CheckForEmailAddress", data: "", type: "POST", contentType: "application/json; charset=utf-8", success: function (e) { Oo = openWSE.ConvertBitToBoolean(e.d[0]), Po = openWSE.ConvertBitToBoolean(e.d[1]); var a = ""; a = Oo || Po ? G() : Y(), $("#helpdiv_pageholder").html(a), setTimeout(function () { Mo ? $("#tb_emailaddress_update").focus() : Ao && $("#tb_newpassword_update").focus() }, 500), u() } }) } function U() { var e = $.trim($("#tb_emailaddress_update").val()); "" != e && (f("Updating..."), $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/AddEmailAddress", data: '{"email": "' + escape(e) + '"}', type: "POST", contentType: "application/json; charset=utf-8", success: function (e) { openWSE.ConvertBitToBoolean(e.d) && (Oo = !1, $("#update-email-helpdiv").remove()), 0 == $("#update-password-helpdiv").length && F(), u() } })) } function D() { var e = $.trim($("#tb_newpassword_update").val()), a = $.trim($("#tb_confirmnewpassword_update").val()); $("#span_passwordmismatch").html(""), "" == e ? $("#span_newpassword_update").show() : $("#span_newpassword_update").hide(), "" == a ? $("#span_confirmnewpassword_update").show() : $("#span_confirmnewpassword_update").hide(), e == a && "" != e && "" != a ? e.length < openWSE_Config.minPasswordLength ? $("#span_passwordmismatch").html("Password does not meet requirements.") : (f("Updating..."), $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/UpdateAdminPassword", data: '{"password1": "' + escape(e) + '"}', type: "POST", contentType: "application/json; charset=utf-8", success: function (e) { openWSE.ConvertBitToBoolean(e.d) && (Po = !1, $("#update-password-helpdiv").remove()), 0 == $("#update-email-helpdiv").length && F(), u() } })) : "" != e && "" != a && $("#span_passwordmismatch").html("Passwords do not match.") } function G() { var e = ""; return Oo ? (Mo = !0, Ao = !1, e += "<div id='update-email-helpdiv' class='pad-all' align='center'>", e += "<h3>Before you can continue, you must provide a valid email address.<br />This email address will be used for notifications and password recovery.<br />If you fail to provide a valid email address, you will not be able to use the password recovery feature on the login page.</h3>", e += "<div class='clear-space'></div>", e += "<div class='clear-space'></div>", e += "<h3>Please provide a valid email address</h3>", e += "<div class='clear-space'></div>", e += "<span class='pad-right font-bold'>Email Address</span><input type='text' id='tb_emailaddress_update' onkeypress='openWSE.OnEmailUpdate_KeyPress(event)' class='textEntry margin-right' style='width: 200px;' />", e += "<input type='button' class='input-buttons' onclick='openWSE.UpdateEmail()' value='Update' />", e += "<div class='clear-space'></div>", e += "<div class='clear-space'></div>", e += "<div class='clear-space'></div>", e += "</div>") : Po && (Mo = !1, Ao = !0, e += "<div id='update-password-helpdiv' class='pad-all' align='center'>", e += "<h3>You are currently signed in as Administrator. Create a new password for your Administrator account.</h3>", e += "<div class='clear-space-two'></div><small><b class='pad-right-sml'>Note:</b>Password must be at least " + openWSE_Config.minPasswordLength + " characters long.</small>", e += "<div class='clear-space'></div><table border='0' cellpadding='0' cellspacing='0'>", e += "<tr><td align='right'><span class='pad-right font-bold'>New Password:</span></td>", e += "<td align='left'><input type='password' id='tb_newpassword_update' onkeypress='openWSE.OnPasswordUpdate_KeyPress(event)' class='textEntry margin-right' style='width: 200px;' /><span id='span_newpassword_update' style='display: none; color: Red;'>*</span></td></tr>", e += "<tr><td></td><td><div class='clear-space'></div></td></tr>", e += "<tr><td align='right'><span class='pad-right font-bold'>Confirm New Password:</span></td>", e += "<td align='left'><input type='password' id='tb_confirmnewpassword_update' onkeypress='openWSE.OnPasswordUpdate_KeyPress(event)' class='textEntry margin-right' style='width: 200px;' /><span id='span_confirmnewpassword_update' style='display: none; color: Red;'>*</span></td></tr></table>", e += "<div class='clear-space'></div>", e += "<input type='button' class='input-buttons no-margin' onclick='openWSE.UpdateAdminPassword()' value='Change Password' />", e += "<div class='clear-space'></div>", e += "<span id='span_passwordmismatch' style='color: Red;'></div>", e += "</div>"), e } function q(e) { (13 == e.which || 13 == e.keyCode) && (openWSE.UpdateEmail(), e.preventDefault()) } function V(e) { (13 == e.which || 13 == e.keyCode) && (openWSE.UpdateAdminPassword(), e.preventDefault()) } function Y() { var e = ""; return e = "<div class='pad-all' align='center'>", e += "<h3>You are now setup. Please click finish to load your workspace. You can change your email address within your 'Account Settings' page. If you need help in the future, click on the help icon at the bottom left hand corner of the workspace.</h3>", e += "<h3>By using this site you agree that OpenWSE can save cookies to your device. These cookies contain no information regarding your personal information.</h3>", e += "</div>", $("#btnFinish").removeClass("display-none"), e } function K() { $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/UpdateAcctNewMember", data: "", type: "POST", contentType: "application/json; charset=utf-8", success: function (e) { var a = e.d; openWSE.ConvertBitToBoolean(a) && (window.location = openWSE.siteRoot() + "Workspace.aspx") } }) } function Q() { To = !1, Po = !1, "block" == $("#help_main_holder").css("display") && $("#help_main_holder").fadeOut(openWSE_Config.animationSpeed, function () { $("#helpmenu_title, #helpdiv_1, #helpdiv_2").html("") }); try { var e = window.location.href; if (-1 != e.indexOf("?help")) { var a = e.split("?help"); if (a.length > 1) { var t = "?help" + a[1]; e = e.replace(t, ""), window.location = e } else e = e.replace("?help", ""); window.location = e } else if (-1 != e.indexOf("&help")) { var a = e.split("&help"); if (a.length > 1) { var t = "&help" + a[1]; e = e.replace(t, "") } else e = e.replace("&help", ""); window.location = e } } catch (o) { } } function X(e) { $(window).load(function () { var a = unescape(e), t = "<div id='OpenWSEUpdates-element' class='Modal-element' style='display: none;'>"; t += "<div class='Modal-overlay'>", t += "<div class='Modal-element-align'>", t += "<div class='Modal-element-modal'>", t += "<div class='ModalHeader'><div><span class='Modal-title'></span></div></div>", t += "<div class='ModalPadContent'>" + a + "</div>", t += "</div></div></div></div></div>", $("body").append(t), openWSE.LoadModalWindow(!0, "OpenWSEUpdates-element", "Site Updates") }) } function J(e) { $(window).load(function () { var a = unescape(e), t = "<div id='Activation-element' class='Modal-element' style='display: none;'>"; t += "<div class='Modal-overlay'>", t += "<div class='Modal-element-align'>", t += "<div class='Modal-element-modal'>", t += "<div class='ModalHeader'><div><span class='Modal-title'></span></div></div>"; var o = "<img alt='' class='float-left pad-right-sml' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/App/approve.png' />", i = "<span style='font-size: 18px'>Got it</span>", n = "<a href='" + openWSE.siteRoot() + "Workspace.aspx' class='input-buttons no-margin' style='text-decoration: none!important;'>" + o + " " + i + "</a>"; t += "<div class='ModalPadContent'>" + a + "<div class='clear-space'></div><div align='center'>" + n + "</div>", t += "</div></div></div></div></div></div>", $("body").append(t), openWSE.LoadModalWindow(!0, "Activation-element", "Activation") }) } function Z() { $("#OpenWSEUpdates-element").remove() } function ea(e) { f("Closing Overlay..."); var a = $(e).closest(".workspace-overlay-selector"); 0 == a.length && (a = $("." + e)), a.remove(), $.ajax({ url: so + "/Overlay_Disable", type: "POST", data: '{ "classes": "' + a.attr("class") + '" }', contentType: "application/json; charset=utf-8", success: function (e) { ta(e.d), u() }, error: function () { u() } }) } function aa(e) { for (var a = e.split(","), t = "#" + openWSE_Config.overlayPanelId, o = 0; o < a.length; o++) "" != a[o] && ($(t).find("." + a[o]).length > 0 && $(t).find("." + a[o]).remove(), $(t).hide().prepend($(".move-holder").find("." + a[o])).show()); "" != e && sa() } function ta(e) { var a = $("." + e); a.length > 0 && a.remove(), sa() } function oa() { f("Loading..."), $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/GetUserOverlays", type: "POST", data: "{ }", contentType: "application/json; charset=utf-8", success: function (e) { var a = ""; if (null != e.d) { a += "<div class='margin-top-sml'>", a += "<table cellpadding='0' cellspacing='0' style='min-width: 100%;'><tbody>", a += "<tr class='myHeaderStyle'><td width='30px'></td><td width='150px' align='center'>Overlay Name</td>", a += "<td align='center'>Description</td></tr>"; for (var t = 0; t < e.d.length; t++) { a += "<tr class='myItemStyle GridNormalRow'>"; var o = "<div class='add-overlay-list-item' onclick='openWSE.AddRemoveOverlayClick(\"" + e.d[t][1] + "\", this);' title='Add Overlay'></div>"; openWSE.ConvertBitToBoolean(e.d[t][3]) && (o = "<div class='add-overlay-list-item add-overlay-list-item-hasitem' onclick='openWSE.AddRemoveOverlayClick(\"" + e.d[t][1] + "\", this);' title='Remove Overlay'></div>"), a += "<td class='GridViewNumRow border-bottom'>" + o + "</td>", a += "<td class='border-right border-bottom'>", a += e.d[t][0] + "</td><td class='border-right border-bottom'>" + e.d[t][2] + "</td></tr>" } a += "</tbody></table></div>", 0 == e.d.length && (a += "<div class='emptyGridView'>No overlays available</div>") } $("#overlayEdit-element").find("#overlay-edit-list").html(a), u(), R(!0, "overlayEdit-element", "Add/Remove Overlay") }, error: function () { u(), openWSE.AlertWindow("There was an error retrieving your overlays. Please try again.") } }) } function ia(e, a) { $(a).hasClass("add-overlay-list-item-hasitem") ? (ea(e), $(a).removeClass("add-overlay-list-item-hasitem")) : (f("Adding Overlay..."), $(a).addClass("add-overlay-list-item-hasitem"), $("#hf_loadOverlay1").val(e), __doPostBack("hf_loadOverlay1", "")) } function na() {
        $(".overlay-table").length > 0 && $(".overlay-table").remove(); var e = $("#" + openWSE_Config.overlayPanelId); if (e.length > 0) { var a = 0; $(".workspace-overlay-selector").each(function (t) { t % Ro == 0 && (a++, e.append("<table id='overlay-table-id-" + a + "' class='overlay-table' cellpadding='0' cellspacing='0'></table>"), $("#overlay-table-id-" + a).append("<tr></tr>")); var o = $("#overlay-table-id-" + a).find("tr").eq(0); o.append("<td class='overlay-cell-" + t + "'></td>"), $("#overlay-table-id-" + a).find(".overlay-cell-" + t).append($(this)) }), "pnl_OverlaysAll" != openWSE_Config.overlayPanelId && 0 != $("#MainContent_pnl_adminnote").length && (e.prepend($("#MainContent_pnl_adminnote")), $("#MainContent_pnl_adminnote").removeClass("administrator-workspace-note").addClass("workspace-overlays administrator-workspace-note-overlay")) } $(".overlay-table").length > 0 && $(".overlay-table").eq($(".overlay-table").length - 1).css("margin-bottom", "40px")
    } function sa() { $(".workspace-overlay-selector").each(function () { $("#" + openWSE_Config.overlayPanelId).append($(this)) }), na() } function la(e) { if (!openWSE_Config.demoMode && $("#notification-tab-b").is(":visible") && !Zt) { Zt = !0, 0 == $(".ddLoadingMessage").length && e && $(".table-notiMessages-div").prepend(to); var a = new Array; $("#table_NotiMessages tr").each(function (e) { a[e] = $(this).attr("id") }); var t = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/LoadUserNotifications"; $.ajax({ url: t, type: "POST", data: '{ "_currIds": "' + a + '","siteTheme": "' + openWSE_Config.siteTheme + '" }', contentType: "application/json; charset=utf-8", success: function (e) { $(".ddLoadingMessage").remove(), null != e.d && "" != e.d ? ($("#NotificationHolder").html($.trim(e.d)), $("#no-notifications-id").length > 0 ? $("#lb_clearNoti").hide() : $("#lb_clearNoti").show()) : $("#lb_clearNoti").hide(), Zt = !1, ua(), va(), pa() }, error: function () { $(".ddLoadingMessage").remove(), va(), $("#NotificationHolder").html("<h3 class='pad-top-big pad-bottom' style='color: Red; text-align: center;'>Error retrieving notifications!</h3>"), $("#lb_clearNoti").hide(), Zt = !1 } }) } } function pa() { var e = document.getElementById("table-notiMessages-div-id"); if (null != e) { var a = $("#table-notiMessages-div-id").innerHeight(), t = parseInt($("#table-notiMessages-div-id").css("max-height")); if (a >= e.scrollHeight || e.scrollHeight < t) { var o = parseInt($("#lbl_notifications").html()), i = parseInt($("#table_NotiMessages tr").length); o > i && ($(".ddLoadingMessage").remove(), $("#NotificationHolder").append(to), da()) } } } function da() { if (!openWSE_Config.demoMode && $("#notification-tab-b").is(":visible") && !eo && !Zt) { eo = !0; var e = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/LoadMoreUserNotifications", a = new Array; $("#table_NotiMessages tr").each(function (e) { a[e] = $(this).attr("id") }), $.ajax({ url: e, type: "POST", data: '{ "_currIds": "' + a + '","_currCount": "' + parseInt($("#table_NotiMessages tr").length) + '","siteTheme": "' + openWSE_Config.siteTheme + '" }', contentType: "application/json; charset=utf-8", success: function (e) { $(".ddLoadingMessage").remove(), null != e.d && "" != e.d && $("#table_NotiMessages").append($.trim(e.d)), ua(), va(), eo = !1, pa() }, error: function () { $(".ddLoadingMessage").remove(), va(), $("#NotificationHolder").append("<h3 class='pad-bottom-big' style='color: Red; text-align: center;'>Error retrieving notifications!</h3>"), eo = !1 } }) } } function ra() { if (!openWSE_Config.demoMode && $("#notification-tab-b").is(":visible") && !eo) { eo = !0; var e = new Array; $("#table_NotiMessages tr").each(function (a) { e[a] = $(this).attr("id") }); var a = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/RefreshUserNotifications"; $.ajax({ url: a, type: "POST", data: '{ "_currIds": "' + e + '","siteTheme": "' + openWSE_Config.siteTheme + '" }', contentType: "application/json; charset=utf-8", success: function (e) { if ($(".ddLoadingMessage").remove(), null != e.d[0] && "" != e.d[0]) if ($("#table_NotiMessages").length > 0) $("#table_NotiMessages").prepend($.trim(e.d[0])); else { var a = "<table ID='table_NotiMessages' class='table-notiMessages' cellpadding='5' cellspacing='5'>"; a += $.trim(e.d[0]) + "</table>", $("#NotificationHolder").html(a) } if (null != e.d[1]) for (var t = 0; t < e.d[1].length; t++) { var o = e.d[1][t]; $("#" + o).fadeOut(openWSE_Config.animationSpeed, function () { $("#" + o).remove() }) } "0" == $("#lbl_notifications").html() && ($("#NotificationHolder").html("<h3 id='no-notifications-id'>No notifications available.</h3>"), $("#lb_clearNoti").hide()), ua(), va(), eo = !1 }, error: function () { $(".ddLoadingMessage").remove(), va(), $("#NotificationHolder").html("<h3 class='pad-top-big pad-bottom-big' style='color: Red; text-align: center;'>Error retrieving notifications!</h3>"), eo = !1 } }) } } function ca() { $(".ddLoadingMessage").remove(), $("#NotificationHolder").html(""), $("#lb_clearNoti").hide(), Zt = !1 } function ha() { $(".ddLoadingMessage").remove(), $("#lbl_notifications").removeClass("notifications-new"), $("#lbl_notifications").addClass("notifications-none"), $("#lbl_notifications").html("0"), $("#NotificationHolder").html("<h3 id='no-notifications-id'>No notifications available.</h3>"), $("#lb_clearNoti").hide() } function fa() { if (!openWSE_Config.demoMode) { f("Clearing Notifications..."); var e = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/DeleteNotifications"; $.ajax({ url: e, type: "POST", data: '{ "id": "ClearAll" }', contentType: "application/json; charset=utf-8", success: function (e) { openWSE.ConvertBitToBoolean(e.d) && (u(), ha()) } }) } } function ma(e) { if (!openWSE_Config.demoMode) { f("Deleting. Please Wait..."); var a = $(e).closest("tr"), t = a.attr("id"), o = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/DeleteNotifications"; $.ajax({ url: o, type: "POST", data: '{ "id": "' + t + '" }', contentType: "application/json; charset=utf-8", success: function (e) { openWSE.ConvertBitToBoolean(e.d) && a.fadeOut(openWSE_Config.animationSpeed, function () { if (u(), a.remove(), "1" == $("#lbl_notifications").html()) ha(); else { var e = parseInt($("#lbl_notifications").html()); e -= 1, $("#lbl_notifications").html(e) } }) } }) } } function ua() { if ($("#notification-tab-b").is(":visible")) { var e = 65, a = $(window).height() - (e + wo), t = 7, o = $(window).width() - t; $(".table-notiMessages-div").css({ maxHeight: a, maxWidth: o }), pa() } } function va() { $(".table-notiMessages-div").scroll(function () { var e = document.getElementById("table-notiMessages-div-id"); if (null != e) { var a = $(".table-notiMessages-div"), t = a.scrollTop(), o = a.innerHeight(); if (t > 0 && t + o >= e.scrollHeight) { var i = parseInt($("#lbl_notifications").html()), n = parseInt($("#table_NotiMessages tr").length); i > n && ($(".ddLoadingMessage").remove(), $("#NotificationHolder").append(to), da()) } } }) } function ga() { try { var e = document.getElementById("hf_noti_update_hiddenField").value; "" == e && (e = "0"), openWSE.ConvertBitToBoolean(e) && ($("#noti-update-element").show(), setTimeout(function () { $("#noti-update-element").fadeOut(openWSE_Config.animationSpeed, function () { $("#hf_noti_update_hiddenField").val("false") }) }, 2500)) } catch (a) { } } function $a() { "none" != $("#Login-holder").css("display") ? ($("#Login-holder").hide(), $("#iframe-createaccount-holder").html("<iframe id='iframe-demo' src='SiteTools/iframes/CreateAccount.aspx' frameborder='0' width='550px' style='visibility: hidden;'></iframe>"), $("#iframe-createaccount-holder").append("<div style='text-align: center;'><h3 id='loadingControls'>Loading Controls. Please Wait...</h3></div>"), $("#CreateAccount-holder").fadeIn(openWSE_Config.animationSpeed), $("#iframe-demo").load(function () { $("#loadingControls").remove(), $("#register_password_cancel").show(), $("#iframe-demo").css({ height: "300px", visibility: "visible" }) })) : ($("#CreateAccount-holder, #ForgotPassword-holder, #register_password_cancel").hide(), $("#iframe-createaccount-holder").html(""), $("#Login-holder").fadeIn(openWSE_Config.animationSpeed)) } function ba() { $("#tb_username_recovery").val(""), $("#lbl_passwordResetMessage").html(""), $("#UserNameRequired_recovery").css("visibility", "hidden"), $("#Login-holder").hide(), $("#register_password_cancel").show(), $("#ForgotPassword-holder").fadeIn(openWSE_Config.animationSpeed) } function ya() { var e = $.trim($("#tb_weather_postalCode").val()); "" != e && (cookie.set("weather_postal", e, "30"), wa(openWSE_Config.siteTheme)) } function wa(e) { var a = "66212", t = cookie.get("weather_postal"); "" == $.trim(t) || null == t || void 0 == t ? (a = $.trim($("#tb_weather_postalCode").val()), cookie.set("weather_postal", a, "30")) : a = t, "" == a && (a = "66212"), "" != e && (openWSE_Config.siteTheme = e); var o = "//builder.zoomradar.net/weather_builder/widget.page.php?s=250x250&z=" + a + "&i=1&c=5&ft=Current%20Weather", i = '<iframe src="' + o + '" width="250" height="250" style="border: 0; opacity: 0.85; filter:alpha(opacity=85);" frameborder="0"></iframe>', a = "<span>Postal Code:</span><input id='tb_weather_postalCode' type='text' class='textEntry margin-left margin-right' maxlength='10' value='" + a + "' style='width: 60px;' />", n = "<a href='#' onclick='openWSE.SetPostalCode();return false;' class='img-refresh pad-all-sml margin-right-sml margin-bottom-sml float-right' title='Refresh weather'></a>"; $("#Weather_Overlay_Position").html(i + "<div class='clear-space-two'></div><div id='weather-button-holder' class='overlay-header' style='height: 25px;'>" + n + a + "</div>") } function Ca(e, a) { if ($("#iframe-container-helper").length > 0) ka(), setTimeout(function () { Ca(e, a) }, openWSE_Config.animationSpeed); else { var t = "", o = window.location.hash; t = -1 == o.indexOf("#") && "#" != window.location.href.charAt(window.location.href.length - 1) ? "#?" : "" != o ? "&" : "?", t += "iframecontent=" + e, window.location += t } } function Sa(e, a) { if ($("#iframe-container-helper").length > 0) ka(), setTimeout(function () { Sa(e, a) }, openWSE_Config.animationSpeed); else { var t = $(window).height() - ($("#always-visible").height() + $("#container-footer").height()); _a(e) || (e = openWSE.siteRoot() + e); var i = "<iframe id='iframe-content-src' src='" + e + "' width='100%' frameborder='0' style='height: " + t + "px;'></iframe>", n = "<div id='iframe-container-helper'>" + i + "<div class='loading-background-holder'></div></div>", s = "<div id='iframe-container-close-btn'><a href='#' onclick='openWSE.CloseIFrameContent();return false;'>Close " + a + "</a></div>"; $("#workspace-selector").hide(), $("#top-main-bar-top").append(s), $("body").append(n), $("#container").hide(), $("#minimized-app-bar").hide(), $("#iframe-container-helper").fadeIn(openWSE_Config.animationSpeed), document.getElementById("iframe-content-src").onload = function () { $(document).ready(function () { setTimeout(function () { $("#iframe-container-helper").find(".loading-background-holder").remove() }, 150) }) }, $(".top-options li.a").removeClass("active"), $(".top-options li.b").hide(), cookie.del("top_menu"), "none" == $("#always-visible").css("display") && $("#always-visible").show(), o(!0) } } function ka() { "none" == $("#always-visible").find(".top-options").css("display") && $("#always-visible").hide(), $("#container").show(), $("#iframe-container-helper").html(""), $("#iframe-container-helper").fadeOut(openWSE_Config.animationSpeed, function () { $("#iframe-container-helper").remove(), $("#iframe-container-close-btn").remove(), $("#workspace-selector").show(), $("#minimized-app-bar").show(), o(!0) }); try { var e = window.location.href; if (-1 != e.indexOf("?iframecontent=")) { var a = e.split("?iframecontent="); if (a.length > 1) { var t = "?iframecontent=" + a[1]; e = e.replace(t, ""), window.location = e } } else if (-1 != e.indexOf("&iframecontent=")) { var a = e.split("&iframecontent="); if (a.length > 1) { var t = "&iframecontent=" + a[1]; e = e.replace(t, ""), window.location = e } } } catch (i) { } $(window).resize() } function _a(e) { var a = e.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/); return "string" == typeof a[1] && a[1].length > 0 && a[1].toLowerCase() !== location.protocol ? !0 : "string" == typeof a[2] && a[2].length > 0 && a[2].replace(new RegExp(":(" + { "http:": 80, "https:": 443 }[location.protocol] + ")?$"), "") !== location.host ? !0 : !1 } function Wa() { try { $("#background_selector_overlay").length > 0 && $("#background_selector_overlay").remove(), f("Loading Backgrounds"), $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/GetServerImageList", type: "POST", data: '{ "_workspace": "' + Ba() + '" }', contentType: "application/json; charset=utf-8", success: function (e) { if (2 == e.d.length) { var a = "<div style='text-align: left'><small><b class='pad-right-sml'>Note:</b>All backgrounds will repeat on the workspace. Your connection speed will slow down with the larger sized images. Each image has the size details when you hover over them. Solid color backgrounds will be the quickest if you have a slower internet.</small></div>"; a += "<div class='clear' style='height: 20px;'></div><div class='float-left'><span class='pad-right font-bold float-left pad-top-sml'>Url Link</span><input id='tb_imageurl' type='text' value='Link to image' class='textEntry' onfocus='if(this.value==\"Link to image\")this.value=\"\"' onblur='if(this.value==\"\")this.value=\"Link to image\"' style='width:355px;'>", a += "<input id='btn_urlupdate' type='button' value='Update Url' class='input-buttons margin-left' onclick='openWSE.updateBackgroundURL()' /><br /><div class='float-left'>Copy and paste any link that contains an image.</div></div>", a += "<a href='#' class='float-right' onclick='openWSE.ClearBackground();return false;'>Clear Background</a>", a += "<div class='clear' style='height: 20px;'></div>", a += "<span class='pad-right font-bold float-left pad-top-sml'>Solid Color</span><input id='tb_solidColorBg' type='text' class='textEntry float-left margin-right color' style='width: 75px;' />", a += "<input id='btn_urlbgcolor' type='button' value='Update Color' class='input-buttons float-left' onclick='openWSE.updateBackgroundColor()' />", a += "<div class='clear' style='height: 30px;'></div>", a += "<div class='modal-inner-scroll'>" + e.d[1] + "</div>", $("#background-selector-holder").html(a); try { jscolor.init() } catch (t) { } e.d[0].length > 6 ? $("#tb_imageurl").val(e.d[0]) : 6 == e.d[0].length && $("#tb_solidColorBg").val(e.d[0]), R(!0, "BackgroundSelector-element", "Select a new background") } else v("There was an error pulling the backgrounds down from the server. Please try again.", window.location.href); u() } }) } catch (e) { u() } } function xa() { $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/SaveNewBackground", type: "POST", data: '{ "_workspace": "' + Ba() + '","_img": "" }', contentType: "application/json; charset=utf-8", success: function () { 0 == $("#app_title_bg").length ? ($("#maincontent_overflow").css("background", ""), $("#maincontent_overflow").hasClass("maincontent_overflow-main-bg") || $("#maincontent_overflow").addClass("maincontent_overflow-main-bg")) : $(".workspace-backgrounds-fixed").length > 0 ? $("#MainContent_bg_" + Ba()).css("background", "#EFEFEF url('" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Body/default-bg.jpg') repeat top left") : $("#app_title_bg").css("background", "#EFEFEF url('" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Body/default-bg.jpg') top left repeat"), $("#tb_imageurl").val(""), $("#tb_solidColorBg").val("FFFFFF"), $("#tb_solidColorBg").attr("style", "width: 75px;"), $(".image-selector-active").each(function () { $(this).removeClass("image-selector-active"), $(this).addClass("image-selector") }) } }) } function Ea() { $("#background_selector_overlay").fadeOut(openWSE_Config.animationSpeed, function () { $("#background_selector_overlay").remove() }) } function Ma() { var e = $("#background-selector-holder").find("#tb_imageurl").val(); "Link to image" != e && Ta(e) } function Aa() { var e = $("#background-selector-holder").find("#tb_solidColorBg").val(); 6 == e.length && Ta(e) } function Ta(e) { $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/SaveNewBackground", type: "POST", data: '{ "_workspace": "' + Ba() + '","_img": "' + e + '" }', contentType: "application/json; charset=utf-8", success: function (a) { "" != a.d && (0 == $("#app_title_bg").length ? ($("#maincontent_overflow").hasClass("maincontent_overflow-main-bg") && $("#maincontent_overflow").removeClass("maincontent_overflow-main-bg"), e.length > 6 ? ($("#maincontent_overflow").css("background-image", "url('" + e + "')"), $("#maincontent_overflow").css("background-color", "#EFEFEF"), $("#maincontent_overflow").css("background-position", "top left"), $("#maincontent_overflow").css("background-repeat", "repeat repeat")) : $("#maincontent_overflow").css("background", "#" + e)) : $(".workspace-backgrounds-fixed").length > 0 ? e.length > 6 ? $("#MainContent_bg_" + Ba()).css("background", "#EFEFEF url('" + e + "') repeat top left") : $("#MainContent_bg_" + Ba()).css("background", "#" + e) : e.length > 6 ? $("#app_title_bg").css("background", "#EFEFEF url('" + e + "') top left repeat") : $("#app_title_bg").css("background", "#" + e), $(".image-selector-active").each(function () { $(this).removeClass("image-selector-active"), $(this).addClass("image-selector") })) } }) } function Oa(e) { $(e).find(".app-main-holder").each(function () { var e = $(this).attr("data-appid"); 0 != $("#minimized-app-bar").find(".app-min-bar[data-appid='" + e + "']").length && "none" != $("#minimized-app-bar").find(".app-min-bar[data-appid='" + e + "']").css("display") && $("#minimized-app-bar").find(".app-min-bar[data-appid='" + e + "']").hide() }) } function Pa(e) { $(e).find(".app-main-holder").each(function () { var e = $(this).attr("data-appid"); 0 != $("#minimized-app-bar").find(".app-min-bar[data-appid='" + e + "']").length && "none" == $("#minimized-app-bar").find(".app-min-bar[data-appid='" + e + "']").css("display") && $("#minimized-app-bar").find(".app-min-bar[data-appid='" + e + "']").show() }), $("#minimized-app-bar").fadeIn(openWSE_Config.animationSpeed) } function Ra(e) { La(e), id = "#MainContent_workspace_" + e, Xa($(id)), $(id).css({ visibility: "visible", opacity: 1, filter: "alpha(opacity=100)" }), $("#workspace_holder .workspace-holder").each(function () { "visible" != $(this).css("visibility") && at(this) }) } function Ba() { for (var e = $("#workspace_holder").find(".workspace-holder"), a = e.length, t = 0; a > t; t++) if ("visible" == e.eq(t).css("visibility")) { var o = e.eq(t).attr("id"); return "workspace_" + o.substring(o.lastIndexOf("_") + 1) } return "workspace_1" } function Ia(e, a) { at($(e)), tt($(a)), openWSE_Config.taskBarShowAll || (Oa($(e)), Pa($(a))), $(e).css({ opacity: 0, filter: "alpha(opacity=0)" }), openWSE_Config.animationSpeed > 0 ? $(a).fadeTo(openWSE_Config.animationSpeed, 1) : $(a).css({ opacity: 1, filter: "alpha(opacity=100)" }), Xa($(a)) } function La(e) { $("#ddl_WorkspaceSelector").find(".selected-workspace").html("Workspace " + e) } function za() { $("#ddl_WorkspaceSelector").removeClass("active"), $("#ddl_WorkspaceSelector").find(".dropdown-db-selector").hide() } function Na(e, a, t, o) { setTimeout(function () { a == t ? a = 1 : a++; var i = "#MainContent_workspace_" + a; La(a); var n = !1, s = !1; $("#workspace_holder .workspace-holder").each(function () { "visible" == $(this).css("visibility") && (openWSE_Config.taskBarShowAll || $("#minimized-app-bar").fadeOut(openWSE_Config.animationSpeed), $(this).fadeTo(openWSE_Config.animationSpeed, 0, function () { return n ? void 0 : (n = !0, at(this), tt($(i)), openWSE_Config.taskBarShowAll || (Oa(this), Pa($(i))), $(i).find(".app-main-holder").each(function () { o && ja(this) }), Xa($(i)), $(i).fadeTo(openWSE_Config.animationSpeed, 1, function () { s || (s = !0) }), !1) })) }), Na(e, a, t, o) }, 1e3 * e) } function ja(e) { var a = ($(e).find(".app-title").text(), $(e)), t = a.attr("data-appid"); if ("block" == a.css("display")) if (Ja($(".app-main-holder[data-appid='" + t + "']")), $(".app-main-holder").css("z-index", "1000"), a.css("z-index", "3000"), a.find(".iFrame-apps").length > 0) { var o = $get(t + " .iFrame-apps"); null != o.src && (o.src = o.src) } else $("#hf_ReloadApp").val(t), __doPostBack("hf_ReloadApp", "") } function Ha(e) { io = !0, e && (yo = !0, no = !0), $("#pnl_icons").sortable({ axis: "y", cancel: ".app-icon-category-list, #Category-Back, .app-popup", containment: "#pnl_icons", opacity: .6, scrollSensitivity: 40, scrollSpeed: 40, start: function () { $(document).tooltip({ disabled: !0 }) }, stop: function () { var e = ""; $(".app-icon").each(function () { var a = $(this).attr("data-appid"); "" != a && (e += a + ",") }), yo && $.ajax({ url: so + "/App_UpdateIcons", type: "POST", data: '{ "appList": "' + escape(e) + '" }', contentType: "application/json; charset=utf-8" }), $(document).tooltip({ disabled: !1 }) } }), $("#pnl_icons").disableSelection() } function Fa(e, a, t, o, i, n, s, l, p) { var d = $(".app-main-holder[data-appid='" + e + "']"); if (null != t && "" != t) { d.find(".app-title").text(a), openWSE.ConvertBitToBoolean(p) && (d.addClass("app-maximized"), d.find(".maximize-button-app").addClass("active")), "" != n && d.css("width", n), "" != s && d.css("height", s), openWSE.ConvertBitToBoolean(l) ? (Ua(d, a, o, i), at(d)) : (d.css({ visibility: "visible", display: "block", zIndex: 3e3 }), openWSE.ConvertBitToBoolean(p) || (d.removeClass("app-maximized"), d.find(".maximize-button-app").removeClass("active"), parseInt(i) < 0 && (i = "0"), parseInt(o) < 0 && (o = "0"), d.css({ left: o, top: i }))), -1 == t.indexOf(".ascx") && (-1 != t.indexOf("ChatClient/ChatWindow.html") ? (d.find(".app-body").html("<iframe class='iFrame-apps' src='" + openWSE.siteRoot() + t + "' width='100%' frameborder='0'></iframe>"), Ja(d), d.find("iframe").one("load", function () { Ja(d), d.find(".loading-background-holder").each(function () { $(this).remove() }) })) : d.find(".app-body").load(openWSE.siteRoot() + "Apps/" + t, function () { d.find(".app-body").find("iframe").length > 0 && (d.find(".app-body").find(".loading-background-holder").length <= 0 && d.find(".app-body").append(lo), Ja(d), d.find(".app-body").find("iframe").one("load", function () { Ja(d), d.find(".app-body").find(".loading-background-holder").each(function () { $(this).remove() }) })) })), gt(d); var r = d.parent().attr("id"); void 0 != r && null != r && "" != r && $t(r, e) } } function Ua(e, a, t, o) { var i = $(e); if (i.length > 0) { var n = i.attr("data-appid"), s = i.find(".app-header-icon"), l = i.find(".app-title"), p = !1, d = !1, r = "", c = "app-min-bar"; -1 != n.replace(/#/gi, "").indexOf("app-ChatClient-") && (c = "app-min-bar chat-modal", r = " chat-username='" + i.attr("chat-username") + "'"); var h = "<div data-appid='" + n + "' class='" + c + "'" + r + " data-x='" + t + "' data-y='" + o + "'>"; if (s.hasClass("display-none") || 0 == s.length || l.hasClass("display-none")) if ((s.hasClass("display-none") || 0 == s.length) && l.hasClass("display-none")) h += "<span class='app-title pad-right'>" + a + "</span>", h += "<a href='#" + n + "' class='exit-button-app-min'></a></div>"; else { var f = !1, m = !0; s.hasClass("display-none") || (h += s.outerHTML(), f = !0, "none" == s.css("display") && (p = !0)), l.hasClass("display-none") ? (h += "<span class='app-title pad-right display-none'>" + a + "</span>", d = !0, m = !1) : h += "<span class='app-title pad-right'>" + a + "</span>"; var u = ""; f && !m && (u = " style='margin-left: 5px;'"), h += "<a href='#" + n + "' class='exit-button-app-min'" + u + "></a></div>" } else h += s.outerHTML(), "none" == s.css("display") && (p = !0), h += "<span class='app-title pad-right'>" + a + "</span>", h += "<a href='#" + n + "' class='exit-button-app-min'></a></div>"; 0 == $(".app-min-bar[data-appid='" + n + "']").length && $("#minimized-app-bar").append(h), p && $(".app-min-bar[data-appid='" + n + "']").find(".app-header-icon").show(), d && $(".app-min-bar[data-appid='" + n + "']").attr("title", a), i.css({ visibility: "hidden", display: "block" }) } } function Da(e, a) { var t = $(e).find(".app-icon-font").text(); "" == t && (t = $(e).find(".app-title").text(), "" == t && (t = $(e).find("span").text())); var o = $(e).attr("data-appid"); if (void 0 != o && null != o && "" != o) { var i = $(".app-main-holder[data-appid='" + o + "']"); $.ajax({ url: so + "/App_Open", type: "POST", data: '{ "appId": "' + o + '","name": "' + t + '","workspace": "' + a + '","width": "' + i.width() + '","height": "' + i.height() + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function (e) { var n = e.d; if ("" != n) { pt(i), ot(a, o), $t(a, o); var s = i.width(), l = i.height(); if ("block" != i.css("display") || "visible" != i.css("visibility")) { if (-1 != o.indexOf("app-ChatClient-")) { var p = i.attr("chat-username"); n = "ChatClient/ChatWindow.html?user=" + p + "&displayVersion=workspace" } if (null == i.css("left") && null == i.css("top") || "auto" == i.css("left") && "auto" == i.css("top") ? Fa(o, t, n, "50px", "50px", s, l, "1", "0") : (parseInt(i.css("top")) < 0 && i.css("top", "50px"), parseInt(i.css("left")) < 0 && i.css("left", "50px"), Fa(o, t, n, i.css("left"), i.css("top"), s, l, "1", "0")), i.css("display", "block"), i.css("visibility", "visible"), i.css("z-index", "3000"), 0 != $(".app-min-bar[data-appid='" + o + "']").length) { i.find(".loading-background-holder").length <= 0 && i.find(".app-body").append(lo), i.hasClass("auto-full-page") || i.hasClass("auto-full-page-min") || i.hasClass("app-maximized") || i.hasClass("app-maximized-min") ? (nt(i), i.find(".maximize-button-app").addClass("active"), i.css("top", "0px")) : (i.find(".maximize-button-app").removeClass("active"), i.css("width", s), i.css("height", l), i.css("top", wo)); var d = $(".app-min-bar[data-appid='" + o + "']").attr("data-x"), r = $(".app-min-bar[data-appid='" + o + "']").attr("data-y"); i.css({ visibility: "visible", display: "block" }).animate({ opacity: 1, filter: "alpha(opacity=100)", left: d, top: r }, openWSE_Config.animationSpeed), $.ajax({ url: so + "/App_Move", type: "POST", data: '{ "appId": "' + o + '","name": "' + t + '","x": "' + d + '","y": "' + r + '","width": "' + s + '","height": "' + l + '","workspace": "' + a + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }), Xa(i) } else i.css({ top: wo, visibility: "visible", display: "block" }).fadeIn(openWSE_Config.animationSpeed); if ($(".app-min-bar[data-appid='" + o + "']").remove(), 1 == ro) { var c = document.getElementById("hf_loadApp1"); 0 == uo.length ? (uo[0] = o, c.value = o, __doPostBack("hf_loadApp1", "")) : uo[uo.length - 1] = o } else n.indexOf(".ascx") > 0 && 0 == ro && i.find(".loading-background-holder").each(function () { $(this).remove() }) } } } }) } } function Ga(e, a, t) { if (void 0 != e && null != e && "" != e) { $("#ConfirmApp-element").remove(), f("Loading. Please Wait..."), cookie.set("active_app", e, 30); var o = $(".app-main-holder[data-appid='" + e + "']").width(), i = $(".app-main-holder[data-appid='" + e + "']").height(); $.ajax({ url: so + "/App_Open_ChangeWorkspace", type: "POST", data: '{ "appId": "' + e + '","name": "' + a + '","workspace": "' + t + '","width": "' + o + '","height": "' + i + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function () { window.location = openWSE.siteRoot() + "Workspace.aspx" } }) } } function qa(e, a) { "none" == $(".app-main-holder[data-appid='" + $(e).attr("data-appid") + "']").css("display") && (ro = a) } function Va(e) { var a = $(".app-main-holder[data-appid='" + e + "']"); a.find("iframe").one("load", function () { a.find(".loading-background-holder").each(function () { $(this).remove() }) }) } function Ya(e) { for (var a = document.getElementById("hf_loadApp1"), t = 0; t < uo.length; t++) uo[t] == e && uo.splice(t, 1); var o = "#MainContent_" + e.replace(/-/gi, "_") + "_advPanel"; $(o).html(""), $(".move-holder").find(".main-div-app-bg").length > 0 && $(o).hide().append($(".move-holder").find(".main-div-app-bg")).show(); var i = $(o).closest(".app-body").parent().parent(); i.length > 0 && $(".move-holder").find(".outside-main-app-div").each(function () { 1 == $(".app-main-holder[data-appid='" + e + "']").length && ($(this).addClass(e + _o), i.append($(this))) }); var n = $(".app-main-holder[data-appid='" + e + "']"); n.find(".loading-background-holder").each(function () { $(this).remove() }), uo.length > 0 && (a.value = uo[0], __doPostBack("hf_loadApp1", "")), ro = 0 } function Ka() { $(".outside-main-app-div").each(function () { var e = $(this).closest(".app-body").parent().parent(); if (e.length > 0 && 1 == $("#" + $(this).attr("id")).length) { var a = $(this).closest(".app-body").parent().attr("data-appid"); $(this).addClass(a + _o), e.append($(this)) } }) } function Qa(e) { var a = $(".app-main-holder[data-appid='" + e + "']").parent(); $("." + e + _o).each(function () { a.length > 0 && 1 == $("#" + $(this).attr("id")).length && a.append($(this)) }) } function Xa(e) { $(e).find(".app-main-holder").each(function () { Ja(this) }) } function Ja(e) { var a = $(e); if (a.length > 0 && a.hasClass("app-main-holder")) { var t = a.outerHeight(), o = a.find(".app-head"), i = 0; o.length > 0 && "none" != o.css("display") && (i = o.outerHeight()); var n = t - (i + 2); if (a.find(".app-body").css({ height: n, width: a.width() }), a.find(".iFrame-apps").length > 0) { var s = 2; a.find(".app-title-bg-color").length > 0 && (s = a.find(".app-title-bg-color").outerHeight() + (s + 1)), a.find(".iFrame-apps").css("height", n - (s + 1)) } } } function Za(e) { var a = $(e); a.length > 0 && ($wo = a.find(".app-overlay-fix"), 0 == $wo.length && ($wb = a.find(".app-body"), 1 == $wb.length && $wb.append("<div class='app-overlay-fix'></div>"))) } function et(e) { $wo = $(e).find(".app-overlay-fix"), 1 == $wo.length && $wo.remove() } function at(e) { var a = $(e), t = a.height(), o = $(window).height(), i = -(t + o); a.css({ visibility: "hidden", top: i, bottom: o, zIndex: -1 }), it(e) } function tt(e) { var a = $(e); a.css({ visibility: "visible", top: 0, bottom: 0, zIndex: "" }), nt(a) } function ot(e, a) { var t = $(".app-main-holder[data-appid='" + a + "']"); nt(t); var o = t.parent().attr("id"), i = "MainContent_" + e; if (o != i) { var n = t.find("iframe").length; n > 0 && (t.find(".loading-background-holder").length <= 0 && t.find(".app-body").append(lo), Va(a)), $("#" + i).prepend(t), $t(e, a), Qa(a) } } function it(e) { var a = $(e); a.hasClass("app-maximized") && (a.removeClass("app-maximized"), a.addClass("app-maximized-min")), a.hasClass("auto-full-page") && (a.removeClass("auto-full-page"), a.addClass("auto-full-page-min")) } function nt(e) { var a = $(e); a.hasClass("app-maximized-min") && (a.removeClass("app-maximized-min"), a.addClass("app-maximized")), a.hasClass("auto-full-page-min") && (a.removeClass("auto-full-page-min"), a.addClass("auto-full-page")), Ja(e) } function st(e) { if (!mo) { mo = !0, co = $(e).attr("data-appid"); var a = Ba(), t = $("#MainContent_" + a).find(".app-main-holder[data-appid='" + co + "']"); if (t.length > 0) { ho = $("#" + co).css("left"), fo = $("#" + co).css("top"); var o = $(".app-min-bar[data-appid='" + co + "']").attr("data-x"), i = $(".app-min-bar[data-appid='" + co + "']").attr("data-y"); (null == o || "" == o) && (o = p.left - $("#workspace-selector").width()), (null == i || "" == i) && (i = 0), nt(t), t.css("left", o), t.css("top", i), t.addClass("app-min-bar-preview"), t.fadeTo(openWSE_Config.animationSpeed, .65) } } } function lt() { var e = $(".app-main-holder[data-appid='" + co + "']"); if (e.hasClass("app-min-bar-preview")) e.css("opacity", "0.0"), e.css("filter", "alpha(opacity=0)"), e.removeClass("app-min-bar-preview"), it(e), e.css("left", ho), e.css("top", fo), co = "", ho = "", fo = "", mo = !1; else { var a = Ba(), e = $("#MainContent_" + a).find(".app-main-holder[data-appid='" + co + "']"); 0 == e.length && (co = "", ho = "", fo = "", mo = !1) } } function pt(e) { if (openWSE.IsComplexWorkspaceMode()) { var a = $(e); if (dt(a), a.length > 0) { a.addClass("selected"), a.css("z-index", "3000"); var t = a.attr("data-appid"); cookie.set("active_app", t, "30") } } } function dt(e) { if (openWSE.IsComplexWorkspaceMode()) { var a = $(e).attr("data-appid"); $(".app-main-holder").css("z-index", "1000"), $(".app-main-holder").removeClass("selected"), $(".app-main-holder").each(function () { var e = $(this).attr("data-appid"); "block" == $(this).css("display") && (e != a ? Za(this) : e == a && $(this).find(".app-overlay-fix").remove()) }) } } function rt() { cookie.del("active_app"), $(".app-main-holder").each(function () { "block" == $(this).css("display") && Za(this) }) } function ct() { if (openWSE.IsComplexWorkspaceMode()) { var e = cookie.get("active_app"); null != e && "" != e && void 0 != e ? pt($(".app-main-holder[data-appid='" + e + "']")) : rt() } } function ht() { var e = cookie.get("app_category_id"), a = cookie.get("app_category"); null != document.getElementById("Category-Back") && null != e && "" != e && null != a && "" != a && ($(".app-icon-category-list").hide(), $("#Category-Back").show(), $("." + e).show(), $("#Category-Back-Name").html(a), $("#Category-Back-Name-id").html(e)) } function ft(e, a, t, o) { $.ajax({ url: so + "/App_RemoteLoad", data: '{ "_Id": "' + escape(e) + '" }', contentType: "application/json; charset=utf-8", dataType: "json", type: "POST", success: function (e) { try { null != e.d && mt(unescape(e.d[0]), unescape(e.d[1]), unescape(e.d[2])) } catch (i) { } u(), c(a, t, o) }, error: function () { u(), c(a, t, o) } }) } function mt(e, a, t) { if ("close" == a) { var o = $(".app-main-holder[data-appid='" + e + "']"); "block" == o.css("display") && o.find(".exit-button-app").length > 0 && o.find(".exit-button-app").click() } else if ("workspace-selector" == e) { try { $(".workspace-selection-item").eq(parseInt(a) - 1).trigger("click") } catch (i) { } var n = "#MainContent_" + Ba(), s = "#MainContent_workspace_" + a; La(a), Ia(n, s) } else { var l = a.split(";"), p = "1"; if (p = "" != l[0] && "0" != l[0] ? l[0] : Ba().replace("workspace_", ""), ro = openWSE.ConvertBitToBoolean(t) ? 1 : 0, -1 != e.indexOf("app-ChatClient-")) for (var d = e.replace("app-ChatClient-", ""), r = 0; r < $(".ChatUserNotSelected").length; r++) { var c = $(".ChatUserNotSelected").eq(r); if (1 == c.length && 1 == c.find(".usersclick[chat-userid='" + d + "']").length) { var h = $.trim(c.find(".usersclick[chat-userid='" + d + "']").html()), f = c.attr("chat-username"); return void chatClient.BuildChatWindow(f, d, h) } } var o = $(".app-icon[data-appid='" + e + "']"); if (0 == o.length) return; var m = l[2].replace("px", ""), u = l[3].replace("px", ""), v = l[4].replace("px", ""), g = l[5].replace("px", ""); if ("" != $("#hf_appContainer").val()) { var m = parseInt(m), u = parseInt(u), v = parseInt(v), g = parseInt(g); u + v > $("#container").width() && (u = Math.abs($("#container").width() - v) - 2), m + g > $("#container").height() && (m = Math.abs($("#container").height() - g) - 2) } if ($(".app-main-holder[data-appid='" + e + "']").css("block" == $(".app-main-holder[data-appid='" + e + "']").css("display") ? { top: m + "px", left: u + "px" } : { top: "auto", left: "auto" }), $(".app-main-holder[data-appid='" + e + "']").hasClass("ui-resizable") && $(".app-main-holder[data-appid='" + e + "']").css({ width: v + "px", height: g + "px" }), "block" == $(".app-main-holder[data-appid='" + e + "']").css("display")) { var b = $(".app-main-holder[data-appid='" + e + "']").find(".reload-button-app").parent(); St(b) } Da(o, "workspace_" + p), 0 == o.hasClass("active") && o.addClass("active"), ut(e, p, l[1]) } } function ut(e, a, t) {
        var o = $(".app-main-holder[data-appid='" + e + "']"); if ("block" == o.css("display")) {
            a = a.substring(a.lastIndexOf("_") + 1); try {
                $(".workspace-selection-item").eq(parseInt(a) - 1).trigger("click")
            } catch (i) { } var n = "#MainContent_" + Ba(), s = "#MainContent_workspace_" + a; if (La(a), Ia(n, s), Mt(a), "" != t) { var l = !1; switch (t) { case "minimize": if (0 == $(".app-min-bar[data-appid='" + e + "']").length) o.find(".minimize-button-app").length > 0 && (o.find(".minimize-button-app").click(), l = !0); else var p = setInterval(function () { "visible" == o.css("visibility") && (o.find(".minimize-button-app").click(), l = !0, clearInterval(p)) }, 50); break; case "maximize": o.find(".maximize-button-app").length > 0 && !o.hasClass("app-maximized") && (o.find(".maximize-button-app").click(), l = !0); break; case "normal": o.hasClass("app-maximized") && o.find(".maximize-button-app").length > 0 && (o.find(".maximize-button-app").click(), l = !0) } l || setTimeout(function () { $.ajax({ url: so + "/App_Position", type: "POST", data: '{ "appId": "' + o.attr("data-appid") + '","posX": "' + o.css("left") + '","posY": "' + o.css("top") + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) }, openWSE_Config.animationSpeed) }
        } else setTimeout(function () { ut(e, a, t) }, 100)
    } function vt(e) { var a = Ba(), t = $(e), o = t.find(".app-title").text(), i = t.css("left").replace("px", ""), n = t.css("top").replace("px", ""), s = t.width(), l = t.height(); pt(e), Ja(e), t.hasClass("app-maximized") ? (t.removeClass("app-maximized"), t.find(".maximize-button-app").removeClass("active"), $.ajax({ url: so + "/App_Maximize", type: "POST", data: '{ "appId": "' + t.attr("data-appid") + '","name": "' + o + '","x": "' + i + '","y": "' + n + '","width": "' + s + '","height": "' + l + '","workspace": "' + a + '","ismax": "0","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function () { vo = !1, Ja(e) }, error: function () { vo = !1 } })) : (t.addClass("app-maximized"), t.find(".maximize-button-app").addClass("active"), $.ajax({ url: so + "/App_Maximize", type: "POST", data: '{ "appId": "' + t.attr("data-appid") + '","name": "' + o + '","x": "' + i + '","y": "' + n + '","width": "' + s + '","height": "' + l + '","workspace": "' + a + '","ismax": "1","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function () { vo = !1, Ja(e) }, error: function () { vo = !1 } })) } function gt(e) { var a = $(e).attr("data-appid"); if (null != a && void 0 != a) if (-1 == a.indexOf("app-ChatClient-")) for (var t = $(".app-icon").find("span").length, o = 0; t > o; o++) { var i = $(".app-icon").eq(o).attr("data-appid"); i == a && 0 == $(".app-icon").eq(o).hasClass("active") && $(".app-icon").eq(o).addClass("active") } else { var n = $(".app-main-holder[data-appid='" + a + "']").attr("chat-username"); $(".ChatUserNotSelected[chat-username='" + n + "']").addClass("ChatUserSelected") } } function $t(e, a) { if (openWSE_Config.ShowWorkspaceNumApp && openWSE.IsComplexWorkspaceMode()) { var t = $(".app-icon[data-appid='" + a + "']"); if (t.length > 0) { var o = "", i = a + "-workspace-reminder", n = "workspace-reminder font-no-bold " + i, s = "display:block;"; if (t.find(".app-icon-font").length > 0) { var l = t.find(".app-icon-font"); "none" == l.css("display") && (s = "display:none;") } $("." + i).length > 0 && $("." + i).remove(); var p = e.substring(e.lastIndexOf("_") + 1); o = "<span class='" + n + "' style='" + s + "'>" + p + "</span>", "" != o && t.append(o) } } } function bt(e) { if (openWSE.IsComplexWorkspaceMode()) { var a = $(e).attr("data-appid"), t = $(".app-icon[data-appid='" + a + "']"); if (t.length > 0) { var o = a + "-workspace-reminder"; $("." + o).length > 0 && $("." + o).remove() } } } function yt(e) { var a = $(e).attr("data-appid"); if ($(".app-main-holder[data-appid='" + a + "']").find(".maximize-button-app").removeClass("active"), -1 == a.indexOf("app-ChatClient-")) for (var t = $(".app-icon").find("span").length, o = 0; t > o; o++) { var i = $(".app-icon").eq(o).attr("data-appid"); i == a && 1 == $(".app-icon").eq(o).hasClass("active") && $(".app-icon").eq(o).removeClass("active") } else { var n = $(".app-main-holder[data-appid='" + a + "']").attr("chat-username"); chatClient.displayMessageNoti(n); var s = $(".ChatUserNotSelected[chat-username='" + n + "']"); s.length > 0 && setTimeout(function () { s.removeClass("ChatUserSelected"), s.removeClass("chatisNew"), 1 == $("#SteelmfgHeader").hasClass("chatHeaderNew") && $("#SteelmfgHeader").removeClass("chatHeaderNew") }, openWSE_Config.animationSpeed), chatClient.notificationCleared = 1, document.title = chatClient.currTitle } } function wt(e, a) { $(".app-icon-category-list").hide(), $("#Category-Back").fadeIn(openWSE_Config.animationSpeed), 0 == openWSE_Config.animationSpeed ? $("." + e).show() : $("." + e).show("slide", { direction: "right" }, openWSE_Config.animationSpeed), $("#Category-Back-Name").html(a), $("#Category-Back-Name-id").html(e), cookie.set("app_category", a, "30"), cookie.set("app_category_id", e, "30") } function Ct() { openWSE.IsComplexWorkspaceMode() && ($(".app-main-holder").draggable({ scroll: !0, cancel: ".app-body, .exit-button-app, .minimize-button-app, .maximize-button-app, .options-button-app, .app-head-button-holder, .app-maximized, .auto-full-page", start: function (e) { var a = $(this); pt(a), a.css("opacity", "0.6"), a.css("filter", "alpha(opacity=60)"), $(".app-main-holder").each(function () { "block" == $(this).css("display") && Za(this) }), e.stopPropagation() } }).resizable({ handles: "se, s, e, w", minWidth: 150, minHeight: 150, create: function () { var e = $(this); e.hasClass("no-resize") && (e.className = !e.hasClass("app-main") || e.hasClass("auto-full-page") || e.hasClass("auto-full-page-min") ? e.hasClass("app-main") && (e.hasClass("auto-full-page") || e.hasClass("auto-full-page-min")) ? e.hasClass("auto-full-page-min") ? "app-main-holder app-main auto-full-page-min ui-draggable" : "app-main-holder app-main auto-full-page ui-draggable" : !e.hasClass("app-main-nobg") || e.hasClass("auto-full-page") || e.hasClass("auto-full-page-min") ? "app-main-holder app-main-nobg auto-full-page ui-draggable" : "app-main-holder app-main-nobg ui-draggable" : "app-main-holder app-main ui-draggable", e.find(".ui-resizable-handle").remove()) } }), "" != $("#hf_appContainer").val() && ($(".app-main-holder").draggable("option", "containment", $("#hf_appContainer").val()), $(".app-main-holder").resizable("option", "containment", "parent")), $(".app-main-holder").on("dragstop", function () { var e = $(this); e.css("opacity", "1.0"), e.css("filter", "alpha(opacity=100)"), this.offsetTop < 0 && e.animate({ top: 0 }, openWSE_Config.animationSpeed, function () { e.css("top", "0") }), this.offsetLeft < 0 && e.animate({ left: 0 }, openWSE_Config.animationSpeed, function () { e.css("left", "0") }); var a = e.find(".app-title").text(), t = Ba(), o = e.width(), i = e.height(); et(this), $.ajax({ url: so + "/App_Move", type: "POST", data: '{ "appId": "' + e.attr("data-appid") + '","name": "' + a + '","x": "' + e.css("left") + '","y": "' + e.css("top") + '","width": "' + o + '","height": "' + i + '","workspace": "' + t + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) }), $(".app-main-holder").on("resizestart", function (e) { if ($(this).hasClass("app-maximized")) { $(this).removeClass("app-maximized"); var a = $(this).find(".maximize-button-app"); a.length > 0 && a.removeClass("active") } pt(this), $(".app-main-holder").each(function () { "block" == $(this).css("display") && Za(this) }), e.stopPropagation() }), $(".app-main-holder").on("resize", function (e, a) { if (null != a) { var t = $(this); if (!t.hasClass("no-resize")) { var o = a.size.width, i = parseInt(t.css("min-width")); i > o && (o = i); var n = a.size.height, s = parseInt(t.css("min-height")); s > n && (n = s), t.css({ width: o, height: n }), Ja(this), bo = t.height() } } }), $(".app-main-holder").on("resizestop", function (e, a) { $(this).hasClass("no-resize") || (Ja(this), bo = 0, et(this), $.ajax({ url: so + "/App_Resize", type: "POST", data: '{ "appId": "' + $(this).attr("data-appid") + '","width": "' + a.size.width + '","height": "' + a.size.height + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" })) })) } function St(e) { var a = ($(e).closest(".app-head-button-holder").parent().find(".app-title").text(), $(e).closest(".app-head-button-holder").parent()), t = a.attr("data-appid"); Ja(a), $(".app-main-holder").css("z-index", "1000"), a.css("z-index", "3000"); var o = a.find(".options-button-app"), i = o.parent(); o.removeClass("active"), i.find(".app-popup-inner-app").hide(); var n = t + _o; if ($("." + n).each(function () { $(this).remove() }), a.find(".iFrame-apps").length > 0) { var s = a.find(".iFrame-apps")[0]; null != s.src && (null == a.find(".app-body").find("div").html() ? (a.find(".app-body").find(".loading-background-holder").length <= 0 && a.find(".app-body").append(lo), a.find(".iFrame-apps").one("load", function () { a.find(".app-body").find(".loading-background-holder").each(function () { $(this).remove() }) })) : (a.find(".app-body").find("div").find(".loading-background-holder").length <= 0 && a.find(".app-body").find("div").append(lo), a.find(".iFrame-apps").one("load", function () { a.find(".app-body").find("div").find(".loading-background-holder").each(function () { $(this).remove() }) })), s.src = s.src) } else a.find(".app-body").find(".loading-background-holder").length <= 0 && a.find(".app-body").append(lo), $("#hf_ReloadApp").val(t), __doPostBack("hf_ReloadApp", "") } function kt(e) { var a = $(e).closest(".app-head-button-holder").parent(), t = a.attr("data-appid"); $("#hf_aboutstatsapp").val("about;" + t); var o = a.find(".options-button-app"), i = o.parent(); o.removeClass("active"), i.find(".app-popup-inner-app").hide(), $("#MainContent_pnl_aboutHolder").html(""), f("Loading. Please Wait..."), __doPostBack("hf_aboutstatsapp", "") } function _t(e) { openWSE.ConfirmWindow("Are you sure you want to remove this app?", function () { $("#hf_aboutstatsapp").val("uninstall;" + e), f("Removing App"), __doPostBack("hf_aboutstatsapp", "") }, null) } function Wt(e, a) { var t = $(e).closest(".app-head-button-holder").parent(), o = 315, i = 425; if (t.length > 0) { var n = t.find(".app-title").text(); o = t.width(), i = t.height() } t.fadeOut(openWSE_Config.animationSpeed, function () { t.hasClass("app-maximized") && t.removeClass("app-maximized"), bt(t), yt(t); var e = 1, a = document.getElementById("hf_" + t.attr("id")); null != a && (e = 0), null == t.find(".app-body").find("div").html() ? 1 == e && t.find(".app-body").html("") : 1 == e && t.find(".app-body").find("div").html(""), t.css({ visibility: "hidden", left: "", top: "", width: "", height: "" }), t.find(".options-button-app").length > 0 && (t.find(".options-button-app").removeClass("active"), t.find(".app-popup-inner-app").hide()), $.ajax({ url: so + "/App_Close", type: "POST", data: '{ "appId": "' + t.attr("data-appid") + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) }); var s = "width=" + o + "px,height=" + i + "px,location=no,menubar=no,toolbar=no,status=no,resizable=yes,scrollbars=yes"; myWindow = window.open(a, n, s), myWindow.focus() } function xt(e, a) { var t = "width=400px,height=400px,location=no,menubar=no,toolbar=no,status=no,resizable=yes,scrollbars=yes"; myWindow = window.open(a, e, t), myWindow.focus(), openWSE.LoadModalWindow(!1, "ConfirmApp-element", "") } function Et(e, a) { if (openWSE.IsComplexWorkspaceMode()) { $(".top-options li.a").removeClass("active"), $(".top-options li.b").hide(); var t = "fullscreen=yes,location=no,menubar=no,toolbar=no,status=no,resizable=yes,scrollbars=yes"; myWindow = window.open(a, e, t), myWindow.focus() } else window.location.href = a.replace("?toolView=true", "") } function Mt(e) { var a = ""; if (a = $(e).length > 0 ? $.trim($(e).hasClass("app-popup-selector") || $(e).hasClass("app-options-workspace-switch") ? $(e).val() : $(e).text()) : e, "" != a && "-" != a) { La(a); var t = a; a = "workspace_" + a; var o = Ba(); $_name = $(e).closest(".app-icon"), 0 == $_name.length && ($_name = $(e).closest(".app-head-button-holder").parent()); var i = 0, n = $_name.attr("data-appid"); "" != n && void 0 != n && null != n && ($t(a, n), "block" == $("#" + n).css("display") && (i = 1)), (o != a || 0 == i || 1 == i && o == a) && ($.ajax({ url: so + "/App_CurrentWorkspace", type: "POST", data: '{ "workspace": "' + t + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }), Da($_name, a), o != a && (_id = "#MainContent_" + a, $("#workspace_holder .workspace-holder").each(function () { "visible" == $(this).css("visibility") && (openWSE_Config.taskBarShowAll || $("#minimized-app-bar").fadeOut(openWSE_Config.animationSpeed), $(this).fadeTo(openWSE_Config.animationSpeed, 0, function () { at(this), openWSE_Config.taskBarShowAll || (Oa(this), Pa(_id)) })) }), $(_id).fadeTo(openWSE_Config.animationSpeed, 1), tt($(_id)), Xa($(_id)), Qa(n), $(".app-options").css("visibility", "hidden"), setTimeout(function () { $(".app-popup").hide() }, openWSE_Config.animationSpeed))) } } function At() { var e = -1; if ("Microsoft Internet Explorer" == navigator.appName) { var a = navigator.userAgent, t = new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"); null != t.exec(a) && (e = parseFloat(RegExp.$1)) } return e } function Tt() { var e = At(); e > -1 && 8 > e && openWSE.AlertWindow("You might want to consider upgrading your copy of Internet Explorer. Some features may not work correctly.") } function Ot() { f("Loading Groups..."), $("#GroupLogin-element").remove(); var e = "<div id='GroupLogin-element' class='Modal-element'><div class='Modal-overlay'><div class='Modal-element-align'><div class='Modal-element-modal'>", a = "<a href='#' onclick='openWSE.CloseGroupLoginModal();return false;' class='ModalExitButton'></a>"; e += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>" + a + "</div><span class='Modal-title'></span></div></div>", e += "<div class='ModalPadContent'></div></div></div></div></div>", $("#extra_modal_holder").length > 0 ? $("#extra_modal_holder").append(e) : $("body").append(e), $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/GetUserGroups", type: "POST", data: "{ }", contentType: "application/json; charset=utf-8", success: function (e) { var a = "<div class='clear-margin'>Select the group you would like to login to. Using this enables certain features of a group.</div><div class='clear-space'></div>"; try { for (var t = 0; t < e.d[0].length; t++) { var o = e.d[0][t][0], i = e.d[0][t][1], n = e.d[0][t][2]; a += "<div class='logingroupselector' onclick='openWSE.LoginAsGroup(\"" + o + "\")' title='Click to login'>", a += "<img alt='Group Logo' src='" + n + "' />", a += "<span>" + i + "</span>", a += "</div>" } openWSE.ConvertBitToBoolean(e.d[1]) && (a += "<div class='logingroupselector-logout' onclick='openWSE.LoginAsGroup(\"\")'>", a += "<div>Logout of Group</div>", a += "</div>"), a += "<div class='clear-space'></div>" } catch (s) { } $("#GroupLogin-element").find(".ModalPadContent").html(a), R(!0, "GroupLogin-element", "Group Login"), openWSE.RemoveUpdateModal() } }) } function Pt(e) { f("" != e ? "Logging into Group" : "Logging out of Group"), $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/LoginUnderGroup", type: "POST", data: '{ "id": "' + e + '" }', contentType: "application/json; charset=utf-8", success: function () { location.reload() }, error: function () { u() } }) } function Rt() { R(!1, "GroupLogin-element", ""), setTimeout(function () { $("#GroupLogin-element").remove() }, openWSE_Config.animationSpeed) } function Bt() { var e = location.hash; try { if (-1 != e.indexOf("?iframecontent=")) { var a = e.split("?iframecontent="); a.length > 1 && openWSE.LoadIFrameContentHistory(a[1], "Content") } else if (-1 != e.indexOf("&iframecontent=")) { var a = e.split("&iframecontent="); a.length > 1 && openWSE.LoadIFrameContentHistory(a[1], "Content") } else -1 != e.indexOf("?help") || -1 != e.indexOf("&help") ? j() : ($("#iframe-container-helper").length > 0 && openWSE.CloseIFrameContent(), "block" == $("#help_main_holder").css("display") && Q()) } catch (t) { } } function It() { if (navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/webOS/i) || navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/Windows Phone/i)) { var e = document.getElementsByTagName("head")[0]; meta = document.createElement("meta"), meta.name = "viewport", meta.id = "mobileViewport", meta.content = "width=device-width, initial-scale=0.70, user-scalable=no", e.appendChild(meta) } else $("#mobileViewport").length > 0 && $("#mobileViewport").remove() } function Lt(e, a) { if (!openWSE_Config.demoMode) { f("Accepting. Please Wait..."); var t = $(e).closest("tr"), o = t.attr("id"), i = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/AcceptInviteNotifications"; $.ajax({ url: i, type: "POST", data: '{ "id": "' + o + '", "groupId": "' + a + '" }', contentType: "application/json; charset=utf-8", success: function (e) { openWSE.ConvertBitToBoolean(e.d) && t.fadeOut(openWSE_Config.animationSpeed, function () { if (u(), t.remove(), "1" == $("#lbl_notifications").html()) ha(); else { var e = parseInt($("#lbl_notifications").html()); e -= 1, $("#lbl_notifications").html(e) } }) } }) } } function zt(e) { var a = $("#" + e); if (a.length > 0) { var t = $.trim(a.val()); f("Submitting feedback..."), $.ajax({ url: openWSE.siteRoot() + "WebServices/UpdateServerSettings.asmx/SubmitFeedback", data: "{ 'text': '" + t + "' }", dataType: "json", type: "POST", contentType: "application/json; charset=utf-8", dataFilter: function (e) { return e }, success: function () { u(), a.val("Enter your comments here..."), a.css("color", "#B7B7B7") }, error: function () { openWSE.AlertWindow("An error occurred submitting your feedback! Please try again.") } }) } } function Nt() { $("#container").css("top", "0"), $("#always-visible, .sidebar-padding-menulinks").hide(); var e = $(window).height() - ($(".footer").height() + $("#app_title_bg").height()); $("#maincontent_overflow").css({ height: e }), $("#maincontent_overflow").width($(window).width()), $("#always-visible").find(".top-options").hide(), $("#DateDisplay").hide(), $("#localtime").hide(), $(window).resize() } function jt() { $(".app-icon-links").removeClass("active"), $(".app-icon-sub-links").removeClass("active"); var e = window.location.href.toLowerCase(); $(".app-icon-links").each(function () { var a = $(this).attr("href").toLowerCase(); if (-1 != e.indexOf(a) && ($(this).addClass("active"), $(this).next().hasClass("app-icon-sub-link-holder"))) { $(this).next().show(); var t = $(this).find(".img-expand-sml"); 1 == t.length && (t.removeClass("img-expand-sml"), t.addClass("img-collapse-sml")) } }), $(".app-icon-sub-links").each(function () { var a = $(this).attr("href").toLowerCase(); if (-1 != e.indexOf(a)) { $(".app-icon-links").removeClass("active"), $(this).addClass("active"), $(this).parent().show(); var t = $(this).parent().prev().find(".img-expand-sml"); 1 == t.length && (t.removeClass("img-expand-sml"), t.addClass("img-collapse-sml")) } }) } function Ht() { var e = $(window).height() - ($(".footer").height() + $("#always-visible").height() + $("#app_title_bg").height()); "none" == $("#always-visible").css("display") && (e += $("#always-visible").height()), "none" == $(".footer").css("display") && (e += $(".footer").height()), $("#maincontent_overflow").css({ height: e - 1 }), "pnl_OverlaysAll" == openWSE_Config.overlayPanelId && $("#pnl_OverlaysAll").height($(window).height()), "none" == $(".sidebar-padding-menulinks").css("display") ? $("#maincontent_overflow").width($(window).width()) : ($("#accordian-sidebar").css("height", e - 1 + "px"), $("#maincontent_overflow").css("width", $(window).width() - $(".sidebar-padding-menulinks").outerWidth() + "px")) } function Ft(e, a) { $(e).hasClass("img-expand-sml") ? ($(e).removeClass("img-expand-sml"), $(e).addClass("img-collapse-sml"), $(e).closest(".app-icon-links").parent().find("." + a).slideDown(openWSE_Config.animationSpeed)) : ($(e).removeClass("img-collapse-sml"), $(e).addClass("img-expand-sml"), $(e).closest(".app-icon-links").parent().find("." + a).slideUp(openWSE_Config.animationSpeed)) } function Ut() { var e = ""; return "" != openWSE_Config.siteRootFolder && (e = openWSE_Config.siteRootFolder + "/"), window.location.protocol + "//" + window.location.host + "/" + e } function Dt(e) { if (1 == $(e).length) { var a = $(e)[0].className.split(/\s+/); return a } return new Array } var Gt = "", qt = "", Vt = "", Yt = "", Kt = 0, Qt = "<div class='loading-icon-sml'></div>", Xt = "<div class='loading-icon-lrg'></div>", Jt = 0, Zt = !1, eo = !1, ao = new Array, to = "<div class='ddLoadingMessage'>" + Qt + "<h3>Loading Notifications. Please Wait...</h3></div>", oo = 0, io = !1, no = !1, so = "WebServices/SaveControls.asmx", lo = "<div class='loading-background-holder'></div>", po = 0, ro = 0, co = "", ho = "", fo = "", mo = !1, uo = new Array, vo = !1, go = !1, $o = !1, bo = 0, yo = !1, wo = 34, Co = 28, So = !1, ko = !1, _o = "-outside-modal-window"; Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(function (e, a) { $("#pnl_aboutHolder").length > 0 && "" != $.trim($("#pnl_aboutHolder").html()) && "block" == $("#aboutApp-element").css("display") && (Yt = $.trim($("#pnl_aboutHolder").html())), B(a) }), Sys.WebForms.PageRequestManager.getInstance().add_endRequest(function () { $(".ui-tooltip-content").parents("div").remove(), "" != Yt && ($("#MainContent_pnl_aboutHolder").html(Yt), Yt = ""), u(), I(), ra(), c(Gt, qt, Vt), ga() }), $(document.body).on("click", ".RandomActionBtns", function () { f(0 != $(this).closest("#searchwrapper").length ? "Searching..." : "Updating. Please Wait...") }), $(document.body).on("click", "#lbtn_signoff", function () { f("Signing Off. Please Wait...") }), $(document.body).on("keypress", "#searchbox-app-search", function (e) { 13 == e.which && ($(this).focus(), event.preventDefault(), A()) }), $(document.body).on("click", "#container, #container_logo, .workspace-holder, .content-main, .Modal-overlay, #iframe-container-helper", function () { $(".top-options li.a").removeClass("active"), $(".top-options li.b").hide(), openWSE.RemoveWorkspaceSelectorActive(), ca(), cookie.del("top_menu") }), $(document.body).on("click", ".top-options li.a", function () { var e = $(this).next(); if ($(".top-options li.a").removeClass("active"), 1 == e.length) if (e.is(":visible")) ca(), $(".top-options li.b").hide(), e.css("max-height", ""); else { $(".top-options li.b").hide(); var a = $(window).height() - 98; e.find(".li-pnl-tab").css("max-height", a), e.slideDown(openWSE_Config.animationSpeed), $(this).addClass("active"), e.find("input[type=text]").length > 0 && e.find("input[type=text]").focus(); var t = $("li.b").index(e); cookie.set("top_menu", t, "30") } else ca(), $(".top-options li.b").hide() }), $(document.body).on("click", ".help-icon", function () { N(!1) }), $(document.body).on("keydown", "#tb_weather_postalCode", function (e) { try { if (13 == e.which) return ya(), !1 } catch (a) { if (13 == e.keyCode) return ya(), !1; delete a } }), $(document.body).on("click", ".workspace-reminder", function () { var e = $(this).parent(); return $(".app-popup").css("display", "none"), $popup = e.find(".app-popup"), $popup.css("display", "block"), $popup.fadeIn(openWSE_Config.animationSpeed), !1 }), $(document.body).on("mouseover", ".app-icon", function () { var e = $(this).find(".app-options"); e.length > 0 && (So = !1, e.css("visibility", "visible")) }), $(document.body).on("mouseleave", ".app-icon", function () { var e = $(this).find(".app-options"), a = $(this).find(".app-popup"); e.length > 0 && a.length > 0 && "block" != a.css("display") && e.css("visibility", "hidden") }), $(document.body).on("mouseleave", ".app-popup", function () { So || $(this).hide() }), $(document.body).on("click", ".app-popup-selector", function () { So = !0 }), $(document.body).on("click", ".app-icon", function () { var e = $(this); if (openWSE.IsComplexWorkspaceMode() || ko || -1 != window.location.href.toLowerCase().indexOf("appmanager.aspx")) if ($("#workspace_holder").length > 0) { var a = Ba(); Da(e, a), 0 == e.hasClass("active") && e.addClass("active"), $(".workspace-overlay-selector").hasClass("active") && $(".workspace-overlay-selector").removeClass("active") } else $("#app_tab_body").length > 0 && P(this); else window.location.href = openWSE.siteRoot() + "Workspace.aspx?AppPage=" + e.attr("data-appId"); return ko = !1, !1 }), $(document.body).on("click", "#Category-Back", function () { var e = $("#Category-Back-Name-id").html(); $("#Category-Back").fadeOut(openWSE_Config.animationSpeed), $("." + e).length > 0 ? 0 == openWSE_Config.animationSpeed ? ($("." + e).hide(), $(".app-icon-category-list").show(), $("#Category-Back-Name").html(""), $("#Category-Back-Name-id").html(""), cookie.del("app_category"), cookie.del("app_category_id")) : $("." + e).hide("slide", { direction: "right" }, openWSE_Config.animationSpeed, function () { $(".app-icon-category-list").show(), $("#Category-Back-Name").html(""), $("#Category-Back-Name-id").html(""), cookie.del("app_category"), cookie.del("app_category_id") }) : ($(".app-icon-category-list").show(), $("#Category-Back-Name").html(""), $("#Category-Back-Name-id").html(""), cookie.del("app_category"), cookie.del("app_category_id")) }), $(document.body).on("click", ".minimize-button-app", function () { if (!go) { go = !0; var e = $(this).attr("href").replace("#", ""), a = $(".app-main-holder[data-appid='" + e + "']"), t = a.find(".app-title").text(), i = a.css("left"), n = a.css("top"), s = a.width(), l = a.height(), p = Ba(); 0 == $(".app-min-bar[data-appid='" + e + "']").length && a.animate({ opacity: 0, left: $("#minimized-app-bar").css("width"), top: 0 }, openWSE_Config.animationSpeed, function () { Ua(a, t, i, n), at(a), o(!0), $.ajax({ url: so + "/App_Minimize", type: "POST", data: '{ "appId": "' + e + '","name": "' + t + '","x": "' + i + '","y": "' + n + '","width": "' + s + '","height": "' + l + '","workspace": "' + p + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function () { go = !1 }, error: function () { go = !1 } }) }) } return !1 }), $(document.body).on("dblclick", ".app-head-dblclick", function () { return vo || (vo = !0, vt($(this).closest(".app-main-holder"))), !1 }), $(document.body).on("click", ".maximize-button-app", function () { return vo || (vo = !0, vt($(this).closest(".app-main-holder"))), !1 }), $(document.body).on("click", ".exit-button-app, .exit-button-app-min", function () { if (!$o) { $o = !0; var e = $(this).attr("href").replace("#", ""), a = $(".app-main-holder[data-appid='" + e + "']"); $(".app-min-bar[data-appid='" + e + "']").length > 0 && ($(".app-min-bar[data-appid='" + e + "']").remove(), o(!0)); { a.find(".app-title").text() } a.hasClass("app-min-bar-preview") && (a.css("opacity", "0.0"), a.css("filter", "alpha(opacity=0)"), a.removeClass("app-min-bar-preview"), mo = !1, co = "", ho = "", fo = "", nt(e)), bt(a), yt(a), a.fadeOut(openWSE_Config.animationSpeed, function () { a.hasClass("app-maximized") && a.removeClass("app-maximized"), -1 != a.attr("data-appid").indexOf("app-ChatClient-") && a.remove(); var t = 1, o = document.getElementById("hf_" + e.replace(/#/gi, "")); null != o && (t = 0), null == a.find(".app-body").find("div").html() ? 1 == t && a.find(".app-body").html("") : 1 == t && a.find(".app-body").find("div").html(""), a.css({ visibility: "hidden", left: "", top: "", width: "", height: "" }), a.find(".app-body").css({ height: "", width: "" }), a.find(".options-button-app").length > 0 && (a.find(".options-button-app").removeClass("active"), a.find(".app-popup-inner-app").hide()); var i = a.attr("data-appid") + _o; $("." + i).each(function () { $(this).remove() }), $.ajax({ url: so + "/App_Close", type: "POST", data: '{ "appId": "' + e + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function () { $o = !1 }, error: function () { $o = !1 } }) }) } return !1 }), $(document.body).on("click", ".app-min-bar", function () { var e = $(this).find("span").text(), a = Ba(), t = $(this).attr("data-appid"), i = $(".app-main-holder[data-appid='" + t + "']"); i.hasClass("app-min-bar-preview") && (i.css("opacity", "0.0"), i.css("filter", "alpha(opacity=0)"), i.removeClass("app-min-bar-preview"), ho = "", fo = ""); var n = i.width(), s = i.height(); return $.ajax({ url: so + "/App_Open", type: "POST", data: '{ "appId": "' + t + '","name": "' + e + '","workspace": "' + a + '","width": "' + n + '","height": "' + s + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function (l) { var p = l.d; if ("" != p) { if (ot(a, t), $t(a, t), "block" != i.css("display") || "visible" != i.css("visibility")) { var d = ""; d = null == i.find(".app-body").find("div").html() ? i.find(".app-body").html().trim() : i.find(".app-body").find("div").html().trim(); var r = "0"; if (i.hasClass("app-maximized") && (r = "1"), "" == d) { if (-1 != t.indexOf("app-ChatClient-")) { var c = i.attr("chat-username"); p = "ChatClient/ChatWindow.html?user=" + c + "&displayVersion=workspace" } null == i.css("left") && null == i.css("top") || "auto" == i.css("left") && "auto" == i.css("top") ? Fa(t, e, p, "50px", "50px", n, s, "1", r) : (parseInt(i.css("top")) < 0 && i.css("top", "50px"), parseInt(i.css("left")) < 0 && i.css("left", "50px"), Fa(t, e, p, i.css("left"), i.css("top"), n, s, "1", r)) } if (0 != $(".app-min-bar[data-appid='" + t + "']").length) { i.hasClass("auto-full-page") || i.hasClass("auto-full-page-min") || i.hasClass("app-maximized") || i.hasClass("app-maximized-min") ? (i.find(".maximize-button-app").addClass("active"), i.css("top", "0px"), i.hasClass("app-maximized-min") && (i.removeClass("app-maximized-min"), i.addClass("app-maximized")), i.hasClass("auto-full-page-min") && (i.removeClass("auto-full-page-min"), i.addClass("auto-full-page"))) : (i.find(".maximize-button-app").removeClass("active"), i.css("width", n), i.css("height", s), i.css("top", wo)); var h = $(".app-min-bar[data-appid='" + t + "']").attr("data-x"), f = $(".app-min-bar[data-appid='" + t + "']").attr("data-y"); mo && co == t ? i.css({ visibility: "visible", display: "block", opacity: 1, left: h, top: f }) : i.css({ visibility: "visible", display: "block" }).animate({ opacity: 1, left: h, top: f }, openWSE_Config.animationSpeed), $.ajax({ url: so + "/App_Move", type: "POST", data: '{ "appId": "' + t + '","name": "' + e + '","x": "' + h + '","y": "' + f + '","width": "' + n + '","height": "' + s + '","workspace": "' + a + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) } else i.css({ top: wo, visibility: "visible", display: "block" }).fadeIn(openWSE_Config.animationSpeed); pt(i), $(".app-min-bar[data-appid='" + t + "']").length > 0 && $(".app-min-bar[data-appid='" + t + "']").remove() } mo = !1, co = "", o(!0), Ja(i) } } }), !1 }), $(document.body).on("click", ".app-main-holder", function () { pt(this), po = 1 }), $(document.body).on("click", ".workspace-holder", function () { openWSE.IsComplexWorkspaceMode() && 0 == po && ($(".app-main-holder").removeClass("selected"), rt()), po = 0 }), $(document.body).on("click", ".options-button-app", function () { var e = $(this), a = e.parent(); if ("block" == a.find(".app-popup-inner-app").css("display")) e.removeClass("active"), a.find(".app-popup-inner-app").slideUp(openWSE_Config.animationSpeed); else { e.addClass("active"); var t = a.find(".app-popup-inner-app").find(".app-options-workspace-switch"); if (t.length > 0) { var o = e.closest(".workspace-holder").attr("id").replace("MainContent_workspace_", ""); t.val(o) } a.find(".app-popup-inner-app").slideDown(openWSE_Config.animationSpeed), pt(a.parent()) } return !1 }), $(document.body).on("change", ".app-popup-selector, .app-options-workspace-switch", function () { if ("" != $.trim($(this).val()) && "-" != $.trim($(this).val())) if ($("#workspace_holder").length > 0) { Mt(this); var e = $(this).closest(".app-head-button-holder").parent().find(".options-button-app"); if (e.length > 0) { var a = e.parent(); e.removeClass("active"), a.find(".app-popup-inner-app").hide() } } else { var t = $(this).closest(".app-icon"); P(t) } }), $(document.body).on("click", ".app-options", function () { return $(".app-popup").css("display", "none"), $popup = $(this).find(".app-popup"), $popup.css("display", "block"), $popup.fadeIn(openWSE_Config.animationSpeed), !1 }), $(document.body).on("keypress", "input[type='text'], textarea", function (e) { if (!$(this).hasClass("mce-textbox") && !$(this).parent().hasClass("ace_editor")) { var a = e.which ? e.which : e.keyCode, t = String.fromCharCode(a); if (!t.match('^.*?(?=[^"#%&$*<>?{|}]).*$')) return !1 } }); var Wo, xo = 0, Eo = !1; $(document.body).on("click", ".RadioButton-Toggle-Overlay", function () { var e = $(this).closest(".switch-slider"); if (Eo = !0, e.find(".cb-disable").hasClass("selected")) e.animate({ left: 0 }, openWSE_Config.animationSpeed, function () { e.find(".cb-enable").find("input").trigger("click") }); else { var a = e.parent().outerWidth() - e.find(".RadioButton-Toggle-Overlay").outerWidth() + 2; e.animate({ left: -a }, openWSE_Config.animationSpeed, function () { e.find(".cb-disable").find("input").trigger("click") }) } }), $(document.body).on("click", ".cb-enable, .cb-disable", function () { return Eo ? (openWSE.LoadingMessage1("Updating..."), void (Eo = !1)) : !1 }); var Mo = !1, Ao = !1, To = !1, Oo = !1, Po = !1, Ro = 3; $(document.body).on("click", "#overlay_tab, #pnl_OverlaysAll", function (e) { "pnl_OverlaysAll" == openWSE_Config.overlayPanelId && ("block" != $("#pnl_OverlaysAll").css("display") ? $("#pnl_OverlaysAll").fadeIn(openWSE_Config.animationSpeed) : (e.target.id == $(this).attr("id") || 0 == e.target.className.indexOf("overlay-") && 0 != e.target.className.indexOf("overlay-entries")) && $("#pnl_OverlaysAll").fadeOut(openWSE_Config.animationSpeed)), $(".top-options li.a").removeClass("active"), $(".top-options li.b").hide(), ca(), cookie.del("top_menu") }), $(document).keydown(function (e) {
        if (e = e || window.event, e.altKey && 79 == e.which && "pnl_OverlaysAll" == openWSE_Config.overlayPanelId && ("block" != $("#pnl_OverlaysAll").css("display") ? $("#pnl_OverlaysAll").fadeIn(openWSE_Config.animationSpeed) : $("#pnl_OverlaysAll").fadeOut(openWSE_Config.animationSpeed)), $("#workspace_holder").length > 0 && (e.altKey && 38 == e.which || e.altKey && 40 == e.which)) {
            var a = parseInt(Ba().replace("workspace_", "")), t = $(".dropdown-db-selector").find("ul").find("li").length, o = null; if (o = $(".workspace-selection-item").eq(40 == e.which ? t >= a + 1 ? a : 0 : a - 1 >= 1 ? a - 2 : t - 1), null != o) {
                o.trigger("click"); var i = "#MainContent_" + openWSE.Getworkspace(), n = "#MainContent_workspace_" + o.html().replace("Workspace ", "");
                openWSE.HoverWorkspacePreview(i, n)
            }
        }
    }), $(document.body).on("click", ".image-selector", function () { var e = $(this), a = $(this).find("img").attr("src"); f("Saving Background"), $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/SaveNewBackground", type: "POST", data: '{ "_workspace": "' + Ba() + '","_img": "' + a + '" }', contentType: "application/json; charset=utf-8", success: function (a) { "" != a.d && ($("#app_title_bg").length > 0 ? ($("#app_title_bg").css("background-image", "url('" + a.d + "')"), $("#app_title_bg").css("background-color", "#EFEFEF"), $("#app_title_bg").css("background-position", "top left"), $("#app_title_bg").css("background-repeat", "repeat repeat")) : $("#workspace_holder").length > 0 && ($(".workspace-backgrounds-fixed").length > 0 ? $("#MainContent_bg_" + Ba()).css("background", "#EFEFEF url('" + a.d + "') repeat top left") : ($("#maincontent_overflow").hasClass("maincontent_overflow-main-bg") && $("#maincontent_overflow").removeClass("maincontent_overflow-main-bg"), $("#maincontent_overflow").css("background-image", "url('" + a.d + "')"), $("#maincontent_overflow").css("background-color", "#EFEFEF"), $("#maincontent_overflow").css("background-position", "top left"), $("#maincontent_overflow").css("background-repeat", "repeat repeat"))), $(".image-selector-active").each(function () { $(this).removeClass("image-selector-active"), $(this).addClass("image-selector") }), e.addClass("image-selector-active")), openWSE.RemoveUpdateModal() } }) }), jQuery.fn.outerHTML = function (e) { return e ? this.before(e).remove() : jQuery("<p>").append(this.eq(0).clone()).html() }, $(document.body).on("click", "#ddl_WorkspaceSelector", function (e) { var a = $(this).find(".dropdown-db-selector"); if (a.length > 0 && -1 == e.target.className.indexOf("workspace-selection-item")) if (a.css("min-width", $("#ddl_WorkspaceSelector").outerWidth()), "block" != a.css("display")) { a.css("top", $("#always-visible").outerHeight()), a.find(".workspace-selection-item").show(); for (var t = $(".selected-workspace").html().replace("Workspace ", ""), o = 0; o < a.find(".workspace-selection-item").length; o++) { var i = a.find(".workspace-selection-item").eq(o); i.html().replace("Workspace ", "") == t ? i.addClass("font-bold") : i.removeClass("font-bold") } openWSE_Config.hoverPreviewWorkspace && $(".workspace-selection-item").hover(function () { var e = "#MainContent_" + openWSE.Getworkspace(), a = "#MainContent_workspace_" + $(this).html().replace("Workspace ", ""); openWSE.HoverWorkspacePreview(e, a) }, function () { if ("block" == a.find("ul").css("display")) { var e = "#MainContent_workspace_" + $(this).html().replace("Workspace ", ""), t = "#MainContent_workspace_" + $(".selected-workspace").html().replace("Workspace ", ""); openWSE.HoverWorkspacePreview(e, t) } }), $("#ddl_WorkspaceSelector").addClass("active"), a.slideDown(openWSE_Config.animationSpeed) } else openWSE.RemoveWorkspaceSelectorActive() }), $(document.body).on("click", ".workspace-selection-item", function () { openWSE.RemoveWorkspaceSelectorActive(); var e = $(".selected-workspace").html().replace("Workspace ", ""), a = $(this).html().replace("Workspace ", ""); if (e != a) { if (openWSE.SetWorkspaceNumber(a), !openWSE_Config.hoverPreviewWorkspace) { var t = "#MainContent_workspace_" + e, o = "#MainContent_workspace_" + a; openWSE.HoverWorkspacePreview(t, o) } $.ajax({ url: so + "/App_CurrentWorkspace", type: "POST", data: '{ "workspace": "' + a + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) } }); var Bo = { timer: 2e3 }, Io = function () { function e() { $("#always-visible, #container-footer").hover(function () { i || n || (t(), o = !0) }, function () { o = !1, setTimeout(function () { o || n || (o = !1, i = !0, a()) }, Bo.timer) }), $(document).keyup(function (e) { 27 == e.which && (n ? (n = !1, o = !1, i = !0, a(), openWSE.LoadingMessage1("AutoHide Mode On"), setTimeout(function () { openWSE.RemoveUpdateModal() }, Bo.timer)) : (n = !0, t(), o = !0, openWSE.LoadingMessage1("AutoHide Mode Off"), setTimeout(function () { openWSE.RemoveUpdateModal() }, Bo.timer))) }), setTimeout(function () { o || (o = !1, i = !0, a()) }, Bo.timer) } function a() { $("#always-visible, #container-footer").css("height", "8px"), $("#top-main-bar-top, .footer-padding").hide(), i = !1, $("#container, #iframe-container-helper").css("top", "8px"), $("#container, #iframe-container-helper").css("bottom", "8px"), $(window).resize() } function t() { $("#top-main-bar-top, .footer-padding").show(), $("#always-visible, #container-footer").css("height", ""), $("#container, #iframe-container-helper").css("top", ""), $("#container, #iframe-container-helper").css("bottom", ""), $(window).resize() } var o = !1, i = !1, n = !1; return { init: e } }(), Lo = { timer: 1e3 }, zo = function () { function e() { $("#container").append("<div id='presentationmodeText'>Presentation Mode is Off</div>"), a("To start 'Presentation Mode', press the ESC key"), $(document).keyup(function (e) { 27 == e.which && ($("#PresentationActivate-element").length > 0 && openWSE.LoadModalWindow(!1, "PresentationActivate-element", ""), null != s && clearTimeout(s), $("#presentationmodeText").remove(), 0 == n ? (n = !0, i(), $("#container").append("<div id='presentationmodeText'>Presentation Mode is Off</div>"), $("#update-element").remove(), openWSE.LoadingMessage1("Presentation Mode Off"), s = setTimeout(function () { openWSE.RemoveUpdateModal() }, Lo.timer)) : 1 == n ? (n = 2, o(), $("#container").append("<div id='presentationmodeText'>Presentation Edit Mode</div>"), $("#update-element").remove(), openWSE.LoadingMessage1("Presentation Mode Edit"), s = setTimeout(function () { openWSE.RemoveUpdateModal() }, Lo.timer)) : (n = 0, t(), $("#update-element").remove(), openWSE.LoadingMessage1("Presentation Mode On"), s = setTimeout(function () { openWSE.RemoveUpdateModal() }, Lo.timer))) }) } function a(e) { $(window).load(function () { var a = "<div id='PresentationActivate-element' class='Modal-element' style='display: none;'>"; a += "<div class='Modal-overlay'>", a += "<div class='Modal-element-align'>", a += "<div class='Modal-element-modal'>", a += "<div class='ModalPadContent' style='height: 30px;'><h3 class='pad-top float-left'><b class='pad-right-sml'>Note:</b>" + e + "</h3>", a += "<input type='button' class='input-buttons float-right no-margin' value='Ok' onclick='openWSE.LoadModalWindow(false, \"PresentationActivate-element\", \"\");setTimeout(function(){$(\"#PresentationActivate-element\").remove();},openWSE_Config.animationSpeed);' style='margin-top: 2px!important;' /></div>", a += "</div></div></div></div>", $("body").append(a), openWSE.LoadModalWindow(!0, "PresentationActivate-element", "") }) } function t() { $("#always-visible").addClass("header-presentation"), $("#container-footer").addClass("footer-presentation"), $("#always-visible, #container-footer").addClass("header-footer-presentation"), $(".username-top-info").addClass("top-menu-color-presentation"), $("#container, #iframe-container-helper").addClass("container-presentation"), $("body").addClass("body-presentation-bg"), $(".app-maximized").addClass("app-max-border-presentation"), $(".app-main-holder, .app-main-holder.selected, .workspace-overlays").addClass("body-presentation-bg app-max-border-presentation"), $(".app-main-holder, .app-main-holder.selected").addClass("no-shadow-presentation"), $(".app-min-bar, .app-min-bar-alt, .ui-icon-gripsmall-diagonal-se").css("background-image", "none"), $(".sidebar-padding-menulinks").hide(), $(".app-head, .app-head-button-holder, .overlay-header").hide(), $("#top-main-bar-top, .footer-padding").hide(), $(window).resize(), isHiding = !1 } function o() { $("#always-visible").addClass("header-presentation"), $("#container-footer").addClass("footer-presentation"), $("#always-visible, #container-footer").addClass("header-footer-presentation"), $(".username-top-info").addClass("top-menu-color-presentation"), $("#container, .pnl-overlaysAll, #iframe-container-helper").addClass("container-presentation"), $("body").addClass("body-presentation-bg"), $("#top-main-bar-top, .footer-padding").hide(), $(".sidebar-padding-menulinks").hide(), $(window).resize() } function i() { $("#always-visible").removeClass("header-presentation"), $("#container-footer").removeClass("footer-presentation"), $("#always-visible, #container-footer").removeClass("header-footer-presentation"), $(".username-top-info").removeClass("top-menu-color-presentation"), $("#container, .pnl-overlaysAll, #iframe-container-helper").removeClass("container-presentation"), $("body").removeClass("body-presentation-bg"), $(".app-maximized").removeClass("app-max-border-presentation"), $(".app-main-holder, .app-main-holder.selected, .workspace-overlays").removeClass("body-presentation-bg app-max-border-presentation"), $(".app-main-holder, .app-main-holder.selected").removeClass("no-shadow-presentation"), $(".app-min-bar, .app-min-bar-alt, .ui-icon-gripsmall-diagonal-se").css("background-image", ""), $(".sidebar-padding-menulinks").show(), $(".app-head, .app-head-button-holder, .overlay-header").show(), $("#top-main-bar-top, .footer-padding").show(), $(".app-body").each(function () { var e = null; $(this).find(".main-div-app-bg").length > 0 && (e = $(this).find(".main-div-app-bg")), null != e && (e.css("top", ""), e.css("bottom", "")) }), $(window).resize() } var n = 2, s = null; return { init: e } }(); return $.fn.AccordianTab = function (e) { function a() { l.find("." + d.headerClass).each(function () { 0 == $(this).find("." + d.menuDropDownClass).length && ($(this).append("<span class='" + d.menuDropDownClass + "'></span>"), d.startCollapsed ? ($(this).attr("title", d.expandTooltip), $(this).find("." + d.menuDropDownClass).addClass(d.collapsedClass), $(this).parent().find("." + d.bodyClass).hide()) : ($(this).attr("title", d.collapseTooltip), $(this).find("." + d.menuDropDownClass).addClass(d.expandedClass), $(this).parent().find("." + d.bodyClass).show())) }) } function t() { var e = !1; if ("function" == typeof cookie || "object" == typeof cookie) { if (d.createCookie) { var a = cookie.get("menubar-links-tab"); try { var t = a.split(","); if ("" != t && null != t) for (var o = 0; o < t.length; o++) if ("" != t[o]) { var s = l.find("#" + t[o]); if (s.length > 0) if (d.startCollapsed) { if (s.parent().find("." + d.headerClass).attr("title", d.collapseTooltip), s.parent().find("." + d.menuDropDownClass).removeClass(d.collapsedClass).addClass(d.expandedClass), s.show(), d.oneOpen) return } else (!d.allowCloseAll && i() > 1 || d.allowCloseAll || !d.startCollapsed && "block" == s.css("display")) && (s.parent().find("." + d.headerClass).attr("title", d.expandTooltip), s.parent().find("." + d.menuDropDownClass).removeClass(d.expandedClass).addClass(d.collapsedClass), s.hide()) } } catch (p) { } } else cookie.del("menubar-links-tab"); (!d.allowCloseAll && 0 == i() || !d.startCollapsed && i() == l.find("." + d.bodyClass).length) && (d.startCollapsed || n(), e = !0) } else e = !0; if (e && l.find("." + d.bodyClass).length > 0) { var s = l.find("." + d.bodyClass).eq(0); s.parent().find("." + d.headerClass).attr("title", d.collapseTooltip), s.show(), s.parent().find("." + d.menuDropDownClass).removeClass(d.collapsedClass).addClass(d.expandedClass) } } function o() { if (d.createCookie) { var e = ""; l.find("." + d.bodyClass).each(function () { "block" == $(this).css("display") && (e += $(this).attr("id") + ",") }), ("function" == typeof cookie || "object" == typeof cookie) && ("" != e ? cookie.set("menubar-links-tab", e, 30) : cookie.del("menubar-links-tab")) } } function i() { var e = 0; return l.find("." + d.bodyClass).each(function () { "block" == $(this).css("display") && e++ }), e } function n() { l.find("." + d.headerClass).each(function () { $(this).attr("title", d.expandTooltip), $(this).find("." + d.menuDropDownClass).addClass(d.collapsedClass), $(this).parent().find("." + d.bodyClass).hide() }) } function s() { var e = !1; if (l.find("." + d.bodyClass).each(function () { return "block" == $(this).css("display") ? void (e = !0) : void 0 }), !e) { var a = l.find("." + d.headerClass).find("." + d.menuDropDownClass), t = l.find("." + d.bodyClass); a.length > 0 && t.length > 0 && (a.eq(0).removeClass(d.collapsedClass).addClass(d.expandedClass), t.eq(0).show()) } } var l = this, p = { allowCloseAll: !1, oneOpen: !0, startCollapsed: !0, animationSpeed: 150, createCookie: !0, headerClass: "menu-title", bodyClass: "li-pnl-tab", collapsedClass: "menu-collapsed", expandedClass: "menu-expanded", menuDropDownClass: "menu-dd", expandTooltip: "Click to Expand", collapseTooltip: "Click to Collapse" }, d = $.extend({}, p, e); $(document).ready(function () { a(), t(), s() }), l.find("." + d.headerClass).on("click", function () { var e = $(this).find("." + d.menuDropDownClass), a = $(this).parent().find("." + d.bodyClass); if (0 != e.length && 0 != a.length) { var t = ""; if (e.hasClass(d.collapsedClass) ? (t = d.collapseTooltip, $(this).attr("title", t), e.removeClass(d.collapsedClass).addClass(d.expandedClass), a.slideDown(d.animationSpeed)) : (!d.allowCloseAll && i() > 1 || d.allowCloseAll) && (t = d.expandTooltip, $(this).attr("title", t), e.removeClass(d.expandedClass).addClass(d.collapsedClass), a.slideUp(d.animationSpeed)), d.oneOpen && l.find("." + d.bodyClass).each(function () { $(this).attr("id") != a.attr("id") && ($(this).parent().find("." + d.headerClass).attr("title", d.expandTooltip), $(this).parent().find("." + d.headerClass).find("." + d.menuDropDownClass).removeClass(d.expandedClass).addClass(d.collapsedClass), $(this).slideUp(d.animationSpeed)) }), null != $(this).attr("aria-describedby") && "" != $(this).attr("aria-describedby")) { var n = $(this).attr("aria-describedby"); $("#" + n).find(".ui-tooltip-content").html(t) } setTimeout(function () { o() }, 2 * d.animationSpeed) } }) }, { siteRoot: Ut, loadingImg: Qt, loadingImg_lrg: Xt, topBarHt: wo, AdjustTableSettingsBox: h, GetPagedAddOverlayAndModel: n, IsComplexWorkspaceMode: s, PagedWorkspace: i, SetContainerTopPos: o, SetTrialText: r, ConvertBitToBoolean: l, OpenMobileWorkspace: d, init: e, OnError: a, AdjustContainerLogo: t, autoupdate: c, LoadingMessage1: f, RemoveUpdateModal: u, AlertWindow: v, CloseAlertWindow: g, ReportAlert: b, ConfirmWindow: y, CloseConfirmWindow: w, StartMessageTickInterval: m, OnBrowserClose: C, CheckIfWorkspaceLinkAvailable: S, RadioButtonStyle: k, RatingStyleInit: W, UpdateAppRating: x, ResetRating: E, OpenAppNoti: M, SearchSite: A, ClearAppSearch: T, SearchExternalSite: O, LoadModalWindow: R, SaveInnerModalContent: B, LoadSavedInnerModalContent: I, LoadTopOptionsCookie: L, SetDropDownMaxHeight: z, ExpandAdminLinks: Ft, HelpOverlay: N, HelpMenuPageLoad: H, NewUserPageLoad: F, NewUserfinsh: K, OnEmailUpdate_KeyPress: q, OnPasswordUpdate_KeyPress: V, UpdateEmail: U, UpdateAdminPassword: D, ShowUpdatesPopup: X, ShowActivationPopup: J, CloseUpdatesPopup: Z, OverlayDisable: ea, TryAddLoadOverlay: aa, TryRemoveLoadOverlay: ta, CallOverlayList: oa, AddRemoveOverlayClick: ia, CreateOverlayTable: na, GetUserNotifications: la, NotiActionsClearAll: fa, NotiActionsHideInd: ma, LoadCreateAccountHolder: $a, LoadRecoveryPassword: ba, SetPostalCode: ya, WeatherBuilder: wa, LoadIFrameContent: Ca, LoadIFrameContentHistory: Sa, CloseIFrameContent: ka, BackgroundSelector: Wa, ClearBackground: xa, CloseBackgroundSelector: Ea, updateBackgroundURL: Ma, updateBackgroundColor: Aa, HideTasks: Oa, ShowTasks: Pa, LoadCurrentWorkspace: Ra, Getworkspace: Ba, HoverWorkspacePreview: Ia, SetWorkspaceNumber: La, RemoveWorkspaceSelectorActive: za, AutoRotateWorkspace: Na, AutoUpdateOnRotate: ja, AppsSortUnlocked: Ha, CreateSOApp: Fa, BuildAppMinIcon: Ua, LoadApp: Da, LoadAppFromSiteTools: Ga, DetermineNeedPostBack: qa, WatchForLoad: Va, LoadUserControl: Ya, MoveOutsideModalWindows: Ka, ResizeAllAppBody: Xa, ResizeAppBody: Ja, ApplyOverlayFix: Za, RemoveOverlayFix: et, MoveOffScreen: at, MoveOnScreen_WorkspaceOnly: tt, MoveToCurrworkspace: ot, SetAppMaxToMin: it, SetAppMinToMax: nt, HoverOverAppMin: st, HoverOutAppMin: lt, SetNoticiationsMaxHeight: ua, SetActiveApp: pt, SetDeactiveApps: dt, SetDeactiveAll: rt, LoadActiveAppCookie: ct, LoadCategoryCookies: ht, MaximizeApp: vt, StartRemoteLoad: ft, LoadRemotely: mt, SetRemoteLoadingOptions: ut, SetAppIconActive: gt, AddworkspaceAppNum: $t, RemoveworkspaceAppNum: bt, RemoveAppIconActive: yt, CategoryClick: wt, ApplyAppDragResize: Ct, ReloadApp: St, AboutApp: kt, UninstallApp: _t, PopOutFrame: Wt, PopOutFrameFromSiteTools: xt, PopOutTool: Et, MoveAppToworkspace: Mt, getInternetExplorerVersion: At, checkVersion: Tt, GroupLoginModal: Ot, LoginAsGroup: Pt, CloseGroupLoginModal: Rt, AutoHideMode: Io, PresentationMode: zo, HashChange: Bt, AcceptGroupNotification: Lt, SubmitFeedback: zt, ToolView: Nt, ResizeContainer: Ht, GetElementClassList: Dt }
}(); $(window).resize(function () { openWSE.SetContainerTopPos(!0), openWSE.ResizeContainer(); var e = openWSE.Getworkspace(); openWSE.ResizeAllAppBody($($("#MainContent_" + e).length > 0 ? "#MainContent_" + e : "body")) }), $(document).ready(function () { openWSE.init(), openWSE.SetContainerTopPos(!1), openWSE.LoadCategoryCookies(), openWSE.LoadTopOptionsCookie(), openWSE.checkVersion(), openWSE.GetUserNotifications(!0), openWSE.HashChange(), openWSE.ResizeContainer(); var e = openWSE.Getworkspace(); openWSE.ResizeAllAppBody($("#MainContent_" + e)), $("#searchbox-app-search").length > 0 && $("#searchbox-app-search").autocomplete({ minLength: 1, autoFocus: !0, source: function (e, a) { $.ajax({ url: openWSE.siteRoot() + "WebServices/AutoComplete.asmx/GetAppSearchList", data: "{ 'prefixText': '" + e.term + "', 'count': '10' }", dataType: "json", type: "POST", contentType: "application/json; charset=utf-8", dataFilter: function (e) { return e }, success: function (e) { a($.map(e.d, function (e) { return { label: e, value: e } })) } }) } }).focus(function () { $(this).autocomplete("search", "") }) }), $(function () { $(window).hashchange(function () { openWSE.HashChange() }), openWSE_Config.displayLoadingOnRedirect && ($("#lnk_BackToWorkspace, .app-icon-links, .app-icon-sub-links, .title-dd-name").click("click", function (e) { "img-expand-sml" != e.target.className && "img-collapse-sml" != e.target.className && "_blank" != $(this).attr("target") && openWSE.LoadingMessage1("Loading...") }), openWSE.IsComplexWorkspaceMode() || $(".app-icon").click("click", function (e) { "app-options" != e.target.className && "_blank" != $(this).attr("target") && openWSE.LoadingMessage1("Loading...") })) }), window.onerror = function (e, a) { a = window.location.href, (-1 == a.toLowerCase().indexOf("networklog.aspx") || "Uncaught TypeError: boolean is not a function" != e) && (openWSE_Config.reportAlert ? openWSE.AlertWindow(e, a) : openWSE.OnError(e, a)) }, $(window).load(function () { openWSE.ApplyAppDragResize(); var e = openWSE.Getworkspace(); openWSE.ResizeAllAppBody($("#MainContent_" + e)), openWSE.AdjustContainerLogo(), $("#container_logo").length > 0 && $("#container_logo").css({ visibility: "visible" }), openWSE.LoadActiveAppCookie(), openWSE_Config.taskBarShowAll || ($(".app-min-bar").hide(), $("#MainContent_" + e).find(".app-main-holder").each(function () { var e = $(this).attr("data-appid"); 0 != $("#minimized-app-bar").find(".app-min-bar[data-appid='" + e + "']").length && "none" == $("#minimized-app-bar").find(".app-min-bar[data-appid='" + e + "']").css("display") && $("#minimized-app-bar").find(".app-min-bar[data-appid='" + e + "']").show() })), openWSE.MoveOutsideModalWindows() }), $.extend({ LoadingMessage: function () { try { var e = arguments[0], a = arguments[1]; (null == a || "" == a || void 0 == a) && (a = "Updating. Please Wait..."), $("#update-element").length > 0 && $("#update-element").remove(); var t = "<div id='update-element'><div class='update-element-overlay' style='position: absolute!important'><div class='update-element-align' style='position: absolute!important'>"; t += "<div class='update-element-modal'>" + openWSE.loadingImg + "<h3 class='inline-block'>" + a + "</h3></div></div></div></div>", $(e).append(t), $("#update-element").fadeIn(openWSE_Config.animationSpeed) } catch (o) { } } });