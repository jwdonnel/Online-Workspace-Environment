var openWSE_Config = { siteName: "", demoMode: false, siteTheme: "Standard", animationSpeed: 200, hoverPreviewWorkspace: false, taskBarShowAll: true, ShowWorkspaceNumApp: true, desktopCSS: "site_desktop.css", mobileCSS: "site_mobile.css", winMinWidth: 1e3, minPasswordLength: 6, workspaceMode: "", overlayPanelId: "pnl_OverlaysAll", reportAlert: true, siteRootFolder: "", displayLoadingOnRedirect: true }; var openWSE = function () { function I() { console.log(openWSE_Config); m = openWSE.siteRoot() + "WebServices/SaveControls.asmx"; Pr(); Fr(); $("#accordian-sidebar").AccordianTab({ allowCloseAll: true, oneOpen: true, startCollapsed: true, animationSpeed: openWSE_Config.animationSpeed, createCookie: true }); if ($("#user_profile_tab").length > 0) { $("#user_profile_tab").find(".b").css("min-width", $(".top-options").outerWidth()) } if (openWSE_Config.demoMode) { $(".bgchange-icon").remove() } if (!openWSE.CheckIfWorkspaceLinkAvailable()) { if ($("#lnk_BackToWorkspace").length > 0) { $("#lnk_BackToWorkspace").remove() } } } function q(e, t) { var n = openWSE.siteRoot() + "WebServices/AppLog_Errors.asmx/AddError"; $.ajax({ url: n, type: "POST", data: '{ "message": "' + escape(e) + '","url": "' + escape(t) + '" }', contentType: "application/json; charset=utf-8" }) } function R() { if ($("#container_logo").length > 0) { var e = $("#container_logo").height(); var t = $("#container_logo").width(); var n = -(e / 2); var r = -(t / 2); $("#container_logo").css({ marginLeft: r, marginTop: n }) } } function U(e) { P = $("#always-visible").outerHeight(); H = $("#container-footer").outerHeight(); if ($("#always-visible").css("display") == "none") { P = 0 } if ($("#container-footer").css("display") == "none") { H = 0 } $("#container, #iframe-container-helper").css("top", P); $("#container, #iframe-container-helper, .administrator-workspace-note").css("bottom", H); R(); if (e) { if ($("#iframe-content-src").length > 0) { $("#iframe-content-src").css("height", $(window).height() - ($("#always-visible").height() + $("#container-footer").height())); $("#iframe-content-src").css("width", $(window).width()) } openWSE.SetNoticiationsMaxHeight(); openWSE.SetDropDownMaxHeight() } } function z(e) { Cn("1"); if (e != "" && $("#" + e + "-pnl-icons").length != 0) { F = true; $("#" + e).addClass("auto-full-page"); $("#" + e).find(".app-head, .app-head-button-holder").hide(); $("#" + e + "-pnl-icons").trigger("click") } } function W() { $("#" + openWSE_Config.overlayPanelId).append($(".addOverlay-bg")); $("#" + openWSE_Config.overlayPanelId).append($("#overlayEdit-element")); $(".addOverlay-bg").css({ bottom: $("#container-footer").outerHeight(), left: $("#sidebar_menulinks").outerWidth() }) } function X() { $("#workspace-selector").append($("#searchwrapper-app-search")); $("#app_search_tab").remove(); var e = $("#searchwrapper-app-search").find("#searchbox-app-search"); if (e.length != 0) { e.parent().addClass("search-blur"); e.val("Search"); e.blur(function () { $(this).parent().addClass("search-blur"); if ($(this).val().toLowerCase() == "") { $(this).val("Search") } }).focus(function () { $(this).parent().removeClass("search-blur"); if ($(this).val().toLowerCase() == "search") { $(this).val("") } }) } } function V() { if (openWSE_Config.workspaceMode.toLowerCase() == "complex" || openWSE_Config.workspaceMode == "") { return true } return false } function J(e) { if (e != null && e != undefined) { var t = $.trim(e.toString().toLowerCase()); if (t != "true" && t != "false" && t != "0" && t != "1" && t != "") { return true } if (t == "1" || t == "true" || t == "") { return true } else if (t == "0" || t == "false") { return false } } return false } function K() { window.open(openWSE.siteRoot() + "AppRemote.aspx", "_blank", "toolbar=no, scrollbars=yes, resizable=yes, width=340, height=550"); return false } function Q(e) { var t = "<div class='trial-version-text'><span>Trial Version</span><span class='float-right'>Expires in " + e + "</span></div>"; $("#maincontent_overflow").prepend(t) } function G(r, s, o) { if (e == "" && r != "") { e = r } if (t == "" && s != "") { t = s } if (n == "" && o != "") { n = o } if (e != "" && t != "" && n != "") { if (i == 0) { $.ajax({ url: s, data: '{ "_appId": "' + escape(n) + '" }', contentType: "application/json; charset=utf-8", dataType: "json", type: "POST", success: function (r) { var s = r.d[0]; if (s == "TURNOFF") { i = 1; return } else if (s == "refresh") { i = 0; document.getElementById(e).value = "refresh"; __doPostBack(e, "") } else if (s != "false" && s != "") { try { if (openWSE.ConvertBitToBoolean(r.d[1])) { i = 0; et("Receiving Request..."); rr(s, e, t, n) } else { i = 0; document.getElementById(e).value = s; __doPostBack(e, "") } } catch (o) { i = 0; G(e, t, n) } } else { i = 0; G(e, t, n) } }, error: function () { i = 0; G(e, t, n) } }); i = 1 } } } function et(e) { nt(); if (e.indexOf("...") != -1) { e = e.replace("...", "") } e = e + "<span class='progress inline-block'></span>"; var t = "<div id='update-element'><div class='update-element-overlay'><div class='update-element-align'>"; t += "<div class='update-element-modal'>" + s + "<h3 class='inline-block'>" + e + "</h3></div></div></div></div>"; $("body").append(t); tt($("#update-element").find(".progress")[0]); $("#update-element").show(); var n = $("#update-element").find(".update-element-modal"); var r = -(n.outerWidth() / 2); var i = -(n.outerHeight() / 2); n.css({ marginLeft: r, marginTop: i }) } function tt(e) { Z = setInterval(function () { var t = ""; switch (Y) { case 0: t = "."; Y++; break; case 1: t = ".."; Y++; break; case 2: t = "..."; Y++; break; default: t = ""; Y = 0; break } $(e).html(t) }, 500) } function nt() { if (Z != null) { clearInterval(Z) } $("#update-element").remove() } function rt(e, t) { if (e == "" || e == null) { e = "An error has occured that was not specified." } var n = "<div id='AlertWindow-element' class='Modal-element' style='display: none;'>"; n += "<div class='Modal-overlay'>"; n += "<div class='Modal-element-align'>"; n += "<div class='Modal-element-modal'>"; n += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>"; n += "<a href='#' onclick=\"openWSE.CloseAlertWindow();return false;\" class='ModalExitButton'></a>"; n += "</div><span class='Modal-title'></span></div></div>"; var r = "<input class='input-buttons confirm-ok-button' type='button' value='Ok' onclick=\"openWSE.CloseAlertWindow();\" style='width: 50px;' />"; var i = ""; if (openWSE_Config.reportAlert) { i = "<input class='input-buttons no-margin confirm-report-button' type='button' value='Report' onclick=\"openWSE.ReportAlert('" + escape(e) + "','" + escape(t) + "');\" style='margin-left: 16px!important;' />" } if (openWSE_Config.siteTheme == "") { openWSE_Config.siteTheme = "Standard" } var s = "<img alt='confirm' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Icons/alert.png' />"; n += "<div class='ModalPadContent'><div class='message-text'>" + s + e + "</div><div class='button-holder'>" + r + i + "</div></div>"; n += "</div></div></div></div>"; $("body").append(n); Et(true, "AlertWindow-element", "Message"); $("#AlertWindow-element").find(".confirm-ok-button").focus() } function it() { if ($("#AlertWindow-element").length > 0) { $("#AlertWindow-element").hide(); $("#AlertWindow-element").remove() } } function st(e, t) { if (t == "" || t == null) { t = window.location.href } q(unescape(e), unescape(t)); it() } function ot(e, t, n) { if (e == "" || e == null) { e = "Are you sure you want to continue?" } var r = "<div id='ConfirmWindow-element' class='Modal-element' style='display: none;'>"; r += "<div class='Modal-overlay'>"; r += "<div class='Modal-element-align'>"; r += "<div class='Modal-element-modal'>"; r += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>"; r += "<a href='#' onclick=\"openWSE.CloseConfirmWindow();return false;\" class='ModalExitButton confirm-cancel-button-header'></a>"; r += "</div><span class='Modal-title'></span></div></div>"; var i = "<input class='input-buttons confirm-ok-button' type='button' value='Ok' style='width: 60px;' />"; var s = "<input class='input-buttons confirm-cancel-button' type='button' value='Cancel' />"; if (openWSE_Config.siteTheme == "") { openWSE_Config.siteTheme = "Standard" } var o = "<img alt='confirm' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Icons/confirm.png' />"; r += "<div class='ModalPadContent'><div class='message-text'>" + o + e + "</div><div class='button-holder'>" + i + s + "</div></div></div>"; r += "</div></div></div></div>"; $("body").append(r); $("#ConfirmWindow-element").find(".confirm-ok-button").one("click", function () { openWSE.CloseConfirmWindow(); if (t != null) { t() } }); $("#ConfirmWindow-element").find(".confirm-cancel-button, .confirm-cancel-button-header").one("click", function () { openWSE.CloseConfirmWindow(); if (n != null) { n() } }); Et(true, "ConfirmWindow-element", "Confirmation"); $("#ConfirmWindow-element").find(".confirm-ok-button").focus() } function ut() { if ($("#ConfirmWindow-element").length > 0) { $("#ConfirmWindow-element").hide(); $("#ConfirmWindow-element").remove() } } function at() { $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/OnBrowserClose", data: "", dataType: "json", type: "POST", contentType: "application/json; charset=utf-8", dataFilter: function (e) { return e } }) } function ft() { var e = false; $("#pnl_settingLinks").find(".app-icon-links").each(function () { var t = $(this).find(".app-icon-font"); if (t.html().toLowerCase() == "workspace") { e = true } }); return e } function ct() { $(".switch").each(function () { var e = $(this); if (e.find(".RadioButton-Toggle-Overlay").length == 0) { var t = $(this).find(".cb-enable"); var n = $(this).find(".cb-disable"); if (e.find(".switch-slider").length == 0) { e.append("<div class='switch-slider'><table class='switch-slider-table' cellpadding='0' cellspacing='0'><tbody><tr><td class='td-enable'></td><td class='td-switch' title='Click or Drag'></td><td class='td-disable'></td></tr></tbody></table></div>"); e.find(".td-enable").append(t); e.find(".td-switch").html("<span class='RadioButton-Toggle-Overlay'></span>"); e.find(".td-disable").append(n); t.removeClass("RandomActionBtns"); n.removeClass("RandomActionBtns"); var r = e.find(".cb-enable").outerWidth(); if (r == 0) { r = e.find(".cb-enable").find("label").outerWidth() } var i = r + e.find(".RadioButton-Toggle-Overlay").outerWidth(); e.width(i - 2); var s = e.outerWidth() - e.find(".RadioButton-Toggle-Overlay").outerWidth() + 2; var o = t.find("input"); var u = n.find("input"); if (ht(o) && o.prop("checked") || t.hasClass("selected")) { t.addClass("selected"); n.removeClass("selected"); o.prop("checked", true); u.prop("checked", false); e.find(".switch-slider").css("left", 0) } else { n.addClass("selected"); t.removeClass("selected"); u.prop("checked", true); o.prop("checked", false); e.find(".switch-slider").css("left", -s) } } else { e.find(".td-switch").html("<span class='RadioButton-Toggle-Overlay'></span>") } e.find(".switch-slider").draggable({ cancel: ".cb-enable, .cb-disable", axis: "x", drag: function (e, t) { var n = $(this).parent().outerWidth() - $(this).find(".RadioButton-Toggle-Overlay").outerWidth() + 2; if (t.position.left < -n) { $(this).css("left", -n); return false } if (t.position.left >= 0) { $(this).css("left", 0); return false } }, stop: function (t, n) { var r = $(this).parent().outerWidth() - $(this).find(".RadioButton-Toggle-Overlay").outerWidth() + 2; var i = r / 2; var s = false; var o = true; e.find(".cb-disable").each(function () { var e = $(this).find("input"); var t = e.attr("checked"); if ($(this).hasClass("selected")) { o = false } }); if (n.position.left > -i) { s = true; $(this).animate({ left: 0 }, openWSE_Config.animationSpeed) } else { $(this).animate({ left: -(i * 2) }, openWSE_Config.animationSpeed) } if (o && !s) { lt = true; e.find(".cb-disable").find("input").trigger("click") } else if (!o && s) { lt = true; e.find(".cb-enable").find("input").trigger("click") } } }) } }) } function ht(e) { var t = $(e)[0].attributes.checked; if (typeof t !== typeof undefined && t !== false) { return true } return false } function pt(e, t, n, r, i) { try { var s = false; if (n) { s = true } var o = openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme; $(e).attr("data-average", t); $(e).attr("data-id", "1"); var u = "big"; if (!i) { u = "small" } $(e).jRating({ step: true, type: u, showRateInfo: false, canRateAgain: true, nbRates: 100, bigStarsPath: o + "/Icons/star-rating-lrg.png", smallStarsPath: o + "/Icons/star-rating-sml.png", isDisabled: s, decimalLength: 2, length: 4, rateMax: 4, rateMin: 0, phpPath: "", sendRequest: true, onClick: function (s, o) { $("#AppRating-element").remove(); var u = "<div id='AppRating-element' class='Modal-element'><div class='Modal-overlay'><div class='Modal-element-align'><div class='Modal-element-modal' style='min-width: 350px;'>"; u += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'></div><span class='Modal-title'></span></div></div>"; u += "<div class='ModalPadContent'></div></div></div></div></div>"; $("#aboutApp-element").find(".ModalPadContent").append(u); var a = "<div class='pad-bottom'>Add a comment to your rating or just press Submit.</div>"; a += "<textarea id='app-rating-comment' rows='4' cols='40' style='width: 96%; font-family: arial; font-size: 14px; padding: 5px; border: 1px solid #DDD;'></textarea>"; a += "<div class='clear-space'></div>"; a += "<input class='float-left no-margin input-buttons' type='button' value='Cancel' onclick='openWSE.ResetRating(\"" + e + '", "' + t + '", ' + n + ', "' + r + '", ' + i + ');$("#AppRating-element").remove();\' />'; a += "<input class='float-right no-margin input-buttons' type='button' value='Submit' onclick='openWSE.UpdateAppRating(\"" + e + '", "' + o + '", ' + n + ', "' + r + '", ' + i + ");' />"; a += "<div class='clear-space-five'></div>"; $("#AppRating-element").find(".ModalPadContent").html(a); Et(true, "AppRating-element", "Rating Comment") } }); if (!i) { $(e).find(".jStar").addClass("jStar-Small") } } catch (a) { } } function dt(e, t, n, r, i) { et("Updating rating..."); $.ajax({ url: openWSE.siteRoot() + "WebServices/SaveControls.asmx/UpdateAppRating", type: "POST", data: '{ "rating": "' + t + '","appId": "' + r + '","description": "' + $("#app-rating-comment").val() + '" }', contentType: "application/json; charset=utf-8", success: function (s) { $("#AppRating-element").remove(); if ($("#MainContent_btn_refreshStats").length > 0) { __doPostBack("ctl00$MainContent$btn_refreshStats", "") } else { openWSE.RemoveUpdateModal(); openWSE.ResetRating(e, t, n, r, i) } } }) } function vt(e, t, n, r, i) { $(e).html(""); pt(e, t, n, r, i) } function mt(e) { var t = e.replace("-pnl-icons", ""); $(".top-options li.a").removeClass("active"); $(".top-options li.b").hide(); if (openWSE.IsComplexWorkspaceMode()) { if ($("#workspace_holder").length > 0) { if ($("#" + t).css("display") == "none") { b = 1; var n = kn(); Bn($("#" + e), n); if ($("#" + e).find("span").hasClass("active") == false) { $("#" + e).find("span").addClass("active") } } } else { wt($("#" + e)) } } else { window.location.href = openWSE.siteRoot() + "Workspace.aspx?AppPage=" + t } } function gt() { var e = $.trim($("#searchbox-app-search").val()); if (e != "") { et("Searching. Please Wait..."); document.getElementById("hf_SearchSite").value = e; $("#searchbox-app-search").val(""); __doPostBack("hf_SearchSite", "") } } function yt() { if ($("#searchbox-app-search").parent().parent().attr("id") == "workspace-selector") { $("#searchbox-app-search").val("Search") } else { $("#searchbox-app-search").val("") } } function bt(e) { $(".top-options li.a").removeClass("active"); $(".top-options li.b").hide(); window.open("http://google.com/search?q=" + e) } function wt(e) { var t = $(e); var n = "<div id='MessageActivationPopup' style='display: none;'>"; n += "<div class='message-element-align'>"; n += "<div class='message'>"; var r = t.find(".app-icon-font").text(); if (r == "") { r = t.find(".app-title").text(); if (r == "") { r = t.find("span").text() } } var i = t.attr("id"); if (i == undefined || i == null || i == "") { i = t.parent().attr("id") } var s = ""; if (t.attr("popoutloc") != "" && t.attr("popoutloc") != undefined && t.attr("popoutloc") != null) { var o = t.attr("popoutloc"); s = "<div class='clear-space'></div><a href='#' class='sb-links' onclick='openWSE.PopOutFrameFromSiteTools(\"" + r + '", "' + o + "\");return false;'>Open in new window</a>" } var u = "1"; if (t.attr("currentworkspace") != "" && t.attr("currentworkspace") != undefined && t.attr("currentworkspace") != null) { u = t.attr("currentworkspace") } var a = "<input type='button' class='input-buttons' value='Yes' style='width: 50px;' onclick='openWSE.LoadAppFromSiteTools(\"" + i + '", "' + r + '", "workspace_' + u + "\");' />"; var f = "<input type='button' class='input-buttons no-margin' value='No' style='width: 50px; margin-left: 10px!important;' onclick='$(\"#MessageActivationPopup\").hide();$(\"#MessageActivationPopup\").remove();return false;' />"; var l = "You must be on the workspace to load this app. Would you like to go back to your workspace?"; if (!openWSE.CheckIfWorkspaceLinkAvailable()) { a = ""; var f = "<input type='button' class='input-buttons no-margin' value='Close' onclick='$(\"#MessageActivationPopup\").hide();$(\"#MessageActivationPopup\").remove();return false;' />"; l = "You are not authorized to use the workspace. "; if (s != "") { l += "However, you can open this app in a seperate window." } } n += "<h4 class='font-bold'>" + r + "</h4><div class='clear-space'></div>"; n += l + "<div class='clear' style='height: 20px;'></div>" + a + f + s; n += "</div></div></div>"; $("body").append(n); $("#MessageActivationPopup").show(); var c = $("#MessageActivationPopup").find(".page-load-message").height() / 2; $("#MessageActivationPopup").find(".page-load-message").css("margin-top", "-" + c + "px") } function Et(e, t, n) { var r = $("#" + t); if (e) { r.show(); var i = r.find(".Modal-element-modal"); if (i.outerWidth() > $(window).width()) { i.css({ minWidth: 50, width: $(window).width() }); i.find(".ModalPadContent").css("overflow", "auto") } r.find(".Modal-element-align").css({ marginTop: -(r.find(".Modal-element-modal").height() / 2), marginLeft: -(r.find(".Modal-element-modal").width() / 2) }); var s = "#container"; if ($("#container").length == 0 || r.hasClass("outside-main-app-div") && $(".workspace-holder").length > 0) { if ($("#maincontent_overflow").length > 0) { s = "#maincontent_overflow" } else { s = "body" } } i.draggable({ containment: s, cancel: ".ModalPadContent, .ModalExitButton, #MainContent_pwreset_overlay", drag: function (e, t) { var n = $(this); n.css("opacity", "0.6"); n.css("filter", "alpha(opacity=60)"); if (n.find("iframe").length > 0) { var r = n.find(".ModalPadContent"); $wo = r.find(".app-overlay-fix"); if ($wo.length == 0) { if (r.length == 1) { r.append("<div class='app-overlay-fix'></div>") } } } }, stop: function (e, t) { var n = $(this); n.css("opacity", "1.0"); n.css("filter", "alpha(opacity=100)"); $wo = $(this).find(".app-overlay-fix"); if ($wo.length == 1) { $wo.remove() } } }); if (n != "") { r.find(".Modal-title").html(n) } r.css("visibility", "visible") } else { r.hide(); r.css("visibility", "hidden"); r.find(".Modal-title").html(""); r.find(".Modal-element-modal").find(".ModalPadContent").css("overflow", "") } } function St(e) { try { var t = e.get_postBackElement(); if (t != null) { if (t.id == "hf_UpdateAll" || t.id == "MainContent_hf_UpdateAll") { if (l.length == 0) { l = new Array; $(".Modal-element").each(function () { var e = $(this); if (e.css("display") == "block" && e.find("iframe").length == 0) { var t = escape($.trim(e.find(".ModalPadContent").html())); if (t != "" && t != "undefined" && t != null) { var n = new Array; if (e.attr("id") != "") { n[0] = e.attr("id"); n[1] = t; l.push(n) } } } }) } } } } catch (n) { } if ($(".Modal-element").css("display") != "none") { var r = $(".Modal-element").find(".modal-inner-scroll"); if (r.length > 0) { u = r.scrollTop() } } } function xt() { if (l.length > 0) { $(".Modal-element").each(function () { var e = $(this); if (e.css("display") == "block" && e.find("iframe").length == 0) { for (var t = 0; t < l.length; t++) { if (l[t][0] == e.attr("id")) { var n = unescape(l[t][1]); e.find(".ModalPadContent").html(n); break } } } }); l = new Array } if ($(".Modal-element").css("display") == "block") { var e = $(".Modal-element").find(".modal-inner-scroll"); if (e.length > 0) { e.scrollTop(u); u = 0 } } } function Tt() { var e = cookie.get("top_menu"); if (e != "" && e != null && e != undefined) { $(".top-options li.b").each(function (t) { if (t == e) { $(this).show(); var n = $(this).prev(); if (n.length == 1) { n.addClass("active") } Nt() } }) } } function Nt() { $(".top-options li.b").each(function () { if ($(this).is(":visible")) { var e = $(window).height() - 98; $(this).find(".li-pnl-tab").css("max-height", e) } }) } function At(e) { if ($("#help_main_holder").css("display") == "none") { if ($("#iframe-container-helper").length > 0) { mn() } Ct = e; setTimeout(function () { var e = ""; var t = window.location.hash; if (t.indexOf("#") == -1 && window.location.href.charAt(window.location.href.length - 1) != "#") { e = "#?" } else if (t != "") { e = "&" } else { e = "?" } e += "help"; window.location += e }, openWSE_Config.animationSpeed) } else { qt() } } function Ot() { var e = m + "/GetTotalHelpPages"; $.ajax({ url: e, type: "POST", data: '{ "currentPage": "' + document.location.href + '" }', contentType: "application/json; charset=utf-8", success: function (e) { var t = parseInt(e.d); if (t > 0) { h = t; Mt(0, Ct); $("#help_main_holder").fadeIn(openWSE_Config.animationSpeed) } else { if (!Ct) { openWSE.AlertWindow("There are no help pages available for this webpage."); qt() } else { _t(); $("#help_main_holder").fadeIn(openWSE_Config.animationSpeed) } } }, error: function () { if (!Ct) { openWSE.AlertWindow("There was an error retrieving the help pages. Please try again."); qt() } else { _t(); $("#help_main_holder").fadeIn(openWSE_Config.animationSpeed) } } }) } function Mt(e, t) { var n = "<span class='pad-left'>Welecome to " + openWSE_Config.siteName + "</span>"; if (!t) { n = "<span class='pad-left'>" + openWSE_Config.siteName + " Help Pages</span>" } var r = ""; if (!t) { r += "<input type='button' class='input-buttons float-left' onclick='openWSE.HelpOverlay(false, " + Lt + ")' value='Close' />" } if (e + 1 < h) { r += "<input type='button' class='input-buttons float-right' onclick='openWSE.HelpMenuPageLoad(" + (e + 1).toString() + "," + t + ")' value='Next' />" } else if (e + 1 == h && t) { r += "<input type='button' class='input-buttons float-right' onclick='openWSE.NewUserPageLoad()' value='Next' />" } if (e > 0) { r += "<input type='button' class='input-buttons float-right' onclick='openWSE.HelpMenuPageLoad(" + (e - 1).toString() + "," + t + ")' value='Back' />" } $("#helpmenu_title").html("<div class='help-Title-Top'>" + n + r + "</div>"); e += 1; var i = document.location.href; i = i.substring(i.lastIndexOf("/") + 1); i = i.replace(i.substring(i.indexOf(".")), ""); et("Loading..."); $("#helpdiv_pageholder").load(openWSE.siteRoot() + "HelpPages/" + i + "/HelpPage" + e + ".html", function () { nt(); $(".help-images-workspace-img").each(function () { if (!$(this).hasClass("ignoreSrc")) { var e = $(this).attr("src"); $(this).attr("src", openWSE.siteRoot() + "HelpPages/" + i + "/images/" + e) } }) }) } function _t() { var e = "<span class='pad-left'>Welecome to " + openWSE_Config.siteName + "</span>"; var t = ""; t += "<input id='btnFinish' type='button' class='input-buttons float-right display-none' onclick='openWSE.NewUserfinsh()' value='Finish' />"; if (h > 0) { t += "<input type='button' class='input-buttons float-right' onclick='openWSE.HelpMenuPageLoad(" + (h - 1).toString() + ",true)' value='Back' />" } $("#helpmenu_title").html("<div class='help-Title-Top'>" + e + t + "</div>"); $("#helpdiv_pageholder").html("<div style='position: absolute; top: 50%; left: 50%; margin-left: -95px; margin-top: -45px; padding: 20px;'><div class='loading-icon-lrg margin-top-sml'></div><h3 style='color: #FFF; float: left; font-weight: bold;'>Loading Step....</h3></div>"); et("Loading..."); $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/CheckForEmailAddress", data: "", type: "POST", contentType: "application/json; charset=utf-8", success: function (e) { kt = openWSE.ConvertBitToBoolean(e.d[0]); Lt = openWSE.ConvertBitToBoolean(e.d[1]); var t = ""; if (!kt && !Lt) { t = Ft() } else { t = Ht() } $("#helpdiv_pageholder").html(t); nt() } }) } function Dt() { var e = $.trim($("#tb_emailaddress_update").val()); if (e != "") { et("Updating..."); $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/AddEmailAddress", data: '{"email": "' + escape(e) + '"}', type: "POST", contentType: "application/json; charset=utf-8", success: function (e) { if (openWSE.ConvertBitToBoolean(e.d)) { kt = false; $("#update-email-helpdiv").remove() } if ($("#update-password-helpdiv").length == 0) { _t() } nt() } }) } } function Pt() { var e = $.trim($("#tb_newpassword_update").val()); var t = $.trim($("#tb_confirmnewpassword_update").val()); $("#span_passwordmismatch").html(""); if (e == "") { $("#span_newpassword_update").show() } else { $("#span_newpassword_update").hide() } if (t == "") { $("#span_confirmnewpassword_update").show() } else { $("#span_confirmnewpassword_update").hide() } if (e == t && e != "" && t != "") { if (e.length < openWSE_Config.minPasswordLength) { $("#span_passwordmismatch").html("Password does not meet requirements.") } else { et("Updating..."); $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/UpdateAdminPassword", data: '{"password1": "' + escape(e) + '"}', type: "POST", contentType: "application/json; charset=utf-8", success: function (e) { if (openWSE.ConvertBitToBoolean(e.d)) { Lt = false; $("#update-password-helpdiv").remove() } if ($("#update-email-helpdiv").length == 0) { _t() } nt() } }) } } else { if (e != "" && t != "") { $("#span_passwordmismatch").html("Passwords do not match.") } } } function Ht() { var e = ""; if (kt) { e += "<div id='update-email-helpdiv' class='pad-all' align='center'>"; e += "<h3>Before you can continue, you must provide a valid email address.<br />This email address will be used for notifications and password recovery.<br />If you fail to provide a valid email address, you will not be able to use the password recovery feature on the login page.</h3>"; e += "<div class='clear-space'></div>"; e += "<div class='clear-space'></div>"; e += "<h3>Please provide a valid email address</h3>"; e += "<div class='clear-space'></div>"; e += "<span class='pad-right font-bold'>Email Address</span><input type='text' id='tb_emailaddress_update' onkeypress='openWSE.OnEmailUpdate_KeyPress(event)' class='textEntry margin-right' style='width: 200px;' />"; e += "<input type='button' class='input-buttons' onclick='openWSE.UpdateEmail()' value='Update' />"; e += "<div class='clear-space'></div>"; e += "<div class='clear-space'></div>"; e += "<div class='clear-space'></div>"; e += "</div>" } else if (Lt) { e += "<div id='update-password-helpdiv' class='pad-all' align='center'>"; e += "<h3>You are currently signed in as Administrator. Create a new password for your Administrator account.</h3>"; e += "<div class='clear-space-two'></div><small><b class='pad-right-sml'>Note:</b>Password must be at least " + openWSE_Config.minPasswordLength + " characters long.</small>"; e += "<div class='clear-space'></div><table border='0' cellpadding='0' cellspacing='0'>"; e += "<tr><td align='right'><span class='pad-right font-bold'>New Password:</span></td>"; e += "<td align='left'><input type='password' id='tb_newpassword_update' onkeypress='openWSE.OnPasswordUpdate_KeyPress(event)' class='textEntry margin-right' style='width: 200px;' /><span id='span_newpassword_update' style='display: none; color: Red;'>*</span></td></tr>"; e += "<tr><td></td><td><div class='clear-space'></div></td></tr>"; e += "<tr><td align='right'><span class='pad-right font-bold'>Confirm New Password:</span></td>"; e += "<td align='left'><input type='password' id='tb_confirmnewpassword_update' onkeypress='openWSE.OnPasswordUpdate_KeyPress(event)' class='textEntry margin-right' style='width: 200px;' /><span id='span_confirmnewpassword_update' style='display: none; color: Red;'>*</span></td></tr></table>"; e += "<div class='clear-space'></div>"; e += "<input type='button' class='input-buttons no-margin' onclick='openWSE.UpdateAdminPassword()' value='Change Password' />"; e += "<div class='clear-space'></div>"; e += "<span id='span_passwordmismatch' style='color: Red;'></div>"; e += "</div>" } return e } function Bt(e) { if (e.which == 13 || e.keyCode == 13) { openWSE.UpdateEmail(); e.preventDefault() } } function jt(e) { if (e.which == 13 || e.keyCode == 13) { openWSE.UpdateAdminPassword(); e.preventDefault() } } function Ft() { var e = ""; e = "<div class='pad-all' align='center'>"; e += "<h3>You are now setup. Please click finish to load your workspace. You can change your email address within your 'Account Settings' page. If you need help in the future, click on the help icon at the bottom left hand corner of the workspace.</h3>"; e += "<h3>By using this site you agree that OpenWSE can save cookies to your device. These cookies contain no information regarding your personal information.</h3>"; e += "</div>"; $("#btnFinish").removeClass("display-none"); return e } function It() { $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/UpdateAcctNewMember", data: "", type: "POST", contentType: "application/json; charset=utf-8", success: function (e) { var t = e.d; if (openWSE.ConvertBitToBoolean(t)) { window.location = openWSE.siteRoot() + "Workspace.aspx" } } }) } function qt() { Ct = false; Lt = false; if ($("#help_main_holder").css("display") == "block") { $("#help_main_holder").fadeOut(openWSE_Config.animationSpeed, function () { $("#helpmenu_title, #helpdiv_1, #helpdiv_2").html("") }) } try { var e = window.location.href; if (e.indexOf("?help") != -1) { var t = e.split("?help"); if (t.length > 1) { var n = "?help" + t[1]; e = e.replace(n, ""); window.location = e } else { e = e.replace("?help", "") } window.location = e } else if (e.indexOf("&help") != -1) { var t = e.split("&help"); if (t.length > 1) { var n = "&help" + t[1]; e = e.replace(n, "") } else { e = e.replace("&help", "") } window.location = e } } catch (r) { } } function Rt(e) { $(window).load(function () { var t = unescape(e); var n = "<div id='MessageUpdatePopup' style='display: none;'>"; n += "<div class='message-element-align'>"; n += "<div id='MessageUpdatePopup-Text' class='message'>"; n += t; n += "</div></div></div>"; $("body").append(n); $("#MessageUpdatePopup").show(); var r = $(window).height() / 2; $(".new-update-holder").css("max-height", r); var i = $("#MessageUpdatePopup-Text").height() / 2; $("#MessageUpdatePopup-Text").css("margin-top", "-" + i + "px"); $(window).resize(function () { var e = $(window).height() / 2; $(".new-update-holder").css("max-height", e); var t = $("#MessageUpdatePopup-Text").height() / 2; $("#MessageUpdatePopup-Text").css("margin-top", "-" + t + "px") }) }) } function Ut(e) { $(window).load(function () { var t = unescape(e); var n = "<div id='MessageActivationPopup' style='display: none;'>"; n += "<div class='message-element-align'>"; n += "<div class='message'>"; var r = "<img alt='' class='float-left pad-right-sml' src='" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/App/approve.png' />"; var i = "<span style='font-size: 18px'>Got it</span>"; var s = "<a href='" + openWSE.siteRoot() + "Workspace.aspx' class='input-buttons no-margin' style='text-decoration: none!important;'>" + r + " " + i + "</a>"; n += t + "<div class='clear' style='height: 20px;'></div>" + s; n += "</div></div></div>"; $("body").append(n); $("#MessageActivationPopup").show(); var o = $("#MessageActivationPopup").find(".page-load-message").height() / 2; $("#MessageActivationPopup").find(".page-load-message").css("margin-top", "-" + o + "px"); $(window).resize(function () { var e = $("#MessageActivationPopup").find(".page-load-message").height() / 2; $("#MessageActivationPopup").find(".page-load-message").css("margin-top", "-" + e + "px") }) }) } function zt() { $("#MessageUpdatePopup").fadeOut(openWSE_Config.animationSpeed, function () { $("#MessageUpdatePopup").remove() }) } function Xt(e) { et("Closing Overlay..."); var t = $(e).closest(".workspace-overlay-selector"); if (t.length == 0) { t = $("." + e) } t.remove(); $.ajax({ url: m + "/Overlay_Disable", type: "POST", data: '{ "classes": "' + t.attr("class") + '" }', contentType: "application/json; charset=utf-8", success: function (e) { $t(e.d); nt() }, error: function (e) { nt() } }) } function Vt(e) { var t = e.split(","); var n = "#" + openWSE_Config.overlayPanelId; for (var r = 0; r < t.length; r++) { if (t[r] != "") { if ($(n).find("." + t[r]).length > 0) { $(n).find("." + t[r]).remove() } $(n).hide().prepend($(".move-holder").find("." + t[r])).show() } } if (e != "") { Gt() } } function $t(e) { var t = $("." + e); if (t.length > 0) { t.remove() } Gt() } function Jt() { et("Loading..."); $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/GetUserOverlays", type: "POST", data: "{ }", contentType: "application/json; charset=utf-8", success: function (e) { var t = ""; if (e.d != null) { t += "<div class='margin-top-sml'>"; t += "<table cellpadding='0' cellspacing='0' style='min-width: 100%;'><tbody>"; t += "<tr class='myHeaderStyle'><td width='30px'></td><td width='150px' align='center'>Overlay Name</td>"; t += "<td align='center'>Description</td></tr>"; for (var n = 0; n < e.d.length; n++) { t += "<tr class='myItemStyle GridNormalRow'>"; var r = "<div class='add-overlay-list-item' onclick='openWSE.AddRemoveOverlayClick(\"" + e.d[n][1] + "\", this);' title='Add Overlay'></div>"; if (openWSE.ConvertBitToBoolean(e.d[n][3])) { r = "<div class='add-overlay-list-item add-overlay-list-item-hasitem' onclick='openWSE.AddRemoveOverlayClick(\"" + e.d[n][1] + "\", this);' title='Remove Overlay'></div>" } t += "<td class='GridViewNumRow border-bottom'>" + r + "</td>"; t += "<td class='border-right border-bottom'>"; t += e.d[n][0] + "</td><td class='border-right border-bottom'>" + e.d[n][2] + "</td></tr>" } t += "</tbody></table></div>"; if (e.d.length == 0) { t += "<div class='emptyGridView'>No overlays available</div>" } } $("#overlayEdit-element").find("#overlay-edit-list").html(t); nt(); Et(true, "overlayEdit-element", "Add/Remove Overlay") }, error: function () { nt(); openWSE.AlertWindow("There was an error retrieving your overlays. Please try again.") } }) } function Kt(e, t) { if ($(t).hasClass("add-overlay-list-item-hasitem")) { Xt(e); $(t).removeClass("add-overlay-list-item-hasitem") } else { et("Adding Overlay..."); $(t).addClass("add-overlay-list-item-hasitem"); $("#hf_loadOverlay1").val(e); __doPostBack("hf_loadOverlay1", "") } } function Qt() { if ($(".overlay-table").length > 0) { $(".overlay-table").remove() } var e = $("#" + openWSE_Config.overlayPanelId); if (e.length > 0) { var t = 0; $(".workspace-overlay-selector").each(function (n) { if (n % Wt == 0) { t++; e.append("<table id='overlay-table-id-" + t + "' class='overlay-table' cellpadding='0' cellspacing='0'></table>"); $("#overlay-table-id-" + t).append("<tr></tr>") } var r = $("#overlay-table-id-" + t).find("tr").eq(0); r.append("<td class='overlay-cell-" + n + "'></td>"); $("#overlay-table-id-" + t).find(".overlay-cell-" + n).append($(this)) }); if (openWSE_Config.overlayPanelId != "pnl_OverlaysAll") { if ($("#MainContent_pnl_adminnote").length != 0) { e.prepend($("#MainContent_pnl_adminnote")); $("#MainContent_pnl_adminnote").removeClass("administrator-workspace-note").addClass("workspace-overlays administrator-workspace-note-overlay") } } } if ($(".overlay-table").length > 0) { $(".overlay-table").eq($(".overlay-table").length - 1).css("margin-bottom", "40px") } } function Gt() { $(".workspace-overlay-selector").each(function () { $("#" + openWSE_Config.overlayPanelId).append($(this)) }); Qt() } function Yt(e) { if (!openWSE_Config.demoMode) { if ($("#notification-tab-b").is(":visible")) { if (!a) { a = true; if ($(".ddLoadingMessage").length == 0) { if (e) { $(".table-notiMessages-div").prepend(c) } } var t = new Array; $("#table_NotiMessages tr").each(function (e) { t[e] = $(this).attr("id") }); var n = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/LoadUserNotifications"; $.ajax({ url: n, type: "POST", data: '{ "_currIds": "' + t + '","siteTheme": "' + openWSE_Config.siteTheme + '" }', contentType: "application/json; charset=utf-8", success: function (e) { $(".ddLoadingMessage").remove(); if (e.d != null && e.d != "") { $("#NotificationHolder").html($.trim(e.d)); if ($("#no-notifications-id").length > 0) { $("#lb_clearNoti").hide() } else { $("#lb_clearNoti").show() } } else { $("#lb_clearNoti").hide() } a = false; un(); an(); Zt() }, error: function () { $(".ddLoadingMessage").remove(); an(); $("#NotificationHolder").html("<h3 class='pad-top-big pad-bottom' style='color: Red; text-align: center;'>Error retrieving notifications!</h3>"); $("#lb_clearNoti").hide(); a = false } }) } } } } function Zt() { var e = document.getElementById("table-notiMessages-div-id"); if (e != null) { var t = $("#table-notiMessages-div-id").innerHeight(); var n = parseInt($("#table-notiMessages-div-id").css("max-height")); if (t >= e.scrollHeight || e.scrollHeight < n) { var r = parseInt($("#lbl_notifications").html()); var i = parseInt($("#table_NotiMessages tr").length); if (i < r) { $(".ddLoadingMessage").remove(); $("#NotificationHolder").append(c); en() } } } } function en() { if (!openWSE_Config.demoMode) { if ($("#notification-tab-b").is(":visible")) { if (!f && !a) { f = true; var e = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/LoadMoreUserNotifications"; var t = new Array; $("#table_NotiMessages tr").each(function (e) { t[e] = $(this).attr("id") }); $.ajax({ url: e, type: "POST", data: '{ "_currIds": "' + t + '","_currCount": "' + parseInt($("#table_NotiMessages tr").length) + '","siteTheme": "' + openWSE_Config.siteTheme + '" }', contentType: "application/json; charset=utf-8", success: function (e) { $(".ddLoadingMessage").remove(); if (e.d != null && e.d != "") { $("#table_NotiMessages").append($.trim(e.d)) } un(); an(); f = false; Zt() }, error: function () { $(".ddLoadingMessage").remove(); an(); $("#NotificationHolder").append("<h3 class='pad-bottom-big' style='color: Red; text-align: center;'>Error retrieving notifications!</h3>"); f = false } }) } } } } function tn() { if (!openWSE_Config.demoMode) { if ($("#notification-tab-b").is(":visible")) { if (!f) { f = true; var e = new Array; $("#table_NotiMessages tr").each(function (t) { e[t] = $(this).attr("id") }); var t = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/RefreshUserNotifications"; $.ajax({ url: t, type: "POST", data: '{ "_currIds": "' + e + '","siteTheme": "' + openWSE_Config.siteTheme + '" }', contentType: "application/json; charset=utf-8", success: function (e) { $(".ddLoadingMessage").remove(); if (e.d[0] != null && e.d[0] != "") { if ($("#table_NotiMessages").length > 0) { $("#table_NotiMessages").prepend($.trim(e.d[0])) } else { var t = "<table ID='table_NotiMessages' class='table-notiMessages' cellpadding='5' cellspacing='5'>"; t += $.trim(e.d[0]) + "</table>"; $("#NotificationHolder").html(t) } } if (e.d[1] != null) { for (var n = 0; n < e.d[1].length; n++) { var r = e.d[1][n]; $("#" + r).fadeOut(openWSE_Config.animationSpeed, function () { $("#" + r).remove() }) } } if ($("#lbl_notifications").html() == "0") { $("#NotificationHolder").html("<h3 id='no-notifications-id'>No notifications available.</h3>"); $("#lb_clearNoti").hide() } un(); an(); f = false }, error: function () { $(".ddLoadingMessage").remove(); an(); $("#NotificationHolder").html("<h3 class='pad-top-big pad-bottom-big' style='color: Red; text-align: center;'>Error retrieving notifications!</h3>"); f = false } }) } } } } function nn() { $(".ddLoadingMessage").remove(); $("#NotificationHolder").html(""); $("#lb_clearNoti").hide(); a = false } function rn() { $(".ddLoadingMessage").remove(); $("#lbl_notifications").removeClass("notifications-new"); $("#lbl_notifications").addClass("notifications-none"); $("#lbl_notifications").html("0"); $("#NotificationHolder").html("<h3 id='no-notifications-id'>No notifications available.</h3>"); $("#lb_clearNoti").hide() } function sn() { if (!openWSE_Config.demoMode) { et("Clearing Notifications..."); var e = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/DeleteNotifications"; $.ajax({ url: e, type: "POST", data: '{ "id": "' + "ClearAll" + '" }', contentType: "application/json; charset=utf-8", success: function (e) { if (openWSE.ConvertBitToBoolean(e.d)) { nt(); rn() } } }) } } function on(e) { if (!openWSE_Config.demoMode) { et("Deleting. Please Wait..."); var t = $(e).closest("tr"); var n = t.attr("id"); var r = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/DeleteNotifications"; $.ajax({ url: r, type: "POST", data: '{ "id": "' + n + '" }', contentType: "application/json; charset=utf-8", success: function (e) { if (openWSE.ConvertBitToBoolean(e.d)) { t.fadeOut(openWSE_Config.animationSpeed, function () { nt(); t.remove(); if ($("#lbl_notifications").html() == "1") { rn() } else { var e = parseInt($("#lbl_notifications").html()); e -= 1; $("#lbl_notifications").html(e) } }) } } }) } } function un() { if ($("#notification-tab-b").is(":visible")) { var e = 65; var t = $(window).height() - (e + P); var n = 7; var r = $(window).width() - n; $(".table-notiMessages-div").css({ maxHeight: t, maxWidth: r }); Zt() } } function an() { $(".table-notiMessages-div").scroll(function () { var e = document.getElementById("table-notiMessages-div-id"); if (e != null) { var t = $(".table-notiMessages-div"); var n = t.scrollTop(); var r = t.innerHeight(); if (n > 0) { if (n + r >= e.scrollHeight) { var i = parseInt($("#lbl_notifications").html()); var s = parseInt($("#table_NotiMessages tr").length); if (s < i) { $(".ddLoadingMessage").remove(); $("#NotificationHolder").append(c); en() } } } } }) } function fn() { try { var e = document.getElementById("hf_noti_update_hiddenField").value; if (e == "") { e = "0" } if (openWSE.ConvertBitToBoolean(e)) { $("#noti-update-element").fadeIn(openWSE_Config.animationSpeed, function () { setTimeout(function () { $("#noti-update-element").fadeOut(openWSE_Config.animationSpeed, function () { $("#hf_noti_update_hiddenField").val("false") }) }, 2500) }) } } catch (t) { } } function ln() { if ($("#Login-holder").css("display") != "none") { $("#Login-holder").hide(); $("#iframe-createaccount-holder").html("<iframe id='iframe-demo' src='SiteTools/iframes/CreateAccount.aspx' frameborder='0' width='550px' style='visibility: hidden;'></iframe>"); $("#iframe-createaccount-holder").append("<div style='text-align: center;'><h3 id='loadingControls'>Loading Controls. Please Wait...</h3></div>"); $("#CreateAccount-holder").fadeIn(openWSE_Config.animationSpeed); $("#iframe-demo").load(function () { $("#loadingControls").remove(); $("#register_password_cancel").show(); $("#iframe-demo").css({ height: "300px", visibility: "visible" }) }) } else { $("#CreateAccount-holder, #ForgotPassword-holder, #register_password_cancel").hide(); $("#iframe-createaccount-holder").html(""); $("#Login-holder").fadeIn(openWSE_Config.animationSpeed) } } function cn() { $("#tb_username_recovery").val(""); $("#lbl_passwordResetMessage").html(""); $("#UserNameRequired_recovery").css("visibility", "hidden"); $("#Login-holder").hide(); $("#register_password_cancel").show(); $("#ForgotPassword-holder").fadeIn(openWSE_Config.animationSpeed) } function hn() { var e = $.trim($("#tb_weather_postalCode").val()); if (e != "") { cookie.set("weather_postal", e, "30"); pn(openWSE_Config.siteTheme) } } function pn(e) { var t = "66212"; var n = cookie.get("weather_postal"); if ($.trim(n) == "" || n == null || n == undefined) { t = $.trim($("#tb_weather_postalCode").val()); cookie.set("weather_postal", t, "30") } else { t = n } if (t == "") { t = "66212" } if (e != "") { openWSE_Config.siteTheme = e } var r = "//builder.zoomradar.net/weather_builder/widget.page.php?s=250x250&z=" + t + "&i=1&c=5&ft=Current%20Weather"; var i = '<iframe src="' + r + '" width="250" height="250" style="border: 0; opacity: 0.85; filter:alpha(opacity=85);" frameborder="0"></iframe>'; var t = "<span>Postal Code:</span><input id='tb_weather_postalCode' type='text' class='textEntry margin-left margin-right' maxlength='10' value='" + t + "' style='width: 60px;' />"; var s = "<a href='#' onclick='openWSE.SetPostalCode();return false;' class='img-refresh pad-all-sml margin-right-sml margin-bottom-sml float-right' title='Refresh weather'></a>"; $("#Weather_Overlay_Position").html(i + "<div class='clear-space-two'></div><div id='weather-button-holder' class='overlay-header' style='height: 25px;'>" + s + t + "</div>") } function dn(e, t) { if ($("#iframe-container-helper").length > 0) { mn(); setTimeout(function () { dn(e, t) }, openWSE_Config.animationSpeed) } else { var n = ""; var r = window.location.hash; if (r.indexOf("#") == -1 && window.location.href.charAt(window.location.href.length - 1) != "#") { n = "#?" } else if (r != "") { n = "&" } else { n = "?" } n += "iframecontent=" + e; window.location += n } } function vn(e, t) { if ($("#iframe-container-helper").length > 0) { mn(); setTimeout(function () { vn(e, t) }, openWSE_Config.animationSpeed) } else { var n = $(window).height() - ($("#always-visible").height() + $("#container-footer").height()); if (!gn(e)) { e = openWSE.siteRoot() + e } var r = "<iframe id='iframe-content-src' src='" + e + "' width='100%' frameborder='0' style='height: " + n + "px;'></iframe>"; var i = "<div id='iframe-container-helper'>" + r + "<div class='loading-background-holder'></div></div>"; var s = "<div id='iframe-container-close-btn'><a href='#' onclick='openWSE.CloseIFrameContent();return false;'>Close " + t + "</a></div>"; $("#workspace-selector").hide(); $("#top-main-bar-top").append(s); $("body").append(i); $("#container").hide(); $("#minimized-app-bar").hide(); $("#iframe-container-helper").fadeIn(openWSE_Config.animationSpeed); document.getElementById("iframe-content-src").onload = function () { $(document).ready(function () { setTimeout(function () { $("#iframe-container-helper").find(".loading-background-holder").remove() }, 150) }) }; $(".top-options li.a").removeClass("active"); $(".top-options li.b").hide(); cookie.del("top_menu"); if ($("#always-visible").css("display") == "none") { $("#always-visible").show() } U(true) } } function mn() { if ($("#always-visible").find(".top-options").css("display") == "none") { $("#always-visible").hide() } $("#container").show(); $("#iframe-container-helper").html(""); $("#iframe-container-helper").fadeOut(openWSE_Config.animationSpeed, function () { $("#iframe-container-helper").remove(); $("#iframe-container-close-btn").remove(); $("#workspace-selector").show(); $("#minimized-app-bar").show(); U(true) }); try { var e = window.location.href; if (e.indexOf("?iframecontent=") != -1) { var t = e.split("?iframecontent="); if (t.length > 1) { var n = "?iframecontent=" + t[1]; e = e.replace(n, ""); window.location = e } } else if (e.indexOf("&iframecontent=") != -1) { var t = e.split("&iframecontent="); if (t.length > 1) { var n = "&iframecontent=" + t[1]; e = e.replace(n, ""); window.location = e } } } catch (r) { } $(window).resize() } function gn(e) { var t = e.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/); if (typeof t[1] === "string" && t[1].length > 0 && t[1].toLowerCase() !== location.protocol) return true; if (typeof t[2] === "string" && t[2].length > 0 && t[2].replace(new RegExp(":(" + { "http:": 80, "https:": 443 }[location.protocol] + ")?$"), "") !== location.host) return true; return false } function yn() { try { if ($("#background_selector_overlay").length > 0) { $("#background_selector_overlay").remove() } et("Loading Backgrounds"); $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/GetServerImageList", type: "POST", data: '{ "_workspace": "' + kn() + '" }', contentType: "application/json; charset=utf-8", success: function (e) { if (e.d.length == 2) { var t = "<div style='text-align: left'><small><b class='pad-right-sml'>Note:</b>All backgrounds will repeat on the workspace. Your connection speed will slow down with the larger sized images. Each image has the size details when you hover over them. Solid color backgrounds will be the quickest if you have a slower internet.</small></div>"; t += "<div class='clear' style='height: 20px;'></div><div class='float-left'><span class='pad-right font-bold float-left pad-top-sml'>Url Link</span><input id='tb_imageurl' type='text' value='Link to image' class='textEntry' onfocus='if(this.value==\"Link to image\")this.value=\"\"' onblur='if(this.value==\"\")this.value=\"Link to image\"' style='width:355px;'>"; t += "<input id='btn_urlupdate' type='button' value='Update Url' class='input-buttons margin-left' onclick='openWSE.updateBackgroundURL()' /><br /><div class='float-left'>Copy and paste any link that contains an image.</div></div>"; t += "<a href='#' class='sb-links float-right' onclick='openWSE.ClearBackground();return false;'>Clear Background</a>"; t += "<div class='clear' style='height: 20px;'></div>"; t += "<span class='pad-right font-bold float-left pad-top-sml'>Solid Color</span><input id='tb_solidColorBg' type='text' class='textEntry float-left margin-right color' style='width: 75px;' />"; t += "<input id='btn_urlbgcolor' type='button' value='Update Color' class='input-buttons float-left' onclick='openWSE.updateBackgroundColor()' />"; t += "<div class='clear' style='height: 30px;'></div>"; t += "<div class='modal-inner-scroll'>" + e.d[1] + "</div>"; $("#background-selector-holder").html(t); try { jscolor.init() } catch (n) { } if (e.d[0].length > 6) { $("#tb_imageurl").val(e.d[0]) } else if (e.d[0].length == 6) { $("#tb_solidColorBg").val(e.d[0]) } Et(true, "BackgroundSelector-element", "Select a new background") } else { rt("There was an error pulling the backgrounds down from the server. Please try again.", window.location.href) } nt() } }) } catch (e) { nt() } } function bn() { $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/SaveNewBackground", type: "POST", data: '{ "_workspace": "' + kn() + '","_img": "' + "" + '" }', contentType: "application/json; charset=utf-8", success: function (e) { if ($("#app_title_bg").length == 0) { $("#maincontent_overflow").css("background", ""); if (!$("#maincontent_overflow").hasClass("maincontent_overflow-main-bg")) { $("#maincontent_overflow").addClass("maincontent_overflow-main-bg") } } else if ($(".workspace-backgrounds-fixed").length > 0) { $("#MainContent_bg_" + kn()).css("background", "#EFEFEF url('" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Body/default-bg.jpg') repeat top left") } else { $("#app_title_bg").css("background", "#EFEFEF url('" + openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/Body/default-bg.jpg') top left repeat") } $("#tb_imageurl").val(""); $("#tb_solidColorBg").val("FFFFFF"); $("#tb_solidColorBg").attr("style", "width: 75px;"); $(".image-selector-active").each(function (e) { $(this).removeClass("image-selector-active"); $(this).addClass("image-selector") }) } }) } function wn() { $("#background_selector_overlay").fadeOut(openWSE_Config.animationSpeed, function () { $("#background_selector_overlay").remove() }) } function En() { var e = $("#background-selector-holder").find("#tb_imageurl").val(); if (e != "Link to image") { xn(e) } } function Sn() { var e = $("#background-selector-holder").find("#tb_solidColorBg").val(); if (e.length == 6) { xn(e) } } function xn(e) { $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/SaveNewBackground", type: "POST", data: '{ "_workspace": "' + kn() + '","_img": "' + e + '" }', contentType: "application/json; charset=utf-8", success: function (t) { if (t.d != "") { if ($("#app_title_bg").length == 0) { if ($("#maincontent_overflow").hasClass("maincontent_overflow-main-bg")) { $("#maincontent_overflow").removeClass("maincontent_overflow-main-bg") } if (e.length > 6) { $("#maincontent_overflow").css("background-image", "url('" + e + "')"); $("#maincontent_overflow").css("background-color", "#EFEFEF"); $("#maincontent_overflow").css("background-position", "top left"); $("#maincontent_overflow").css("background-repeat", "repeat repeat") } else { $("#maincontent_overflow").css("background", "#" + e) } } else if ($(".workspace-backgrounds-fixed").length > 0) { if (e.length > 6) { $("#MainContent_bg_" + kn()).css("background", "#EFEFEF url('" + e + "') repeat top left") } else { $("#MainContent_bg_" + kn()).css("background", "#" + e) } } else { if (e.length > 6) { $("#app_title_bg").css("background", "#EFEFEF url('" + e + "') top left repeat") } else { $("#app_title_bg").css("background", "#" + e) } } $(".image-selector-active").each(function (e) { $(this).removeClass("image-selector-active"); $(this).addClass("image-selector") }) } } }) } function Tn(e) { $(e).find(".app-main, .app-main-nobg").each(function (e) { var t = $(this).attr("id"); if ($("#minimized-app-bar").find("#" + t + "-min-bar").length != 0) { if ($("#minimized-app-bar").find("#" + t + "-min-bar").css("display") != "none") { $("#minimized-app-bar").find("#" + t + "-min-bar").hide() } } }) } function Nn(e) { $(e).find(".app-main, .app-main-nobg").each(function (e) { var t = $(this).attr("id"); if ($("#minimized-app-bar").find("#" + t + "-min-bar").length != 0) { if ($("#minimized-app-bar").find("#" + t + "-min-bar").css("display") == "none") { $("#minimized-app-bar").find("#" + t + "-min-bar").show() } } }); $("#minimized-app-bar").fadeIn(openWSE_Config.animationSpeed) } function Cn(e) { An(e); id = "#MainContent_workspace_" + e; Rn(id); $(id).css({ visibility: "visible", opacity: 1, filter: "alpha(opacity=100)" }); $("#workspace_holder .workspace-holder").each(function (e) { if ($(this).css("visibility") != "visible") { var t = $(this).attr("id"); Xn("#" + t) } }) } function kn() { var e = $("#workspace_holder").find(".workspace-holder"); var t = e.length; for (var n = 0; n < t; n++) { if (e.eq(n).css("visibility") == "visible") { var r = e.eq(n).attr("id"); return "workspace_" + r.substring(r.lastIndexOf("_") + 1) } } return "workspace_1" } function Ln(e, t) { Xn(e); Vn(t); if (!openWSE_Config.taskBarShowAll) { Tn(e); Nn(t) } $(e).css({ opacity: 0, filter: "alpha(opacity=0)" }); if (openWSE_Config.animationSpeed > 0) { $(t).fadeTo(openWSE_Config.animationSpeed, 1) } else { $(t).css({ opacity: 1, filter: "alpha(opacity=100)" }) } Rn(t) } function An(e) { $("#ddl_WorkspaceSelector").find(".selected-workspace").html("Workspace " + e) } function On() { $("#ddl_WorkspaceSelector").removeClass("active"); $("#ddl_WorkspaceSelector").find(".dropdown-db-selector").hide() } function Mn(e, t, n, r) { setTimeout(function () { if (t == n) { t = 1 } else { t++ } var i = "#MainContent_workspace_" + t; An(t); var s = false; var o = false; $("#workspace_holder .workspace-holder").each(function () { if ($(this).css("visibility") == "visible") { if (!openWSE_Config.taskBarShowAll) { $("#minimized-app-bar").fadeOut(openWSE_Config.animationSpeed) } $(this).fadeTo(openWSE_Config.animationSpeed, 0, function () { if (!s) { s = true; var e = $(this).attr("id"); Xn("#" + e); Vn(i); if (!openWSE_Config.taskBarShowAll) { Tn("#" + e); Nn(i) } $(i).find(".app-main, .app-main-nobg").each(function (e) { if (r) { _n(this) } }); Rn(i); $(i).fadeTo(openWSE_Config.animationSpeed, 1, function () { if (!o) { o = true } }); return false } }) } }); Mn(e, t, n, r) }, e * 1e3) } function _n(e) { var t = $(e).find(".app-title").text(); var n = $(e); var r = n.attr("id"); if (n.css("display") == "block") { Un("#" + r); $(".app-main, .app-main-nobg").css("z-index", "1000"); n.css("z-index", "3000"); if (n.find(".iFrame-apps").length > 0) { var i = $get(r + " .iFrame-apps"); if (i.src != null) { i.src = i.src } } else { $("#hf_ReloadApp").val(r); __doPostBack("hf_ReloadApp", "") } } } function Dn(e) { d = true; if (e) { M = true; v = true } $("#pnl_icons").sortable({ axis: "y", cancel: ".app-icon-category-list, #Category-Back, .app-popup", containment: "#pnl_icons", opacity: .6, scrollSensitivity: 40, scrollSpeed: 40, start: function (e, t) { $(document).tooltip({ disabled: true }) }, stop: function (e, t) { var n = ""; $(".app-icon").each(function () { var e = $(this).attr("id").replace("-pnl-icons", ""); if (e != "") { n += e + "," } }); if (M) { $.ajax({ url: m + "/App_UpdateIcons", type: "POST", data: '{ "appList": "' + escape(n) + '" }', contentType: "application/json; charset=utf-8" }) } $(document).tooltip({ disabled: false }) } }); $("#pnl_icons").disableSelection() } function Pn(e, t, n, r, i, s, o, u, a) { var f = $("#" + e); if (n != null && n != "") { f.find(".app-title").text(t); if (openWSE.ConvertBitToBoolean(a)) { f.addClass("app-maximized"); f.find(".maximize-button-app").addClass("active") } if (openWSE.ConvertBitToBoolean(u)) { Hn(e, t, r, i); Xn("#" + e); if (s != "") { f.css("width", s) } if (o != "") { f.css("height", o) } } else { f.css({ visibility: "visible", display: "block", zIndex: 3e3 }); if (!openWSE.ConvertBitToBoolean(a)) { f.removeClass("app-maximized"); f.find(".maximize-button-app").removeClass("active"); if (s != "") { f.css("width", s) } if (o != "") { f.css("height", o) } if (parseInt(i) < 0) { i = "0" } if (parseInt(r) < 0) { r = "0" } f.css({ left: r, top: i }) } } if (n.indexOf(".ascx") == -1) { if (n.indexOf("ChatClient/ChatWindow.html") != -1) { f.find(".app-body").html("<iframe class='iFrame-apps' src='" + openWSE.siteRoot() + n + "' width='100%' frameborder='0'></iframe>"); f.find("iframe").one("load", function () { f.find(".loading-background-holder").each(function () { $(this).remove() }) }); Un("#" + e) } else { f.find(".app-body").load(openWSE.siteRoot() + "Apps/" + n, function () { Un("#" + e); if (f.find(".app-body").find("iframe").length > 0) { if (f.find(".app-body").find(".loading-background-holder").length <= 0) { f.find(".app-body").append(g) } f.find(".app-body").find("iframe").one("load", function () { f.find(".app-body").find(".loading-background-holder").each(function () { $(this).remove() }) }) } }) } } ur(e); var l = f.parent().attr("id"); if (l != undefined && l != null && l != "") { ar(l, e) } } } function Hn(e, t, n, r) { var i = $("#" + e); if (i.length > 0) { var s = i.find(".app-header-icon"); var o = i.find(".app-title"); var u = false; var a = false; var f = ""; var l = "app-min-bar"; if (e.replace(/#/gi, "").indexOf("app-ChatClient-") != -1) { l = "app-min-bar chat-modal"; f = " chat-username='" + i.attr("chat-username") + "'" } var c = "<div id='" + e + "-min-bar' class='" + l + "'" + f + "><input type='hidden' id='" + e + "-min-bar-x' value='" + n + "' />"; c += "<input type='hidden' id='" + e + "-min-bar-y' value='" + r + "' />"; if (!s.hasClass("display-none") && s.length != 0 && !o.hasClass("display-none")) { c += s.outerHTML(); if (s.css("display") == "none") { u = true } c += "<span class='app-title pad-right'>" + t + "</span>"; c += "<a href='" + e + "' class='exit-button-app-min'></a></div>" } else if ((s.hasClass("display-none") || s.length == 0) && o.hasClass("display-none")) { c += "<span class='app-title pad-right'>" + t + "</span>"; c += "<a href='" + e + "' class='exit-button-app-min'></a></div>" } else { var h = false; var p = true; if (!s.hasClass("display-none")) { c += s.outerHTML(); h = true; if (s.css("display") == "none") { u = true } } if (!o.hasClass("display-none")) { c += "<span class='app-title pad-right'>" + t + "</span>" } else { c += "<span class='app-title pad-right display-none'>" + t + "</span>"; a = true; p = false } var d = ""; if (h && !p) { d = " style='margin-left: 5px;'" } c += "<a href='" + e + "' class='exit-button-app-min'" + d + "></a></div>" } if ($("#" + e + "-min-bar").length == 0) { $("#minimized-app-bar").append(c) } if (u) { $("#" + e + "-min-bar").find(".app-header-icon").show() } if (a) { $("#" + e + "-min-bar").attr("title", t) } i.css({ visibility: "hidden", display: "block" }) } } function Bn(e, t) { var n = $(e).find(".app-icon-font").text(); if (n == "") { n = $(e).find(".app-title").text(); if (n == "") { n = $(e).find("span").text() } } var r = $(e).attr("id"); if (r == undefined || r == null || r == "") { r = $(e).parent().attr("id") } if (r != undefined && r != null && r != "") { if (r.indexOf("-pnl-icons") != -1) { r = r.replace("-pnl-icons", "") } $.ajax({ url: m + "/App_Open", type: "POST", data: '{ "appId": "' + r + '","name": "' + n + '","workspace": "' + t + '","width": "' + $("#" + r).width() + '","height": "' + $("#" + r).height() + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function (e) { var i = e.d; if (i != "") { var s = $("#" + r); Yn(r); $n(t, r); ar(t, r); var o = s.width(); var u = s.height(); if (s.css("display") != "block" || s.css("visibility") != "visible") { if (r.indexOf("app-ChatClient-") != -1) { var a = s.attr("chat-username"); i = "ChatClient/ChatWindow.html?user=" + a + "&displayVersion=workspace" } if (s.css("left") == null && s.css("top") == null || s.css("left") == "auto" && s.css("top") == "auto") { Pn(r, n, i, "50px", "50px", o, u, "1", "0") } else { if (parseInt(s.css("top")) < 0) { s.css("top", "50px") } if (parseInt(s.css("left")) < 0) { s.css("left", "50px") } Pn(r, n, i, s.css("left"), s.css("top"), o, u, "1", "0") } s.css("display", "block"); s.css("visibility", "visible"); s.css("z-index", "3000"); if ($("#" + r + "-min-bar-x").length != 0) { if (s.find(".loading-background-holder").length <= 0) { s.find(".app-body").append(g) } if (!s.hasClass("auto-full-page") && !s.hasClass("auto-full-page-min") && !s.hasClass("app-maximized") && !s.hasClass("app-maximized-min")) { s.find(".maximize-button-app").removeClass("active"); s.css("width", o); s.css("height", u); s.css("top", P) } else { Kn("#" + r); s.find(".maximize-button-app").addClass("active"); s.css("top", "0px") } s.css({ visibility: "visible", display: "block" }).animate({ opacity: 1, filter: "alpha(opacity=100)", left: $("#" + r + "-min-bar-x").val(), top: $("#" + r + "-min-bar-y").val() }, openWSE_Config.animationSpeed); $.ajax({ url: m + "/App_Move", type: "POST", data: '{ "appId": "' + r + '","name": "' + n + '","x": "' + $("#" + r + "-min-bar-x").val() + '","y": "' + $("#" + r + "-min-bar-y").val() + '","width": "' + o + '","height": "' + u + '","workspace": "' + t + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }); $("#" + r + "-min-bar").remove(); Rn("#" + s.attr("id")) } else { s.css({ top: P, visibility: "visible", display: "block" }).fadeIn(openWSE_Config.animationSpeed) } if ($("#" + r + "-min-bar").length > 0) { $("#" + r + "-min-bar").remove() } if (b == 1) { var f = document.getElementById("hf_loadApp1"); if (T.length == 0) { T[0] = r; f.value = r; __doPostBack("hf_loadApp1", "") } else { T[T.length - 1] = r } } else if (i.indexOf(".ascx") > 0 && b == 0) { s.find(".loading-background-holder").each(function () { $(this).remove() }) } } } } }) } } function jn(e, t, n) { if (e != undefined && e != null && e != "") { if (e.indexOf("-pnl-icons") != -1) { e = e.replace("-pnl-icons", "") } $("#MessageActivationPopup").hide(); $("#MessageActivationPopup").remove(); et("Loading. Please Wait..."); cookie.set("active_app", e, 30); $.ajax({ url: m + "/App_Open_ChangeWorkspace", type: "POST", data: '{ "appId": "' + e + '","name": "' + t + '","workspace": "' + n + '","width": "' + $("#" + e).width() + '","height": "' + $("#" + e).height() + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function (e) { window.location = openWSE.siteRoot() + "Workspace.aspx" } }) } } function Fn(e, t) { if ($("#" + e).css("display") == "none") { b = t } } function In(e) { var t = $("#" + e); t.find("iframe").one("load", function () { t.find(".loading-background-holder").each(function () { $(this).remove() }) }) } function qn(e) { var t = document.getElementById("hf_loadApp1"); for (var n = 0; n < T.length; n++) { if (T[n] == e) { T.splice(n, 1) } } var r = "#MainContent_" + e.replace(/-/gi, "_") + "_advPanel"; $(r).html(""); if ($(".move-holder").find(".main-div-app-bg").length > 0) { $(r).hide().append($(".move-holder").find(".main-div-app-bg")).fadeIn(openWSE_Config.animationSpeed) } if ($(".move-holder").find(".outside-main-app-div").length > 0) { $(".move-holder").find(".outside-main-app-div").each(function () { $(r).hide().append($(this)).show() }) } var i = $("#" + e.replace("_", "-")); i.find(".loading-background-holder").each(function () { $(this).remove() }); if (T.length > 0) { t.value = T[0]; __doPostBack("hf_loadApp1", "") } b = 0 } function Rn(e) { $(e).find(".app-main, .app-main-nobg, .app-main-external").each(function (e) { Un(this) }) } function Un(e) { var t = $(e); if (t.length > 0) { var n = t.outerHeight(); var r = t.find(".app-head"); var i = 0; if (r.length > 0 && r.css("display") != "none") { i = r.outerHeight() } var s = n - i; t.find(".app-body").css("height", s); if (t.find(".iFrame-apps").length > 0) { var o = 2; if (t.find(".app-title-bg-color").length > 0) { o = t.find(".app-title-bg-color").outerHeight() + (o + 1) } t.find(".iFrame-apps").css("height", s - o) } } } function zn(e) { var t = $(e); $wo = t.find(".app-overlay-fix"); if ($wo.length == 0) { $wb = t.find(".app-body"); if ($wb.length == 1) { $wb.append("<div class='app-overlay-fix'></div>") } } } function Wn(e) { $wo = $(e).find(".app-overlay-fix"); if ($wo.length == 1) { $wo.remove() } } function Xn(e) { var t = $(e); var n = t.height(); var r = $(window).height(); var i = -(n + r); t.css({ visibility: "hidden", top: i, bottom: r, zIndex: -1 }); Jn(e) } function Vn(e) { var t = $(e); t.css({ visibility: "visible", top: 0, bottom: 0, zIndex: "" }); Kn(e) } function $n(e, t) { var n = $("#" + t); Kn("#" + t); var r = n.parent().attr("id"); var i = "MainContent_" + e; if (r != i) { var s = n.find("iframe").length; if (s > 0) { if (n.find(".loading-background-holder").length <= 0) { n.find(".app-body").append(g) } In(t) } $("#" + i).prepend(n); ar(e, t) } } function Jn(e) { if (e.indexOf("app-") != -1) { var t = $(e); if (t.hasClass("app-maximized")) { t.removeClass("app-maximized"); t.addClass("app-maximized-min") } if (t.hasClass("auto-full-page")) { t.removeClass("auto-full-page"); t.addClass("auto-full-page-min") } } } function Kn(e) { if (e.indexOf("app-") != -1) { var t = $(e); if (t.hasClass("app-maximized-min")) { t.removeClass("app-maximized-min"); t.addClass("app-maximized") } if (t.hasClass("auto-full-page-min")) { t.removeClass("auto-full-page-min"); t.addClass("auto-full-page") } Un(e) } } function Qn(e) { if (!x) { x = true; w = $(e).attr("id").replace("-min-bar", ""); var t = kn(); var n = $("#MainContent_" + t).find("#" + w); if (n.length > 0) { E = $("#" + w).css("left"); S = $("#" + w).css("top"); var r = $("#" + w + "-min-bar-x").val(); var i = $("#" + w + "-min-bar-y").val(); if (r == null || r == "") { r = p.left - $("#workspace-selector").width() } if (i == null || i == "") { i = 0 } Kn("#" + w); n.css("left", r); n.css("top", i); n.addClass("app-min-bar-preview"); n.fadeTo(openWSE_Config.animationSpeed, .65) } } } function Gn() { var e = $("#" + w); if (e.hasClass("app-min-bar-preview")) { e.css("opacity", "0.0"); e.css("filter", "alpha(opacity=0)"); e.removeClass("app-min-bar-preview"); Jn("#" + w); e.css("left", E); e.css("top", S); w = ""; E = ""; S = ""; x = false } else { var t = kn(); var e = $("#MainContent_" + t).find("#" + w); if (e.length == 0) { w = ""; E = ""; S = ""; x = false } } } function Yn(e) { if (openWSE.IsComplexWorkspaceMode()) { Zn(e); var t = $("#" + e); t.addClass("selected"); t.css("z-index", "3000"); cookie.set("active_app", e, "30") } } function Zn(e) { if (openWSE.IsComplexWorkspaceMode()) { $(".app-main, .app-main-nobg").css("z-index", "1000"); $(".app-main, .app-main-nobg").removeClass("selected"); $(".app-main, .app-main-nobg").each(function (t) { var n = $(this); var r = n.attr("id"); if (n.css("display") == "block") { if (r != e) { zn("#" + r) } else if (r == e) { n.find(".app-overlay-fix").remove() } } }) } } function er() { cookie.del("active_app"); $(".app-main, .app-main-nobg").each(function (e) { var t = $(this); if (t.css("display") == "block") { zn("#" + t.attr("id")) } }) } function tr() { if (openWSE.IsComplexWorkspaceMode()) { var e = cookie.get("active_app"); if (e != null && e != "" && e != undefined) { Yn(e) } else { er() } } } function nr() { var e = cookie.get("app_category_id"); var t = cookie.get("app_category"); if (document.getElementById("Category-Back") != null && e != null && e != "" && t != null && t != "") { $(".app-icon-category-list").hide(); $("#Category-Back").show(); $("." + e).show(); $("#Category-Back-Name").html(t); $("#Category-Back-Name-id").html(e) } } function rr(e, t, n, r) { $.ajax({ url: m + "/App_RemoteLoad", data: '{ "_Id": "' + escape(e) + '" }', contentType: "application/json; charset=utf-8", dataType: "json", type: "POST", success: function (e) { try { if (e.d != null) { ir(unescape(e.d[0]), unescape(e.d[1]), unescape(e.d[2])) } } catch (i) { } nt(); G(t, n, r) }, error: function (e) { nt(); G(t, n, r) } }) } function ir(e, t, n) { if (t == "close") { var r = $("#" + e); if (r.css("display") == "block") { if (r.find(".exit-button-app").length > 0) { r.find(".exit-button-app").click() } } } else if (e == "workspace-selector") { try { $(".workspace-selection-item").eq(parseInt(t) - 1).trigger("click") } catch (i) { } var s = "#MainContent_" + kn(); var o = "#MainContent_workspace_" + t; An(t); Ln(s, o) } else { var u = t.split(";"); var a = "1"; if (u[0] != "" && u[0] != "0") { a = u[0] } else { a = kn().replace("workspace_", "") } if (openWSE.ConvertBitToBoolean(n)) { b = 1 } else { b = 0 } var r = $("#" + e + "-pnl-icons"); var f = u[2].replace("px", ""); var l = u[3].replace("px", ""); var c = u[4].replace("px", ""); var h = u[5].replace("px", ""); if ($("#hf_appContainer").val() != "") { var f = parseInt(f); var l = parseInt(l); var c = parseInt(c); var h = parseInt(h); if (l + c > $("#container").width()) { l = Math.abs($("#container").width() - c) - 2 } if (f + h > $("#container").height()) { f = Math.abs($("#container").height() - h) - 2 } } if ($("#" + e).css("display") == "block") { $("#" + e).css({ top: f + "px", left: l + "px" }) } else { $("#" + e).css({ top: "auto", left: "auto" }) } if ($("#" + e).hasClass("ui-resizable")) { $("#" + e).css({ width: c + "px", height: h + "px" }) } if ($("#" + e).css("display") == "block") { var p = $("#" + e).find(".reload-button-app").parent(); pr(p) } Bn(r, "workspace_" + a); if (r.hasClass("active") == false) { r.addClass("active") } sr(e, a, u[1]) } } function sr(e, t, n) { var r = $("#" + e); if (r.css("display") == "block") { t = t.substring(t.lastIndexOf("_") + 1); try { $(".workspace-selection-item").eq(parseInt(t) - 1).trigger("click") } catch (i) { } var s = "#MainContent_" + kn(); var o = "#MainContent_workspace_" + t; An(t); Ln(s, o); Er(t); if (n != "") { var u = false; switch (n) { case "minimize": if ($("#" + e + "-min-bar").length == 0) { if (r.find(".minimize-button-app").length > 0) { r.find(".minimize-button-app").click(); u = true } } else { var a = setInterval(function () { if (r.css("visibility") == "visible") { r.find(".minimize-button-app").click(); u = true; clearInterval(a) } }, 50) } break; case "maximize": if (r.find(".maximize-button-app").length > 0 && !r.hasClass("app-maximized")) { r.find(".maximize-button-app").click(); u = true } break; case "normal": if (r.hasClass("app-maximized")) { if (r.find(".maximize-button-app").length > 0) { r.find(".maximize-button-app").click(); u = true } } break } if (!u) { setTimeout(function () { $.ajax({ url: m + "/App_Position", type: "POST", data: '{ "appId": "' + r.attr("id") + '","posX": "' + r.css("left") + '","posY": "' + r.css("top") + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) }, openWSE_Config.animationSpeed) } } } else { setTimeout(function () { sr(e, t, n) }, 100) } } function or(e) { var t = kn(); var n = $(this).find(".app-title").text(); var r = $(e); var i = r.css("left"); var s = r.css("top"); var o = r.width(); var u = r.height(); Yn(r.attr("id")); if (r.hasClass("app-maximized")) { r.removeClass("app-maximized"); r.find(".maximize-button-app").removeClass("active"); Un(e); $.ajax({ url: m + "/App_Maximize", type: "POST", data: '{ "appId": "' + e.replace(/#/gi, "") + '","name": "' + n + '","x": "' + i + '","y": "' + s + '","width": "' + o + '","height": "' + u + '","workspace": "' + t + '","ismax": "0","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function (t) { N = false; Un(e) }, error: function (e) { N = false } }) } else { r.addClass("app-maximized"); r.find(".maximize-button-app").addClass("active"); Un(e); $.ajax({ url: m + "/App_Maximize", type: "POST", data: '{ "appId": "' + e.replace(/#/gi, "") + '","name": "' + n + '","x": "' + i + '","y": "' + s + '","width": "' + o + '","height": "' + u + '","workspace": "' + t + '","ismax": "1","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function (t) { N = false; Un(e) }, error: function (e) { N = false } }) } } function ur(e) { if (e != null && e != undefined) { if (e.indexOf("app-ChatClient-") == -1) { var t = $(".app-icon").find("span").length; for (var n = 0; n < t; n++) { var r = $(".app-icon").eq(n).attr("id"); if (r == e + "-pnl-icons") { if ($(".app-icon").eq(n).hasClass("active") == false) { $(".app-icon").eq(n).addClass("active"); break } } } } else { var i = $("#" + e).attr("chat-username"); $(".ChatUserNotSelected[chat-username='" + i + "']").addClass("ChatUserSelected") } } } function ar(e, t) { if (openWSE_Config.ShowWorkspaceNumApp && openWSE.IsComplexWorkspaceMode()) { if (t.indexOf("#") == -1) { t = "#" + t } var n = $(t + "-pnl-icons"); if (n.length > 0) { var r = ""; var i = t.replace("#", "") + "-pnl-icons-workspace-reminder"; var s = "workspace-reminder font-no-bold " + i; var o = "display:block;"; if (n.find(".app-icon-font").length > 0) { var u = n.find(".app-icon-font"); if (u.css("display") == "none") { o = "display:none;" } } if ($("." + i).length > 0) { $("." + i).remove() } var a = e.substring(e.lastIndexOf("_") + 1); r = "<span class='" + s + "' style='" + o + "'>" + a + "</span>"; if (r != "") { n.append(r) } } } } function fr(e) { if (openWSE.IsComplexWorkspaceMode()) { if (e.indexOf("#") == -1) { e = "#" + e } var t = $(e + "-pnl-icons"); if (t.length > 0) { var n = e.replace("#", "") + "-pnl-icons-workspace-reminder"; if ($("." + n).length > 0) { $("." + n).remove() } } } } function lr(e) { $(e).find(".maximize-button-app").removeClass("active"); if (e.indexOf("app-ChatClient-") == -1) { var t = $(".app-icon").find("span").length; for (var n = 0; n < t; n++) { var r = "#" + $(".app-icon").eq(n).attr("id"); if (r == e + "-pnl-icons") { if ($(".app-icon").eq(n).hasClass("active") == true) { $(".app-icon").eq(n).removeClass("active"); break } } } } else { var i = $("#" + e.replace("#", "")).attr("chat-username"); chatClient.displayMessageNoti(i); var s = $(".ChatUserNotSelected[chat-username='" + i + "']"); if (s.length > 0) { setTimeout(function () { s.removeClass("ChatUserSelected"); s.removeClass("chatisNew"); if ($("#SteelmfgHeader").hasClass("chatHeaderNew") == true) { $("#SteelmfgHeader").removeClass("chatHeaderNew") } }, openWSE_Config.animationSpeed) } chatClient.notificationCleared = 1; document.title = chatClient.currTitle } } function cr(e, t) { $(".app-icon-category-list").hide(); $("#Category-Back").fadeIn(openWSE_Config.animationSpeed); if (openWSE_Config.animationSpeed == 0) { $("." + e).show() } else { $("." + e).show("slide", { direction: "right" }, openWSE_Config.animationSpeed) } $("#Category-Back-Name").html(t); $("#Category-Back-Name-id").html(e); cookie.set("app_category", t, "30"); cookie.set("app_category_id", e, "30") } function hr() { if (openWSE.IsComplexWorkspaceMode()) { $(".app-main, .app-main-nobg").draggable({ scroll: true, cancel: ".app-body, .exit-button-app, .minimize-button-app, .maximize-button-app, .options-button-app, .app-head-button-holder, .app-maximized, .auto-full-page", start: function (e, t) { var n = $(this); Yn(n.attr("id")); n.css("opacity", "0.6"); n.css("filter", "alpha(opacity=60)"); $(".app-main, .app-main-nobg").each(function (e) { var t = $(this); if (t.css("display") == "block") { zn("#" + t.attr("id")) } }); e.stopPropagation() } }).resizable({ handles: "se, s, e, w", minWidth: 150, minHeight: 150, create: function (e, t) { var n = $(this); if (n.hasClass("no-resize")) { var r = n.attr("id"); if (n.hasClass("app-main") && !n.hasClass("auto-full-page") && !n.hasClass("auto-full-page-min")) { $get(r).className = "app-main ui-draggable" } else if (n.hasClass("app-main") && (n.hasClass("auto-full-page") || n.hasClass("auto-full-page-min"))) { if (n.hasClass("auto-full-page-min")) { $get(r).className = "app-main auto-full-page-min ui-draggable" } else { $get(r).className = "app-main auto-full-page ui-draggable" } } else if (n.hasClass("app-main-nobg") && !n.hasClass("auto-full-page") && !n.hasClass("auto-full-page-min")) { $get(r).className = "app-main-nobg ui-draggable" } else { $get(r).className = "app-main-nobg auto-full-page ui-draggable" } n.find(".ui-resizable-handle").remove() } } }); if ($("#hf_appContainer").val() != "") { $(".app-main, .app-main-nobg").draggable("option", "containment", $("#hf_appContainer").val()); $(".app-main, .app-main-nobg").resizable("option", "containment", "parent") } $(".app-main, .app-main-nobg").on("dragstop", function (e, t) { var n = $(this); n.css("opacity", "1.0"); n.css("filter", "alpha(opacity=100)"); if (this.offsetTop < 0) { n.animate({ top: 0 }, openWSE_Config.animationSpeed, function () { n.css("top", "0") }) } if (this.offsetLeft < 0) { n.animate({ left: 0 }, openWSE_Config.animationSpeed, function () { n.css("left", "0") }) } var r = n.find(".app-title").text(); var i = kn(); var s = n.width(); var o = n.height(); Wn(this); $.ajax({ url: m + "/App_Move", type: "POST", data: '{ "appId": "' + n.attr("id") + '","name": "' + r + '","x": "' + n.css("left") + '","y": "' + n.css("top") + '","width": "' + s + '","height": "' + o + '","workspace": "' + i + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) }); $(".app-main, .app-main-nobg").on("resizestart", function (e, t) { if ($(this).hasClass("app-maximized")) { $(this).removeClass("app-maximized"); var n = $(this).find(".maximize-button-app"); if (n.length > 0) { n.removeClass("active") } } Yn($(this).attr("id")); $(".app-main, .app-main-nobg").each(function (e) { var t = $(this); if (t.css("display") == "block") { zn("#" + t.attr("id")) } }); e.stopPropagation() }); $(".app-main, .app-main-nobg").on("resize", function (e, t) { if (t != null) { var n = $(this); if (!n.hasClass("no-resize")) { var r = t.size.width; var i = parseInt(n.css("min-width")); if (r < i) { r = i } var s = t.size.height; var o = parseInt(n.css("min-height")); if (s < o) { s = o } n.css({ width: r, height: s }); Un("#" + n.attr("id")); L = n.height() } } }); $(".app-main, .app-main-nobg").on("resizestop", function (e, t) { var n = $(this); if (!n.hasClass("no-resize")) { Un("#" + n.attr("id")); L = 0; Wn(this); $.ajax({ url: m + "/App_Resize", type: "POST", data: '{ "appId": "' + n.attr("id") + '","width": "' + t.size.width + '","height": "' + t.size.height + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) } }) } } function pr(e) { var t = $(e).closest(".app-head-button-holder").parent().find(".app-title").text(); var n = $(e).closest(".app-head-button-holder").parent(); var r = n.attr("id"); Un("#" + r); $(".app-main, .app-main-nobg").css("z-index", "1000"); n.css("z-index", "3000"); var i = n.find(".options-button-app"); var s = i.parent(); i.removeClass("active"); s.find(".app-popup-inner-app").hide(); if (n.find(".iFrame-apps").length > 0) { var o = $get(r + " .iFrame-apps"); if (o.src != null) { if (n.find(".app-body").find("div").html() == null) { if (n.find(".app-body").find(".loading-background-holder").length <= 0) { n.find(".app-body").append(g) } n.find(".iFrame-apps").one("load", function () { n.find(".app-body").find(".loading-background-holder").each(function () { $(this).remove() }) }) } else { if (n.find(".app-body").find("div").find(".loading-background-holder").length <= 0) { n.find(".app-body").find("div").append(g) } n.find(".iFrame-apps").one("load", function () { n.find(".app-body").find("div").find(".loading-background-holder").each(function () { $(this).remove() }) }) } o.src = o.src } } else { if (n.find(".app-body").find(".loading-background-holder").length <= 0) { n.find(".app-body").append(g) } $("#hf_ReloadApp").val(r); __doPostBack("hf_ReloadApp", "") } } function dr(e) { var t = $(e).closest(".app-head-button-holder").parent(); var n = t.attr("id"); $("#hf_aboutstatsapp").val("about;" + n); var r = t.find(".options-button-app"); var i = r.parent(); r.removeClass("active"); i.find(".app-popup-inner-app").hide(); $("#MainContent_pnl_aboutHolder").html(""); et("Loading. Please Wait..."); __doPostBack("hf_aboutstatsapp", "") } function vr(e) { openWSE.ConfirmWindow("Are you sure you want to remove this app?", function () { $("#hf_aboutstatsapp").val("uninstall;" + e); et("Removing App"); __doPostBack("hf_aboutstatsapp", "") }, null) } function mr(e) { var t = $(e).closest(".app-head-button-holder").parent(); var n = t.attr("id"); if (n == "" || n == null || n == undefined) { n = e } $("#hf_aboutstatsapp").val("stats;" + n); var r = t.find(".options-button-app"); var i = r.parent(); r.removeClass("active"); i.find(".app-popup-inner-app").hide(); et("Loading. Please Wait..."); __doPostBack("hf_aboutstatsapp", "") } function gr(e, t) { var n = $(e).closest(".app-head-button-holder").parent(); var r = n.find("iframe"); if (r.length > 0) { var i = r[0]; var s = i.contentWindow ? i.contentWindow : i.contentDocument.defaultView; try { if (s.history.length > 0) { if (t == "back") { s.history.back() } else { s.history.forward() } } } catch (o) { } } } function yr(e, t) { var n = $(e).closest(".app-head-button-holder").parent(); var r = 315; var i = 425; if (n.length > 0) { var s = n.find(".app-title").text(); if (n.attr("id") == "app-appinstaller") { $("#app-installer-icon").removeClass("active") } r = n.width(); i = n.height() } n.fadeOut(openWSE_Config.animationSpeed, function () { if (n.hasClass("app-maximized")) { n.removeClass("app-maximized") } fr("#" + n.attr("id")); lr("#" + n.attr("id")); var e = 1; var t = document.getElementById("hf_" + n.attr("id")); if (t != null) { e = 0 } if (n.find(".app-body").find("div").html() == null) { if (e == 1) { n.find(".app-body").html("") } } else { if (e == 1) { n.find(".app-body").find("div").html("") } } n.css({ visibility: "hidden", left: "", top: "", width: "", height: "" }); if (n.find(".options-button-app").length > 0) { n.find(".options-button-app").removeClass("active"); n.find(".app-popup-inner-app").hide() } $.ajax({ url: m + "/App_Close", type: "POST", data: '{ "appId": "' + n.attr("id") + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) }); var o = "width=" + r + "px,height=" + i + "px,location=no,menubar=no,toolbar=no,status=no,resizable=yes,scrollbars=yes"; myWindow = window.open(t, s, o); myWindow.focus() } function br(e, t) { var n = "width=400px,height=400px,location=no,menubar=no,toolbar=no,status=no,resizable=yes,scrollbars=yes"; myWindow = window.open(t, e, n); myWindow.focus(); $("#MessageActivationPopup").hide(); $("#MessageActivationPopup").remove() } function wr(e, t) { if (openWSE.IsComplexWorkspaceMode()) { $(".top-options li.a").removeClass("active"); $(".top-options li.b").hide(); var n = "fullscreen=yes,location=no,menubar=no,toolbar=no,status=no,resizable=yes,scrollbars=yes"; myWindow = window.open(t, e, n); myWindow.focus() } else { window.location.href = t.replace("?toolView=true", "") } } function Er(e) { var t = ""; if ($(e).length > 0) { if ($(e).hasClass("app-popup-selector") || $(e).hasClass("app-options-workspace-switch")) { t = $.trim($(e).val()) } else { t = $.trim($(e).text()) } } else { t = e } if (t == "" || t == "-") { return } An(t); var n = t; t = "workspace_" + t; var r = kn(); $_name = $(e).closest(".app-icon"); if ($_name.length == 0) { $_name = $(e).closest(".app-head-button-holder").parent() } var i = 0; var s = $_name.attr("id"); if (s != "" && s != undefined && s != null) { s = $_name.attr("id").replace("-pnl-icons", ""); ar(t, s); if ($("#" + s).css("display") == "block") { i = 1 } } if (r != t || i == 0 || i == 1 && r == t) { $.ajax({ url: m + "/App_CurrentWorkspace", type: "POST", data: '{ "workspace": "' + n + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }); Bn($_name, t); if (r != t) { _id = "#MainContent_" + t; $("#workspace_holder .workspace-holder").each(function () { if ($(this).css("visibility") == "visible") { if (!openWSE_Config.taskBarShowAll) { $("#minimized-app-bar").fadeOut(openWSE_Config.animationSpeed) } $(this).fadeTo(openWSE_Config.animationSpeed, 0, function () { var e = $(this).attr("id"); Xn("#" + e); if (!openWSE_Config.taskBarShowAll) { Tn("#" + e); Nn(_id) } }) } }); $(_id).fadeTo(openWSE_Config.animationSpeed, 1); Vn(_id); Rn(_id); $(".app-options").css("visibility", "hidden"); setTimeout(function () { $(".app-popup").hide() }, openWSE_Config.animationSpeed) } } } function Sr() { var e = -1; if (navigator.appName == "Microsoft Internet Explorer") { var t = navigator.userAgent; var n = new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"); if (n.exec(t) != null) e = parseFloat(RegExp.$1) } return e } function xr() { var e = Sr(); if (e > -1) { if (e < 8) { openWSE.AlertWindow("You might want to consider upgrading your copy of Internet Explorer. Some features may not work correctly.") } } } function Tr() { et("Loading Groups..."); $("#GroupLogin-element").remove(); var e = "<div id='GroupLogin-element' class='Modal-element'><div class='Modal-overlay'><div class='Modal-element-align'><div class='Modal-element-modal'>"; var t = "<a href='#' onclick='openWSE.CloseGroupLoginModal();return false;' class='ModalExitButton'></a>"; e += "<div class='ModalHeader'><div><div class='app-head-button-holder-admin'>" + t + "</div><span class='Modal-title'></span></div></div>"; e += "<div class='ModalPadContent'></div></div></div></div></div>"; if ($("#extra_modal_holder").length > 0) { $("#extra_modal_holder").append(e) } else { $("body").append(e) } $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/GetUserGroups", type: "POST", data: "{ }", contentType: "application/json; charset=utf-8", success: function (e) { var t = "<div class='clear-margin'>Select the group you would like to login to. Using this enables certain features of a group.</div><div class='clear-space'></div>"; try { for (var n = 0; n < e.d[0].length; n++) { var r = e.d[0][n][0]; var i = e.d[0][n][1]; var s = e.d[0][n][2]; t += "<div class='logingroupselector' onclick='openWSE.LoginAsGroup(\"" + r + "\")' title='Click to login'>"; t += "<img alt='Group Logo' src='" + s + "' />"; t += "<span>" + i + "</span>"; t += "</div>" } if (openWSE.ConvertBitToBoolean(e.d[1])) { t += "<div class='logingroupselector-logout' onclick='openWSE.LoginAsGroup(\"\")'>"; t += "<div>Logout of Group</div>"; t += "</div>" } t += "<div class='clear-space'></div>" } catch (o) { } $("#GroupLogin-element").find(".ModalPadContent").html(t); Et(true, "GroupLogin-element", "Group Login"); openWSE.RemoveUpdateModal() } }) } function Nr(e) { if (e != "") { et("Logging into Group") } else { et("Logging out of Group") } $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/LoginUnderGroup", type: "POST", data: '{ "id": "' + e + '" }', contentType: "application/json; charset=utf-8", success: function (e) { location.reload() }, error: function (e) { nt() } }) } function Cr() { Et(false, "GroupLogin-element", ""); setTimeout(function () { $("#GroupLogin-element").remove() }, openWSE_Config.animationSpeed) } function Mr() { var e = location.hash; try { if (e.indexOf("?iframecontent=") != -1) { var t = e.split("?iframecontent="); if (t.length > 1) { openWSE.LoadIFrameContentHistory(t[1], "Content") } } else if (e.indexOf("&iframecontent=") != -1) { var t = e.split("&iframecontent="); if (t.length > 1) { openWSE.LoadIFrameContentHistory(t[1], "Content") } } else if (e.indexOf("?help") != -1 || e.indexOf("&help") != -1) { Ot() } else { if ($("#iframe-container-helper").length > 0) { openWSE.CloseIFrameContent() } if ($("#help_main_holder").css("display") == "block") { qt() } } } catch (n) { } } function _r(e) { var t = openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/" + e; $("link[href='" + t + "']").remove(); var n = document.getElementsByTagName("head")[0]; link = document.createElement("link"); link.type = "text/css"; link.rel = "stylesheet"; link.href = t; n.appendChild(link) } function Dr(e) { var t = openWSE.siteRoot() + "App_Themes/" + openWSE_Config.siteTheme + "/" + e; $("link[href='" + t + "']").remove() } function Pr() { if (navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/webOS/i) || navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/Windows Phone/i)) { var e = document.getElementsByTagName("head")[0]; meta = document.createElement("meta"); meta.name = "viewport"; meta.id = "mobileViewport"; meta.content = "width=device-width, initial-scale=0.70, user-scalable=no"; e.appendChild(meta) } else { if ($("#mobileViewport").length > 0) { $("#mobileViewport").remove() } } } function Hr(e, t) { if (!openWSE_Config.demoMode) { et("Accepting. Please Wait..."); var n = $(e).closest("tr"); var r = n.attr("id"); var i = openWSE.siteRoot() + "WebServices/NotificationRetrieve.asmx/AcceptInviteNotifications"; $.ajax({ url: i, type: "POST", data: '{ "id": "' + r + '", "groupId": "' + t + '" }', contentType: "application/json; charset=utf-8", success: function (e) { if (openWSE.ConvertBitToBoolean(e.d)) { n.fadeOut(openWSE_Config.animationSpeed, function () { nt(); n.remove(); if ($("#lbl_notifications").html() == "1") { rn() } else { var e = parseInt($("#lbl_notifications").html()); e -= 1; $("#lbl_notifications").html(e) } }) } } }) } } function Br(e) { var t = $("#" + e); if (t.length > 0) { var n = $.trim(t.val()); et("Submitting feedback..."); $.ajax({ url: openWSE.siteRoot() + "WebServices/UpdateServerSettings.asmx/SubmitFeedback", data: "{ 'text': '" + n + "' }", dataType: "json", type: "POST", contentType: "application/json; charset=utf-8", dataFilter: function (e) { return e }, success: function (e) { nt(); t.val("Enter your comments here..."); t.css("color", "#B7B7B7") }, error: function (e) { openWSE.AlertWindow("An error occurred submitting your feedback! Please try again.") } }) } } function jr() { $("#container").css("top", "0"); $("#always-visible, .sidebar-padding-menulinks").hide(); var e = $(window).height() - ($(".footer").height() + $("#app_title_bg").height()); $("#maincontent_overflow").css({ height: e }); $("#maincontent_overflow").width($(window).width()); $("#always-visible").find(".top-options").hide(); $("#DateDisplay").hide(); $("#localtime").hide(); $(window).resize() } function Fr() { $(".app-icon-links").removeClass("active"); $(".app-icon-sub-links").removeClass("active"); var e = window.location.href.toLowerCase(); $(".app-icon-links").each(function () { var t = $(this).attr("href").toLowerCase(); if (e.indexOf(t) != -1) { $(this).addClass("active"); if ($(this).next().hasClass("app-icon-sub-link-holder")) { $(this).next().show(); var n = $(this).find(".img-expand-sml"); if (n.length == 1) { n.removeClass("img-expand-sml"); n.addClass("img-collapse-sml") } } } }); $(".app-icon-sub-links").each(function () { var t = $(this).attr("href").toLowerCase(); if (e.indexOf(t) != -1) { $(".app-icon-links").removeClass("active"); $(this).addClass("active"); $(this).parent().show(); var n = $(this).parent().prev().find(".img-expand-sml"); if (n.length == 1) { n.removeClass("img-expand-sml"); n.addClass("img-collapse-sml") } } }) } function Ir() { var e = $(window).height() - ($(".footer").height() + $("#always-visible").height() + $("#app_title_bg").height()); if ($("#always-visible").css("display") == "none") { e += $("#always-visible").height() } if ($(".footer").css("display") == "none") { e += $(".footer").height() } $("#maincontent_overflow").css({ height: e - 1 }); if (openWSE_Config.overlayPanelId == "pnl_OverlaysAll") { $("#pnl_OverlaysAll").height($(window).height()) } if ($(".sidebar-padding-menulinks").css("display") == "none") { $("#maincontent_overflow").width($(window).width()) } else { $("#accordian-sidebar").css("height", e - 1 + "px"); $("#maincontent_overflow").css("width", $(window).width() - $(".sidebar-padding-menulinks").outerWidth() + "px") } } function qr(e, t) { if ($(e).hasClass("img-expand-sml")) { $(e).removeClass("img-expand-sml"); $(e).addClass("img-collapse-sml"); $(e).closest(".app-icon-links").parent().find("." + t).slideDown(openWSE_Config.animationSpeed) } else { $(e).removeClass("img-collapse-sml"); $(e).addClass("img-expand-sml"); $(e).closest(".app-icon-links").parent().find("." + t).slideUp(openWSE_Config.animationSpeed) } } function Rr() { var e = ""; if (openWSE_Config.siteRootFolder != "") { e = openWSE_Config.siteRootFolder + "/" } return window.location.protocol + "//" + window.location.host + "/" + e } function Ur(e) { if ($(e).length == 1) { var t = $(e)[0].className.split(/\s+/); return t } return new Array } var e = ""; var t = ""; var n = ""; var r = ""; var i = 0; var s = "<div class='loading-icon-sml'></div>"; var o = "<div class='loading-icon-lrg'></div>"; var u = 0; var a = false; var f = false; var l = new Array; var c = "<div class='ddLoadingMessage'>" + s + "<h3>Loading Notifications. Please Wait...</h3></div>"; var h = 0; var d = false; var v = false; var m = "WebServices/SaveControls.asmx"; var g = "<div class='loading-background-holder'></div>"; var y = 0; var b = 0; var w = ""; var E = ""; var S = ""; var x = false; var T = new Array; var N = false; var C = false; var k = false; var L = 0; var A = 0; var O = 0; var M = false; var _; var D; var P = 34; var H = 28; var B = ""; var j = false; var F = false; Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(function (e, t) { if ($("#pnl_aboutHolder").length > 0 && $.trim($("#pnl_aboutHolder").html()) != "" && $("#aboutApp-element").css("display") == "block") { r = $.trim($("#pnl_aboutHolder").html()) } St(t) }); Sys.WebForms.PageRequestManager.getInstance().add_endRequest(function () { $(".ui-tooltip-content").parents("div").remove(); if (r != "") { $("#MainContent_pnl_aboutHolder").html(r); r = "" } nt(); xt(); tn(); G(e, t, n); fn() }); $(document.body).on("click", ".RandomActionBtns", function () { if ($(this).closest("#searchwrapper").length != 0) { et("Searching...") } else { et("Updating. Please Wait...") } }); $(document.body).on("click", "#lbtn_signoff", function () { et("Signing Off. Please Wait...") }); $(document.body).on("keypress", "#searchbox-app-search", function (e) { if (e.which == 13) { $(this).focus(); event.preventDefault(); gt() } }); $(document.body).on("click", "#container, #container_logo, .workspace-holder, .content-main, .Modal-overlay, #iframe-container-helper", function (e) { $(".top-options li.a").removeClass("active"); $(".top-options li.b").hide(); openWSE.RemoveWorkspaceSelectorActive(); nn(); cookie.del("top_menu") }); $(document.body).on("click", ".top-options li.a", function () { var e = $(this).next(); $(".top-options li.a").removeClass("active"); if (e.length == 1) { if (!e.is(":visible")) { $(".top-options li.b").hide(); var t = $(window).height() - 98; e.find(".li-pnl-tab").css("max-height", t); e.slideDown(openWSE_Config.animationSpeed); $(this).addClass("active"); if (e.find("input[type=text]").length > 0) { e.find("input[type=text]").focus() } var n = $("li.b").index(e); cookie.set("top_menu", n, "30") } else { nn(); $(".top-options li.b").hide(); e.css("max-height", "") } } else { nn(); $(".top-options li.b").hide() } }); $(document.body).on("click", ".help-icon", function () { At(false) }); $(document.body).on("keydown", "#tb_weather_postalCode", function (e) { try { if (e.which == 13) { hn(); return false } } catch (t) { if (e.keyCode == 13) { hn(); return false } delete t } }); $(document.body).on("click", ".workspace-reminder", function () { var e = $(this).parent(); $(".app-popup").css("display", "none"); $popup = e.find(".app-popup"); $popup.css("display", "block"); $popup.fadeIn(openWSE_Config.animationSpeed); return false }); $(document.body).on("mouseover", ".app-icon", function (e) { var t = $(this).find(".app-options"); if (t.length > 0) { j = false; t.css("visibility", "visible") } }); $(document.body).on("mouseleave", ".app-icon", function (e) { var t = $(this).find(".app-options"); var n = $(this).find(".app-popup"); if (t.length > 0 && n.length > 0) { if (n.css("display") != "block") { t.css("visibility", "hidden") } } }); $(document.body).on("mouseleave", ".app-popup", function (e) { if (!j) { $(this).hide() } }); $(document.body).on("click", ".app-popup-selector", function () { j = true }); $(document.body).on("click", ".app-icon", function () { var e = $(this); if (!openWSE.IsComplexWorkspaceMode() && !F) { window.location.href = openWSE.siteRoot() + "Workspace.aspx?AppPage=" + e.attr("id").replace("-pnl-icons", "") } else if ($("#workspace_holder").length > 0) { var t = kn(); Bn(e, t); if (e.hasClass("active") == false) { e.addClass("active") } if ($(".workspace-overlay-selector").hasClass("active")) { $(".workspace-overlay-selector").removeClass("active") } } else if ($("#app_tab_body").length > 0) { wt(this) } F = false; return false }); $(document.body).on("click", "#Category-Back", function () { var e = $("#Category-Back-Name-id").html(); $("#Category-Back").fadeOut(openWSE_Config.animationSpeed); if ($("." + e).length > 0) { if (openWSE_Config.animationSpeed == 0) { $("." + e).hide(); $(".app-icon-category-list").show(); $("#Category-Back-Name").html(""); $("#Category-Back-Name-id").html(""); cookie.del("app_category"); cookie.del("app_category_id") } else { $("." + e).hide("slide", { direction: "right" }, openWSE_Config.animationSpeed, function () { $(".app-icon-category-list").show(); $("#Category-Back-Name").html(""); $("#Category-Back-Name-id").html(""); cookie.del("app_category"); cookie.del("app_category_id") }) } } else { $(".app-icon-category-list").show(); $("#Category-Back-Name").html(""); $("#Category-Back-Name-id").html(""); cookie.del("app_category"); cookie.del("app_category_id") } }); $(document.body).on("click", ".minimize-button-app", function () { if (!C) { C = true; var e = $(this).attr("href"); var t = $(e); var n = t.find(".app-title").text(); var r = t.css("left"); var i = t.css("top"); var s = t.width(); var o = t.height(); var u = kn(); if ($("#" + e.replace("#", "") + "-min-bar").length == 0) { t.animate({ opacity: 0, left: $("#minimized-app-bar").css("width"), top: 0 }, openWSE_Config.animationSpeed, function () { Hn(e.replace(/#/gi, ""), n, r, i); Xn(e); U(true); $.ajax({ url: m + "/App_Minimize", type: "POST", data: '{ "appId": "' + e.replace(/#/gi, "") + '","name": "' + n + '","x": "' + r + '","y": "' + i + '","width": "' + s + '","height": "' + o + '","workspace": "' + u + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function (e) { C = false }, error: function (e) { C = false } }) }) } } return false }); $(document.body).on("dblclick", ".app-head-dblclick", function () { if (!N) { N = true; var e = $(this).parent().attr("id"); e = "#" + e; or(e) } return false }); $(document.body).on("click", ".maximize-button-app", function () { if (!N) { N = true; var e = $(this).attr("href"); or(e) } return false }); $(document.body).on("click", ".exit-button-app, .exit-button-app-min", function () { if (!k) { k = true; var e = $(this).attr("href"); if (e.indexOf("#") == -1) { e = "#" + e } var t = $(e); if (e == "#app-appinstaller") { $("#app-installer-icon").removeClass("active") } if ($(e + "-min-bar").length > 0) { $(e + "-min-bar").remove(); U(true) } var n = t.find(".app-title").text(); if (t.hasClass("app-min-bar-preview")) { t.css("opacity", "0.0"); t.css("filter", "alpha(opacity=0)"); t.removeClass("app-min-bar-preview"); x = false; w = ""; E = ""; S = ""; Kn(e) } fr(e); lr(e); t.fadeOut(openWSE_Config.animationSpeed, function () { if (t.hasClass("app-maximized")) { t.removeClass("app-maximized") } if (t.attr("id").indexOf("app-ChatClient-") != -1) { t.remove() } var n = 1; var r = document.getElementById("hf_" + e.replace(/#/gi, "")); if (r != null) { n = 0 } if (t.find(".app-body").find("div").html() == null) { if (n == 1) { t.find(".app-body").html("") } } else { if (n == 1) { t.find(".app-body").find("div").html("") } } t.css({ visibility: "hidden", left: "", top: "", width: "", height: "" }); t.find(".app-body").css("height", ""); if (t.find(".options-button-app").length > 0) { t.find(".options-button-app").removeClass("active"); t.find(".app-popup-inner-app").hide() } $.ajax({ url: m + "/App_Close", type: "POST", data: '{ "appId": "' + e.replace(/#/gi, "") + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function (e) { k = false }, error: function (e) { k = false } }) }) } return false }); $(document.body).on("click", ".app-min-bar", function () { var e = $(this).find("span").text(); var t = kn(); var n = $(this).attr("id"); if (n.indexOf("-min-bar") != -1) { n = n.replace("-min-bar", "") } if ($("#" + n).hasClass("app-min-bar-preview")) { $("#" + n).css("opacity", "0.0"); $("#" + n).css("filter", "alpha(opacity=0)"); $("#" + n).removeClass("app-min-bar-preview"); E = ""; S = "" } $.ajax({ url: m + "/App_Open", type: "POST", data: '{ "appId": "' + n + '","name": "' + e + '","workspace": "' + t + '","width": "' + $("#" + n).width() + '","height": "' + $("#" + n).height() + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8", success: function (r) { var i = r.d; if (i != "") { $_id = $("#" + n); $n(t, n); ar(t, n); var s = $_id.width(); var o = $_id.height(); if ($_id.css("display") != "block" || $_id.css("visibility") != "visible") { var u = ""; if ($_id.find(".app-body").find("div").html() == null) { u = $_id.find(".app-body").html().trim() } else { u = $_id.find(".app-body").find("div").html().trim() } var a = "0"; if ($_id.hasClass("app-maximized")) { a = "1" } if (u == "") { if (n.indexOf("app-ChatClient-") != -1) { var f = $_id.attr("chat-username"); i = "ChatClient/ChatWindow.html?user=" + f + "&displayVersion=workspace" } if ($_id.css("left") == null && $_id.css("top") == null || $_id.css("left") == "auto" && $_id.css("top") == "auto") { Pn(n, e, i, "50px", "50px", s, o, "1", a) } else { if (parseInt($_id.css("top")) < 0) { $_id.css("top", "50px") } if (parseInt($_id.css("left")) < 0) { $_id.css("left", "50px") } Pn(n, e, i, $_id.css("left"), $_id.css("top"), s, o, "1", a) } } if ($("#" + n + "-min-bar").length != 0) { if (!$_id.hasClass("auto-full-page") && !$_id.hasClass("auto-full-page-min") && !$_id.hasClass("app-maximized") && !$_id.hasClass("app-maximized-min")) { $_id.find(".maximize-button-app").removeClass("active"); $_id.css("width", s); $_id.css("height", o); $_id.css("top", P) } else { $_id.find(".maximize-button-app").addClass("active"); $_id.css("top", "0px"); if ($_id.hasClass("app-maximized-min")) { $_id.removeClass("app-maximized-min"); $_id.addClass("app-maximized") } if ($_id.hasClass("auto-full-page-min")) { $_id.removeClass("auto-full-page-min"); $_id.addClass("auto-full-page") } } if (x && w == n) { $_id.css({ visibility: "visible", display: "block", opacity: 1, left: $("#" + n + "-min-bar-x").val(), top: $("#" + n + "-min-bar-y").val() }) } else { $_id.css({ visibility: "visible", display: "block" }).animate({ opacity: 1, left: $("#" + n + "-min-bar-x").val(), top: $("#" + n + "-min-bar-y").val() }, openWSE_Config.animationSpeed) } $.ajax({ url: m + "/App_Move", type: "POST", data: '{ "appId": "' + n + '","name": "' + e + '","x": "' + $("#" + n + "-min-bar-x").val() + '","y": "' + $("#" + n + "-min-bar-y").val() + '","width": "' + s + '","height": "' + o + '","workspace": "' + t + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) } else { $_id.css({ top: P, visibility: "visible", display: "block" }).fadeIn(openWSE_Config.animationSpeed) } var l = $_id.attr("id"); Yn(l); if ($("#" + n + "-min-bar").length > 0) { $("#" + n + "-min-bar").remove() } } x = false; w = ""; U(true); Un("#" + $_id.attr("id")) } } }); return false }); $(document.body).on("click", ".app-main, .app-main-nobg", function (e) { var t = $(this).attr("id"); Yn(t); y = 1 }); $(document.body).on("click", ".workspace-holder", function () { if (openWSE.IsComplexWorkspaceMode()) { if (y == 0) { $(".app-main, .app-main-nobg").removeClass("selected"); er() } } y = 0 }); $(document.body).on("click", ".options-button-app", function () { var e = $(this); var t = e.parent(); if (t.find(".app-popup-inner-app").css("display") == "block") { e.removeClass("active"); t.find(".app-popup-inner-app").slideUp(openWSE_Config.animationSpeed) } else { e.addClass("active"); var n = t.find(".app-popup-inner-app").find(".app-options-workspace-switch"); if (n.length > 0) { var r = e.closest(".workspace-holder").attr("id").replace("MainContent_workspace_", ""); n.val(r) } t.find(".app-popup-inner-app").slideDown(openWSE_Config.animationSpeed); Yn(t.parent().attr("id")) } return false }); $(document.body).on("change", ".app-popup-selector, .app-options-workspace-switch", function () { if ($.trim($(this).val()) != "" && $.trim($(this).val()) != "-") { if ($("#workspace_holder").length > 0) { Er(this); var e = $(this).closest(".app-head-button-holder").parent().find(".options-button-app"); if (e.length > 0) { var t = e.parent(); e.removeClass("active"); t.find(".app-popup-inner-app").hide() } } else { var n = $(this).closest(".app-icon"); var r = "<div id='MessageActivationPopup' style='display: none;'>"; r += "<div class='message-element-align'>"; r += "<div class='message'>"; var i = n.find(".app-icon-font").text(); if (i == "") { i = n.find(".app-title").text(); if (i == "") { i = n.find("span").text() } } var s = n.attr("id"); if (s == undefined || s == null || s == "") { s = n.parent().attr("id") } var o = ""; if (n.attr("popoutloc") != "" && n.attr("popoutloc") != undefined && n.attr("popoutloc") != null) { var u = n.attr("popoutloc"); o = "<div class='clear-space'></div><a href='#' class='sb-links' onclick='openWSE.PopOutFrameFromSiteTools(\"" + i + '", "' + u + "\");return false;'>Open in new window</a>" } var a = "1"; if (n.attr("currentworkspace") != "" && n.attr("currentworkspace") != undefined && n.attr("currentworkspace") != null) { a = n.attr("currentworkspace") } var f = "<input type='button' class='input-buttons' value='Yes' style='width: 50px;' onclick='openWSE.LoadAppFromSiteTools(\"" + s + '", "' + i + '", "workspace_' + $(this).val() + "\");' />"; var l = "<input type='button' class='input-buttons no-margin' value='No' style='width: 50px; margin-left: 10px!important;' onclick='$(\"#MessageActivationPopup\").hide();$(\"#MessageActivationPopup\").remove();return false;' />"; r += "<h4 class='font-bold'>" + i + "</h4><div class='clear-space'></div>"; r += "You must be on the workspace to load this app. Would you like to go back to your workspace?<div class='clear' style='height: 20px;'></div>" + f + l + o; r += "</div></div></div>"; $("body").append(r); $("#MessageActivationPopup").show(); var c = $("#MessageActivationPopup").find(".page-load-message").height() / 2; $("#MessageActivationPopup").find(".page-load-message").css("margin-top", "-" + c + "px") } } }); $(document.body).on("click", ".app-options", function () { $(".app-popup").css("display", "none"); $popup = $(this).find(".app-popup"); $popup.css("display", "block"); $popup.fadeIn(openWSE_Config.animationSpeed); return false }); $(document.body).on("keypress", "input[type='text'], textarea", function (e) { if (!$(this).hasClass("mce-textbox") && !$(this).parent().hasClass("ace_editor")) { var t = e.which ? e.which : e.keyCode; var n = String.fromCharCode(t); if (!n.match('^.*?(?=[^"#%&$*<>?{|}]).*$')) { return false } } }); var Y = 0; var Z; var lt = false; $(document.body).on("click", ".RadioButton-Toggle-Overlay", function () { var e = $(this).closest(".switch-slider"); lt = true; if (e.find(".cb-disable").hasClass("selected")) { e.animate({ left: 0 }, openWSE_Config.animationSpeed, function () { e.find(".cb-enable").find("input").trigger("click") }) } else { var t = e.parent().outerWidth() - e.find(".RadioButton-Toggle-Overlay").outerWidth() + 2; e.animate({ left: -t }, openWSE_Config.animationSpeed, function () { e.find(".cb-disable").find("input").trigger("click") }) } }); $(document.body).on("click", ".cb-enable, .cb-disable", function () { if (!lt) { return false } openWSE.LoadingMessage1("Updating..."); lt = false }); var Ct = false; var kt = false; var Lt = false; var Wt = 3; $(document.body).on("click", "#overlay_tab, #pnl_OverlaysAll", function (e) { if (openWSE_Config.overlayPanelId == "pnl_OverlaysAll") { if ($("#pnl_OverlaysAll").css("display") != "block") { $("#pnl_OverlaysAll").fadeIn(openWSE_Config.animationSpeed) } else { if (e.target.id == $(this).attr("id") || e.target.className.indexOf("overlay-") == 0 && e.target.className.indexOf("overlay-entries") != 0) { $("#pnl_OverlaysAll").fadeOut(openWSE_Config.animationSpeed) } } } $(".top-options li.a").removeClass("active"); $(".top-options li.b").hide(); nn(); cookie.del("top_menu") }); $(document).keydown(function (e) { e = e || window.event; if (e.altKey && e.which == 79) { if (openWSE_Config.overlayPanelId == "pnl_OverlaysAll") { if ($("#pnl_OverlaysAll").css("display") != "block") { $("#pnl_OverlaysAll").fadeIn(openWSE_Config.animationSpeed) } else { $("#pnl_OverlaysAll").fadeOut(openWSE_Config.animationSpeed) } } } if ($("#workspace_holder").length > 0) { if (e.altKey && e.which == 38 || e.altKey && e.which == 40) { var t = parseInt(kn().replace("workspace_", "")); var n = $(".dropdown-db-selector").find("ul").find("li").length; var r = null; if (e.which == 40) { if (t + 1 <= n) { r = $(".workspace-selection-item").eq(t) } else { r = $(".workspace-selection-item").eq(0) } } else { if (t - 1 >= 1) { r = $(".workspace-selection-item").eq(t - 2) } else { r = $(".workspace-selection-item").eq(n - 1) } } if (r != null) { r.trigger("click"); var i = "#MainContent_" + openWSE.Getworkspace(); var s = "#MainContent_workspace_" + r.html().replace("Workspace ", ""); openWSE.HoverWorkspacePreview(i, s) } } } }); $(document.body).on("click", ".image-selector", function () { var e = $(this); var t = $(this).find("img").attr("src"); et("Saving Background"); $.ajax({ url: openWSE.siteRoot() + "WebServices/AcctSettings.asmx/SaveNewBackground", type: "POST", data: '{ "_workspace": "' + kn() + '","_img": "' + t + '" }', contentType: "application/json; charset=utf-8", success: function (t) { if (t.d != "") { if ($("#app_title_bg").length > 0) { $("#app_title_bg").css("background-image", "url('" + t.d + "')"); $("#app_title_bg").css("background-color", "#EFEFEF"); $("#app_title_bg").css("background-position", "top left"); $("#app_title_bg").css("background-repeat", "repeat repeat") } else if ($("#workspace_holder").length > 0) { if ($(".workspace-backgrounds-fixed").length > 0) { $("#MainContent_bg_" + kn()).css("background", "#EFEFEF url('" + t.d + "') repeat top left") } else { if ($("#maincontent_overflow").hasClass("maincontent_overflow-main-bg")) { $("#maincontent_overflow").removeClass("maincontent_overflow-main-bg") } $("#maincontent_overflow").css("background-image", "url('" + t.d + "')"); $("#maincontent_overflow").css("background-color", "#EFEFEF"); $("#maincontent_overflow").css("background-position", "top left"); $("#maincontent_overflow").css("background-repeat", "repeat repeat") } } $(".image-selector-active").each(function (e) { $(this).removeClass("image-selector-active"); $(this).addClass("image-selector") }); e.addClass("image-selector-active") } openWSE.RemoveUpdateModal() } }) }); jQuery.fn.outerHTML = function (e) { return e ? this.before(e).remove() : jQuery("<p>").append(this.eq(0).clone()).html() }; $(document.body).on("click", "#ddl_WorkspaceSelector", function (e) { var t = $(this).find(".dropdown-db-selector"); if (t.length > 0) { if (e.target.className.indexOf("workspace-selection-item") == -1) { t.css("min-width", $("#ddl_WorkspaceSelector").outerWidth()); if (t.css("display") != "block") { t.css("top", $("#always-visible").outerHeight()); t.find(".workspace-selection-item").show(); var n = $(".selected-workspace").html().replace("Workspace ", ""); for (var r = 0; r < t.find(".workspace-selection-item").length; r++) { var i = t.find(".workspace-selection-item").eq(r); if (i.html().replace("Workspace ", "") == n) { i.addClass("font-bold") } else { i.removeClass("font-bold") } } if (openWSE_Config.hoverPreviewWorkspace) { $(".workspace-selection-item").hover(function () { var e = "#MainContent_" + openWSE.Getworkspace(); var t = "#MainContent_workspace_" + $(this).html().replace("Workspace ", ""); openWSE.HoverWorkspacePreview(e, t) }, function () { if (t.find("ul").css("display") == "block") { var e = "#MainContent_workspace_" + $(this).html().replace("Workspace ", ""); var n = "#MainContent_workspace_" + $(".selected-workspace").html().replace("Workspace ", ""); openWSE.HoverWorkspacePreview(e, n) } }) } $("#ddl_WorkspaceSelector").addClass("active"); t.slideDown(openWSE_Config.animationSpeed) } else { openWSE.RemoveWorkspaceSelectorActive() } } } }); $(document.body).on("click", ".workspace-selection-item", function () { openWSE.RemoveWorkspaceSelectorActive(); var e = $(".selected-workspace").html().replace("Workspace ", ""); var t = $(this).html().replace("Workspace ", ""); if (e != t) { var n = "#MainContent_workspace_" + t; openWSE.SetWorkspaceNumber(t); if (!openWSE_Config.hoverPreviewWorkspace) { var r = "#MainContent_workspace_" + e; var i = "#MainContent_workspace_" + t; openWSE.HoverWorkspacePreview(r, i) } $.ajax({ url: m + "/App_CurrentWorkspace", type: "POST", data: '{ "workspace": "' + t + '","workspaceMode": "' + openWSE_Config.workspaceMode + '" }', contentType: "application/json; charset=utf-8" }) } }); var kr = { timer: 2e3 }; var Lr = function () { function r() { $("#always-visible, #container-footer").hover(function () { if (!t && !n) { s(); e = true } }, function () { e = false; setTimeout(function () { if (!e && !n) { e = false; t = true; i() } }, kr.timer) }); $(document).keyup(function (r) { if (r.which == 27) { if (!n) { n = true; s(); e = true; openWSE.LoadingMessage1("AutoHide Mode Off"); setTimeout(function () { openWSE.RemoveUpdateModal() }, kr.timer) } else { n = false; e = false; t = true; i(); openWSE.LoadingMessage1("AutoHide Mode On"); setTimeout(function () { openWSE.RemoveUpdateModal() }, kr.timer) } } }); setTimeout(function () { if (!e) { e = false; t = true; i() } }, kr.timer) } function i() { $("#always-visible, #container-footer").css("height", "8px"); $("#top-main-bar-top, .footer-padding").hide(); t = false; $("#container, #iframe-container-helper").css("top", "8px"); $("#container, #iframe-container-helper").css("bottom", "8px"); $(window).resize() } function s() { $("#top-main-bar-top, .footer-padding").show(); $("#always-visible, #container-footer").css("height", ""); $("#container, #iframe-container-helper").css("top", ""); $("#container, #iframe-container-helper").css("bottom", ""); $(window).resize() } var e = false; var t = false; var n = false; return { init: r } }(); var Ar = { timer: 1e3 }; var Or = function () { function n() { $("#container").append("<div id='presentationmodeText'>Presentation Mode is Off</div>"); r("To start 'Presentation Mode', press the ESC key"); $(document).keyup(function (n) { if (n.which == 27) { if ($("#PresentationActivate-element").length > 0) { openWSE.LoadModalWindow(false, "PresentationActivate-element", "") } if (t != null) { clearTimeout(t) } $("#presentationmodeText").remove(); if (e == 0) { e = true; o(); $("#container").append("<div id='presentationmodeText'>Presentation Mode is Off</div>"); $("#update-element").remove(); openWSE.LoadingMessage1("Presentation Mode Off"); t = setTimeout(function () { openWSE.RemoveUpdateModal() }, Ar.timer) } else if (e == 1) { e = 2; s(); $("#container").append("<div id='presentationmodeText'>Presentation Edit Mode</div>"); $("#update-element").remove(); openWSE.LoadingMessage1("Presentation Mode Edit"); t = setTimeout(function () { openWSE.RemoveUpdateModal() }, Ar.timer) } else { e = 0; i(); $("#update-element").remove(); openWSE.LoadingMessage1("Presentation Mode On"); t = setTimeout(function () { openWSE.RemoveUpdateModal() }, Ar.timer) } } }) } function r(e) { $(window).load(function () { var t = "<div id='PresentationActivate-element' class='Modal-element' style='display: none;'>"; t += "<div class='Modal-overlay'>"; t += "<div class='Modal-element-align'>"; t += "<div class='Modal-element-modal'>"; t += "<div class='ModalPadContent' style='height: 30px;'><h3 class='pad-top float-left'><b class='pad-right-sml'>Note:</b>" + e + "</h3>"; t += "<input type='button' class='input-buttons float-right no-margin' value='Ok' onclick='openWSE.LoadModalWindow(false, \"PresentationActivate-element\", \"\");setTimeout(function(){$(\"#PresentationActivate-element\").remove();},openWSE_Config.animationSpeed);' style='margin-top: 2px!important;' /></div>"; t += "</div></div></div></div>"; $("body").append(t); openWSE.LoadModalWindow(true, "PresentationActivate-element", "") }) } function i() { $("#always-visible").addClass("header-presentation"); $("#container-footer").addClass("footer-presentation"); $("#always-visible, #container-footer").addClass("header-footer-presentation"); $(".username-top-info").addClass("top-menu-color-presentation"); $("#container, #iframe-container-helper").addClass("container-presentation"); $("body").addClass("body-presentation-bg"); $(".app-maximized").addClass("app-max-border-presentation"); $(".app-main, .app-main-nobg, .app-main.selected, .app-main-nobg.selected, .workspace-overlays").addClass("body-presentation-bg app-max-border-presentation"); $(".app-main, .app-main-nobg, .app-main.selected, .app-main-nobg.selected").addClass("no-shadow-presentation"); $(".app-min-bar, .app-min-bar-alt, .ui-icon-gripsmall-diagonal-se").css("background-image", "none"); $(".sidebar-padding-menulinks").hide(); $(".app-head, .app-head-button-holder, .overlay-header").hide(); $("#top-main-bar-top, .footer-padding").hide(); $(window).resize(); isHiding = false } function s() { $("#always-visible").addClass("header-presentation"); $("#container-footer").addClass("footer-presentation"); $("#always-visible, #container-footer").addClass("header-footer-presentation"); $(".username-top-info").addClass("top-menu-color-presentation"); $("#container, .pnl-overlaysAll, #iframe-container-helper").addClass("container-presentation"); $("body").addClass("body-presentation-bg"); $("#top-main-bar-top, .footer-padding").hide(); $(".sidebar-padding-menulinks").hide(); $(window).resize() } function o() { $("#always-visible").removeClass("header-presentation"); $("#container-footer").removeClass("footer-presentation"); $("#always-visible, #container-footer").removeClass("header-footer-presentation"); $(".username-top-info").removeClass("top-menu-color-presentation"); $("#container, .pnl-overlaysAll, #iframe-container-helper").removeClass("container-presentation"); $("body").removeClass("body-presentation-bg"); $(".app-maximized").removeClass("app-max-border-presentation"); $(".app-main, .app-main-nobg, .app-main.selected, .app-main-nobg.selected, .workspace-overlays").removeClass("body-presentation-bg app-max-border-presentation"); $(".app-main, .app-main-nobg, .app-main.selected, .app-main-nobg.selected").removeClass("no-shadow-presentation"); $(".app-min-bar, .app-min-bar-alt, .ui-icon-gripsmall-diagonal-se").css("background-image", ""); $(".sidebar-padding-menulinks").show(); $(".app-head, .app-head-button-holder, .overlay-header").show(); $("#top-main-bar-top, .footer-padding").show(); $(".app-body").each(function () { var e = null; if ($(this).find(".main-div-app-bg").length > 0) { e = $(this).find(".main-div-app-bg") } if (e != null) { e.css("top", ""); e.css("bottom", "") } }); $(window).resize() } var e = 2; var t = null; return { init: n } }(); $.fn.AccordianTab = function (e) { function i() { t.find("." + r.headerClass).each(function (e) { if ($(this).find("." + r.menuDropDownClass).length == 0) { $(this).append("<span class='" + r.menuDropDownClass + "'></span>"); if (r.startCollapsed) { $(this).attr("title", r.expandTooltip); $(this).find("." + r.menuDropDownClass).addClass(r.collapsedClass); $(this).parent().find("." + r.bodyClass).hide() } else { $(this).attr("title", r.collapseTooltip); $(this).find("." + r.menuDropDownClass).addClass(r.expandedClass); $(this).parent().find("." + r.bodyClass).show() } } }) } function s() { var e = false; if (typeof cookie == "function" || typeof cookie == "object") { if (r.createCookie) { var n = cookie.get("menubar-links-tab"); try { var i = n.split(","); if (i != "" && i != null) { for (var s = 0; s < i.length; s++) { if (i[s] != "") { var o = t.find("#" + i[s]); if (o.length > 0) { if (r.startCollapsed) { o.parent().find("." + r.headerClass).attr("title", r.collapseTooltip); o.parent().find("." + r.menuDropDownClass).removeClass(r.collapsedClass).addClass(r.expandedClass); o.show(); if (r.oneOpen) { return } } else if (!r.allowCloseAll && u() > 1 || r.allowCloseAll || !r.startCollapsed && o.css("display") == "block") { o.parent().find("." + r.headerClass).attr("title", r.expandTooltip); o.parent().find("." + r.menuDropDownClass).removeClass(r.expandedClass).addClass(r.collapsedClass); o.hide() } } } } } } catch (f) { } } else { cookie.del("menubar-links-tab") } if (!r.allowCloseAll && u() == 0 || !r.startCollapsed && u() == t.find("." + r.bodyClass).length) { if (!r.startCollapsed) { a() } e = true } } else { e = true } if (e && t.find("." + r.bodyClass).length > 0) { var o = t.find("." + r.bodyClass).eq(0); o.parent().find("." + r.headerClass).attr("title", r.collapseTooltip); o.show(); o.parent().find("." + r.menuDropDownClass).removeClass(r.collapsedClass).addClass(r.expandedClass) } } function o() { if (r.createCookie) { var e = ""; t.find("." + r.bodyClass).each(function () { if ($(this).css("display") == "block") { e += $(this).attr("id") + "," } }); if (typeof cookie == "function" || typeof cookie == "object") { if (e != "") { cookie.set("menubar-links-tab", e, 30) } else { cookie.del("menubar-links-tab") } } } } function u() { var e = 0; t.find("." + r.bodyClass).each(function () { if ($(this).css("display") == "block") { e++ } }); return e } function a() { t.find("." + r.headerClass).each(function (e) { $(this).attr("title", r.expandTooltip); $(this).find("." + r.menuDropDownClass).addClass(r.collapsedClass); $(this).parent().find("." + r.bodyClass).hide() }) } function f() { var e = false; t.find("." + r.bodyClass).each(function () { if ($(this).css("display") == "block") { e = true; return } }); if (!e) { var n = t.find("." + r.headerClass).find("." + r.menuDropDownClass); var i = t.find("." + r.bodyClass); if (n.length > 0 && i.length > 0) { n.eq(0).removeClass(r.collapsedClass).addClass(r.expandedClass); i.eq(0).show() } } } var t = this, n = { allowCloseAll: false, oneOpen: true, startCollapsed: true, animationSpeed: 150, createCookie: true, headerClass: "menu-title", bodyClass: "li-pnl-tab", collapsedClass: "menu-collapsed", expandedClass: "menu-expanded", menuDropDownClass: "menu-dd", expandTooltip: "Click to Expand", collapseTooltip: "Click to Collapse" }, r = $.extend({}, n, e); $(document).ready(function () { i(); s(); f() }); t.find("." + r.headerClass).on("click", function () { var e = $(this).find("." + r.menuDropDownClass); var n = $(this).parent().find("." + r.bodyClass); if (e.length != 0 && n.length != 0) { var i = ""; if (e.hasClass(r.collapsedClass)) { i = r.collapseTooltip; $(this).attr("title", i); e.removeClass(r.collapsedClass).addClass(r.expandedClass); n.slideDown(r.animationSpeed) } else if (!r.allowCloseAll && u() > 1 || r.allowCloseAll) { i = r.expandTooltip; $(this).attr("title", i); e.removeClass(r.expandedClass).addClass(r.collapsedClass); n.slideUp(r.animationSpeed) } if (r.oneOpen) { t.find("." + r.bodyClass).each(function () { if ($(this).attr("id") != n.attr("id")) { $(this).parent().find("." + r.headerClass).attr("title", r.expandTooltip); $(this).parent().find("." + r.headerClass).find("." + r.menuDropDownClass).removeClass(r.expandedClass).addClass(r.collapsedClass); $(this).slideUp(r.animationSpeed) } }) } if ($(this).attr("aria-describedby") != null && $(this).attr("aria-describedby") != "") { var s = $(this).attr("aria-describedby"); $("#" + s).find(".ui-tooltip-content").html(i) } setTimeout(function () { o() }, r.animationSpeed * 2) } }) }; return { siteRoot: Rr, loadingImg: s, loadingImg_lrg: o, topBarHt: P, GetPagedAddOverlayAndModel: W, IsComplexWorkspaceMode: V, PagedWorkspace: z, SetContainerTopPos: U, SetTrialText: Q, ConvertBitToBoolean: J, OpenMobileWorkspace: K, init: I, OnError: q, AdjustContainerLogo: R, autoupdate: G, LoadingMessage1: et, RemoveUpdateModal: nt, AlertWindow: rt, CloseAlertWindow: it, ReportAlert: st, ConfirmWindow: ot, CloseConfirmWindow: ut, StartMessageTickInterval: tt, OnBrowserClose: at, CheckIfWorkspaceLinkAvailable: ft, RadioButtonStyle: ct, RatingStyleInit: pt, UpdateAppRating: dt, ResetRating: vt, OpenAppNoti: mt, SearchSite: gt, ClearAppSearch: yt, SearchExternalSite: bt, LoadModalWindow: Et, SaveInnerModalContent: St, LoadSavedInnerModalContent: xt, LoadTopOptionsCookie: Tt, SetDropDownMaxHeight: Nt, ExpandAdminLinks: qr, HelpOverlay: At, HelpMenuPageLoad: Mt, NewUserPageLoad: _t, NewUserfinsh: It, OnEmailUpdate_KeyPress: Bt, OnPasswordUpdate_KeyPress: jt, UpdateEmail: Dt, UpdateAdminPassword: Pt, ShowUpdatesPopup: Rt, ShowActivationPopup: Ut, CloseUpdatesPopup: zt, OverlayDisable: Xt, TryAddLoadOverlay: Vt, TryRemoveLoadOverlay: $t, CallOverlayList: Jt, AddRemoveOverlayClick: Kt, CreateOverlayTable: Qt, GetUserNotifications: Yt, NotiActionsClearAll: sn, NotiActionsHideInd: on, LoadCreateAccountHolder: ln, LoadRecoveryPassword: cn, SetPostalCode: hn, WeatherBuilder: pn, LoadIFrameContent: dn, LoadIFrameContentHistory: vn, CloseIFrameContent: mn, BackgroundSelector: yn, ClearBackground: bn, CloseBackgroundSelector: wn, updateBackgroundURL: En, updateBackgroundColor: Sn, HideTasks: Tn, ShowTasks: Nn, LoadCurrentWorkspace: Cn, Getworkspace: kn, HoverWorkspacePreview: Ln, SetWorkspaceNumber: An, RemoveWorkspaceSelectorActive: On, AutoRotateWorkspace: Mn, AutoUpdateOnRotate: _n, AppsSortUnlocked: Dn, CreateSOApp: Pn, BuildAppMinIcon: Hn, LoadApp: Bn, LoadAppFromSiteTools: jn, DetermineNeedPostBack: Fn, WatchForLoad: In, LoadUserControl: qn, ResizeAllAppBody: Rn, ResizeAppBody: Un, ApplyOverlayFix: zn, RemoveOverlayFix: Wn, MoveOffScreen: Xn, MoveOnScreen_WorkspaceOnly: Vn, MoveToCurrworkspace: $n, SetAppMaxToMin: Jn, SetAppMinToMax: Kn, HoverOverAppMin: Qn, HoverOutAppMin: Gn, SetNoticiationsMaxHeight: un, SetActiveApp: Yn, SetDeactiveApps: Zn, SetDeactiveAll: er, LoadActiveAppCookie: tr, LoadCategoryCookies: nr, MaximizeApp: or, StartRemoteLoad: rr, LoadRemotely: ir, SetRemoteLoadingOptions: sr, SetAppIconActive: ur, AddworkspaceAppNum: ar, RemoveworkspaceAppNum: fr, RemoveAppIconActive: lr, CategoryClick: cr, ApplyAppDragResize: hr, ReloadApp: pr, AboutApp: dr, UninstallApp: vr, AppStats: mr, NavigationBtns: gr, PopOutFrame: yr, PopOutFrameFromSiteTools: br, PopOutTool: wr, MoveAppToworkspace: Er, getInternetExplorerVersion: Sr, checkVersion: xr, GroupLoginModal: Tr, LoginAsGroup: Nr, CloseGroupLoginModal: Cr, AutoHideMode: Lr, PresentationMode: Or, HashChange: Mr, AcceptGroupNotification: Hr, SubmitFeedback: Br, ToolView: jr, ResizeContainer: Ir, GetElementClassList: Ur } }(); $(window).resize(function () { openWSE.SetContainerTopPos(true); openWSE.ResizeContainer(); var e = openWSE.Getworkspace(); if ($("#MainContent_" + e).length > 0) { openWSE.ResizeAllAppBody("#MainContent_" + e) } else { openWSE.ResizeAllAppBody("body") } }); $(document).ready(function () { openWSE.init(); openWSE.SetContainerTopPos(false); openWSE.LoadCategoryCookies(); openWSE.LoadTopOptionsCookie(); openWSE.checkVersion(); openWSE.GetUserNotifications(true); openWSE.HashChange(); openWSE.ResizeContainer(); if ($("#searchbox-app-search").length > 0) { $("#searchbox-app-search").autocomplete({ minLength: 1, autoFocus: true, source: function (e, t) { $.ajax({ url: openWSE.siteRoot() + "WebServices/AutoComplete.asmx/GetAppSearchList", data: "{ 'prefixText': '" + e.term + "', 'count': '10' }", dataType: "json", type: "POST", contentType: "application/json; charset=utf-8", dataFilter: function (e) { return e }, success: function (e) { t($.map(e.d, function (e) { return { label: e, value: e } })) } }) } }).focus(function () { $(this).autocomplete("search", "") }) } }); $(function () { $(window).hashchange(function () { openWSE.HashChange() }); if (openWSE_Config.displayLoadingOnRedirect) { $("#lnk_BackToWorkspace, .app-icon-links, .title-dd-name").click("click", function (e) { if (e.target.className != "img-expand-sml" && e.target.className != "img-collapse-sml") { openWSE.LoadingMessage1("Loading...") } }); if (!openWSE.IsComplexWorkspaceMode()) { $(".app-icon").click("click", function (e) { if (e.target.className != "app-options") { openWSE.LoadingMessage1("Loading...") } }) } } }); window.onerror = function (e, t) { t = window.location.href; if (t.toLowerCase().indexOf("networklog.aspx") != -1 && e == "Uncaught TypeError: boolean is not a function") { return } if (!openWSE_Config.reportAlert) { openWSE.OnError(e, t) } else { openWSE.AlertWindow(e, t) } }; $(window).load(function () { openWSE.ApplyAppDragResize(); var e = openWSE.Getworkspace(); openWSE.ResizeAllAppBody("#MainContent_" + e); openWSE.AdjustContainerLogo(); if ($("#container_logo").length > 0) { $("#container_logo").css({ visibility: "visible" }) } openWSE.LoadActiveAppCookie(); if (!openWSE_Config.taskBarShowAll) { $(".app-min-bar").hide(); $("#MainContent_" + e).find(".app-main, .app-main-nobg").each(function (e) { var t = $(this).attr("id"); if ($("#minimized-app-bar").find("#" + t + "-min-bar").length != 0) { if ($("#minimized-app-bar").find("#" + t + "-min-bar").css("display") == "none") { $("#minimized-app-bar").find("#" + t + "-min-bar").show() } } }) } }); $.extend({ LoadingMessage: function () { try { var e = arguments[0]; var t = arguments[1]; if (t == null || t == "" || t == undefined) { t = "Updating. Please Wait..." } if ($("#update-element").length > 0) { $("#update-element").remove() } var n = "<div id='update-element'><div class='update-element-overlay' style='position: absolute!important'><div class='update-element-align' style='position: absolute!important'>"; n += "<div class='update-element-modal'>" + openWSE.loadingImg + "<h3 class='inline-block'>" + t + "</h3></div></div></div></div>"; $(e).append(n); $("#update-element").fadeIn(openWSE_Config.animationSpeed) } catch (r) { } } });